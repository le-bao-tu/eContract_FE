(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{W9jO:function(e,t,n){"use strict";n.r(t),n.d(t,"PermissionModule",(function(){return Nt}));var i=n("M0ag"),s=n("tyNb"),c=n("mrSG"),r=n("ofXK"),o=n("Ac7g"),a=n("YMfE"),l=n("sspt"),d=n("3Pt+"),b=n("fXoL"),h=n("atJ9"),u=n("bNXi"),m=n("hdNf"),f=n("o0su"),g=n("RY2A"),p=n("PScX"),z=n("dEAy"),T=(n("ey9i"),n("qBMM")),v=n("JA5x"),A=n("B+r4"),y=n("yNE/"),S=n("C2AL"),U=n("FwiY"),I=n("PTRe"),C=n("nxWG"),k=n("ocnv"),L=n("VXpv"),O=n("TaO5"),R=n("EGpF"),D=n("ZyQt"),M=n("OzZK"),E=n("RwU8"),x=n("sYmb");function N(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",52),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnReload.click(t)})),b.Pb(1,"i",53),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc("",e.btnReload.titlei18n," ")}}function V(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",54),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnAdd.click(t)})),b.Pb(1,"i",55),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc("",e.btnAdd.titlei18n," ")}}function w(e,t){if(1&e&&(b.Lc(0,N,3,1,"button",51),b.Lc(1,V,3,1,"button",48)),2&e){const e=b.fc();b.nc("ngIf",e.btnReload.visible&&e.btnReload.grandAccess),b.Ab(1),b.nc("ngIf",e.btnAdd.visible&&e.btnAdd.grandAccess)}}function P(e,t){1&e&&b.Pb(0,"i",56)}function F(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.code.message.required"),""))}function B(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.code.message.pattern"),""))}function G(e,t){if(1&e&&(b.Lc(0,F,3,3,"ng-container",57),b.Lc(1,B,3,3,"ng-container",57)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function q(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.name.message.required"),""))}function X(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.name.message.pattern"),""))}function $(e,t){if(1&e&&(b.Lc(0,q,3,3,"ng-container",57),b.Lc(1,X,3,3,"ng-container",57)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function K(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.i18n-name.message.required"),""))}function H(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.i18n-name.message.pattern"),""))}function j(e,t){if(1&e&&(b.Lc(0,K,3,3,"ng-container",57),b.Lc(1,H,3,3,"ng-container",57)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function _(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.url.message.required"),""))}function W(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.url.message.pattern"),""))}function J(e,t){if(1&e&&(b.Lc(0,_,3,3,"ng-container",57),b.Lc(1,W,3,3,"ng-container",57)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function Q(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.icon.message.required"),""))}function Y(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.icon.message.pattern"),""))}function Z(e,t){if(1&e&&(b.Lc(0,Q,3,3,"ng-container",57),b.Lc(1,Y,3,3,"ng-container",57)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function ee(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.menu.order.error.message"),""))}function te(e,t){1&e&&b.Lc(0,ee,3,3,"ng-container",57),2&e&&b.nc("ngIf",t.$implicit.hasError("min"))}function ne(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",54),b.bc("click",(function(t){return b.Ac(e),b.fc().btnEdit.click(t)})),b.Pb(1,"i",58),b.Nc(2),b.Tb()}if(2&e){const e=b.fc();b.Ab(2),b.Pc("",e.btnEdit.titlei18n," ")}}function ie(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",59),b.bc("click",(function(t){return b.Ac(e),b.fc().btnSave.click(t)})),b.Pb(1,"i",60),b.Nc(2),b.Tb()}if(2&e){const e=b.fc();b.nc("nzLoading",e.isLoading)("disabled",!e.form.valid),b.Ab(2),b.Pc("",e.btnSave.titlei18n," ")}}function se(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",61),b.bc("click",(function(t){return b.Ac(e),b.fc().btnDelete.click(t)})),b.Pb(1,"i",62),b.Nc(2),b.Tb()}if(2&e){const e=b.fc();b.Ab(2),b.Pc("",e.btnDelete.titlei18n," ")}}const ce=function(){return["/"]};let re=(()=>{class e{constructor(e,t,n,i,s,c,r,o,b,h,u){this.fb=e,this.aclService=t,this.notification=n,this.elementRef=i,this.roleService=s,this.menuService=c,this.arrayService=r,this.messageService=o,this.modal=b,this.i18n=h,this.doc=u,this.isRenderComplete=!1,this.listStatus=a.m,this.filter=Object.assign({},a.s),this.pageSizeOptions=[],this.paginationMessage="",this.modules=[l.a],this.rowSelection="multiple",this.overlayLoadingTemplate=a.p,this.overlayNoRowsTemplate=a.q,this.quickText="",this.isLoadingDelete=!1,this.isShowDelete=!1,this.isShowImport=!1,this.tittle=""+this.i18n.fanyi("function.menu.title"),this.treeMenuData=[],this.menuParentList=[],this.rightList=[],this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.listRole=[],this.treeRoleData=[],this.roleIdsSelected=[],this.isLoading=!1,this.delDisabled=!1,this.expandAll=!0,this.btnAdd={title:"Th\xeam m\u1edbi",titlei18n:""+this.i18n.fanyi("layout.button.btn-add.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.onAddItem()}},this.btnDelete={title:"X\xf3a",titlei18n:""+this.i18n.fanyi("layout.button.btn-delete.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.onDeleteItem()}},this.btnReload={title:"T\u1ea3i l\u1ea1i",titlei18n:""+this.i18n.fanyi("layout.button.btn-reload.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.initListMenu()}},this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.save()}},this.btnEdit={title:"C\u1eadp nh\u1eadt",titlei18n:""+this.i18n.fanyi("layout.button.btn-edit.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.onEditItem(this.item)}},this.form=this.fb.group({parentId:[null],code:[{value:null,disabled:!1},[d.w.required,d.w.pattern(a.t)]],name:[{value:null,disabled:!1},[d.w.required,d.w.pattern(a.v)]],i18n:[{value:null,disabled:!1}],url:[{value:null,disabled:!1}],icon:[{value:null,disabled:!1}],order:[{value:0,disabled:!1},[d.w.min(0)]],hideBreadcrumb:[{value:!0,disabled:!1}],status:[{value:!0,disabled:!1}]})}ngOnInit(){this.initRightOfUser(),this.isRenderComplete=!0,this.initListRole(),this.initListMenu()}initRightOfUser(){this.btnAdd.grandAccess=this.aclService.canAbility("NAVIGATION-ADD"),this.btnDelete.grandAccess=this.aclService.canAbility("NAVIGATION-DELETE"),this.btnEdit.grandAccess=this.aclService.canAbility("NAVIGATION-EDIT")}initListRole(){this.roleService.getListCombobox().subscribe(e=>{e.data&&(e.data.forEach(e=>{e.parent_id=null}),this.listRole=e.data,this.convertListRoleToTreeData())},e=>console.log(e))}initListMenu(){this.menuService.getAllListCombobox().subscribe(e=>{if(200!==e.code)return void this.notification.error(""+this.i18n.fanyi("function.menu.message-error.title"),""+e.message);if(null==e.data)return void this.notification.error(""+this.i18n.fanyi("function.menu.message-error.title"),""+e.message);const t=e.data.map((e,t,n)=>{const i=n.some(t=>t.parentId===e.id);return{id:e.id,parent_id:e.parentId,title:e.name,isLeaf:!i,expanded:!0,selected:!1,checked:!1}});this.treeMenuData=this.arrayService.arrToTreeNode(t,{cb:(e,t,n)=>{e.selected=0===e.id}})},e=>{})}convertListRoleToTreeData(e=!1){const t=this.listRole.map((t,n,i)=>{const s=i.some(e=>e.parentId===t.id),c=this.roleIdsSelected.some(e=>e===t.id);return{id:t.id,parent_id:t.parentId,title:t.name,isLeaf:!s,expanded:!1,selected:!1,checked:c,disabled:e,disableCheckbox:e}});this.treeRoleData=this.arrayService.arrToTreeNode(t,{cb:(e,t,n)=>{e.selected=0===e.id}})}onAddItem(){this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.form.enable(),this.resetForm(),this.item=null}onAddItemFromParent(e){this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.form.enable(),this.resetForm(),this.form.controls.parentId.setValue(e.id),this.item=null}onEditItem(e=null){this.isAdd=!1,this.isEdit=!0,this.isInfo=!1,this.item=e,this.form.enable(),this.form.controls.code.disable(),this.form.controls.i18n.disable(),this.form.controls.url.disable(),this.getById(e.id,!1)}onViewItem(e=null){this.isAdd=!1,this.isEdit=!1,this.isInfo=!0,this.item=e,this.form.disable(),this.getById(e.id,!0)}resetForm(){var e,t,n,i;this.form.reset(),null===(e=this.form.get("status"))||void 0===e||e.setValue(!0),null===(t=this.form.get("hideBreadcrumb"))||void 0===t||t.setValue(!0),null===(n=this.form.get("order"))||void 0===n||n.setValue(0),null===(i=this.form.get("code"))||void 0===i||i.enable(),this.roleIdsSelected=[],this.convertListRoleToTreeData()}onDeleteItem(){this.modal.confirm({nzTitle:""+this.i18n.fanyi("function.menu.modal-delete.header"),nzContent:""+this.i18n.fanyi("function.menu.modal-delete.body"),nzOkText:""+this.i18n.fanyi("function.menu.modal-delete.button.yes"),nzOkType:"primary",nzOkDanger:!0,nzOnOk:()=>this.delete(),nzCancelText:""+this.i18n.fanyi("function.menu.modal-delete.button.no"),nzOnCancel:()=>{}})}delete(){var e;const t=[null===(e=this.item)||void 0===e?void 0:e.id];this.menuService.delete(t).subscribe(e=>{200===e.code&&null!=e.data?e.data[0].result?(this.messageService.success(""+e.message),Object(a.B)(this.form),this.resetForm(),this.initListMenu(),this.onAddItem()):this.notification.error(""+this.i18n.fanyi("function.menu.message-error.title"),""+e.data[0].message):this.notification.error(""+this.i18n.fanyi("function.menu.message-error.title"),""+e.message)},e=>{this.notification.error(""+this.i18n.fanyi("function.menu.message-error.title"),e.error?""+e.error.message:""+e.status)})}getById(e,t=!1){return Object(c.b)(this,void 0,void 0,(function*(){this.menuService.getById(e).subscribe(e=>{200===e.code&&null!=e.data?this.fillForm(e.data,t):this.notification.error(""+this.i18n.fanyi("function.menu.message-error.title"),""+e.message)},e=>{this.notification.error(""+this.i18n.fanyi("function.menu.message-error.title"),e.error?""+e.error.message:""+e.status)})}))}fillForm(e,t=!1){this.form.controls.parentId.setValue(e.parentId),this.form.controls.code.setValue(e.code),this.form.controls.name.setValue(e.name),this.form.controls.i18n.setValue(e.i18nName),this.form.controls.url.setValue(e.link),this.form.controls.icon.setValue(e.icon),this.form.controls.order.setValue(e.order),this.form.controls.hideBreadcrumb.setValue(e.hideInBreadcrumb),this.form.controls.status.setValue(e.status),this.roleIdsSelected=e.roleIds,this.convertListRoleToTreeData(t)}show(e){this.item=e.node.origin,this.onViewItem(this.item)}save(){var e;this.isLoading=!0,Object(a.B)(this.form);for(const n in this.form.controls)this.form.controls[n].markAsDirty(),this.form.controls[n].updateValueAndValidity();if(!this.form.valid)return this.isLoading=!1,this.messageService.error(""+this.i18n.fanyi("function.menu.message-error.form-invalid")),void(this.isLoading=!1);const t={id:null===(e=this.item)||void 0===e?void 0:e.id,name:this.form.controls.name.value,i18nName:this.form.controls.i18n.value,code:this.form.controls.code.value.toUpperCase(),parentId:this.form.controls.parentId.value,link:this.form.controls.url.value,icon:this.form.controls.icon.value,order:this.form.controls.order.value?this.form.controls.order.value:0,hideInBreadcrumb:!!this.form.controls.hideBreadcrumb.value&&this.form.controls.hideBreadcrumb.value,status:this.form.controls.status.value,roleIds:this.roleIdsSelected.filter((e,t,n)=>n.indexOf(e)===t)};this.isAdd&&this.menuService.create(t).subscribe(e=>{this.isLoading=!1,200===e.code&&null!=e.data?(this.messageService.success(""+e.message),this.resetForm(),this.initListMenu(),this.onAddItem()):this.messageService.error(""+e.message)},e=>{this.isLoading=!1,this.messageService.error(e.error?""+e.error.message:""+e.status)}),this.isEdit&&this.menuService.update(t).subscribe(e=>{this.isLoading=!1,200===e.code&&null!=e.data?(this.messageService.success(""+e.message),this.resetForm(),this.initListMenu(),this.onAddItem()):this.messageService.error(""+e.message)},e=>{this.isLoading=!1,this.messageService.error(e.error?""+e.error.message:""+e.status)})}nzEventRoleChange(e){this.roleIdsSelected=e.checkedKeys&&e.checkedKeys.length>0?this.roleIdsSelected.concat(e.checkedKeys.map(e=>e.origin.id)).filter((e,t,n)=>n.indexOf(e)===t):this.roleIdsSelected.filter(t=>{var n;return t!==(null===(n=e.node)||void 0===n?void 0:n.key)})}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(d.e),b.Ob(h.a),b.Ob(u.b),b.Ob(b.l),b.Ob(m.a),b.Ob(f.l),b.Ob(g.c),b.Ob(p.e),b.Ob(z.f),b.Ob(o.a),b.Ob(r.e))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-menu"]],viewQuery:function(e,t){var n;1&e&&b.Sc(i.f,!0),2&e&&b.wc(n=b.cc())&&(t.deleteModal=n.first)},decls:148,vars:99,consts:[["onBack","{() => window.history.back()}",3,"title"],[1,"card-header"],["nz-row","",1,"header"],["nz-col","","nzSpan","12"],[3,"routerLink"],["nz-icon","","nzType","home"],["nz-col","","nzSpan","12",2,"text-align","right"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","24","nzLg","8"],[3,"nzTitle","nzExtra"],["extraTpl",""],[3,"nzSuffix"],["type","text","nz-input","",3,"placeholder","ngModel","ngModelChange"],["suffixIcon",""],["nzShowLine","",2,"margin-top","10px",3,"nzData","nzSearchValue","nzExpandAll","nzClick"],["nz-col","","nzMd","24","nzLg","16"],["nz-form","","id","formMenu",3,"formGroup"],["nzSm","24","nzLg","11","nzXs","24"],[1,"flex-column"],["nzFor","parentId"],["formControlName","parentId","nzShowSearch","","nzShowLine","",3,"nzNodes","nzPlaceHolder"],["nzSm","24","nzLg","2","nzXs","24"],["nzRequired","","nzFor","code"],[3,"nzErrorTip"],["nz-input","","formControlName","code","id","code",2,"text-transform","uppercase",3,"placeholder"],["validateCode",""],["nzRequired","","nzFor","name"],["nz-input","","formControlName","name","id","name",3,"placeholder"],["validateName",""],["nzFor","i18n","nzRequired",""],["nz-input","","formControlName","i18n","id","i18n",3,"placeholder"],["validateI18nName",""],["nzFor","url"],["nz-input","","formControlName","url","id","url",3,"placeholder"],["validateUrl",""],["nzFor","icon"],["nz-input","","formControlName","icon","id","icon",3,"placeholder"],["validateIcon",""],["nzCheckable","","nzMultiple","",3,"nzData","nzExpandAll","nzCheckBoxChange","nzClick"],["nzSm","24","nzLg","11","nzXs","24",1,"form-item-order"],["nzFor","order"],["nz-input","","type","number","formControlName","order","id","order",3,"placeholder"],["validateOrder",""],["formControlName","hideBreadcrumb","nz-checkbox",""],["nzFor","status"],["formControlName","status","nzSize","small",2,"margin-right","5px"],[3,"nzColor","hidden"],[2,"float","right","margin","10px 0"],["nz-button","","nzType","primary","class","btn-primary",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","","nzType","danger","class","btn-danger",3,"click",4,"ngIf"],["nz-button","","nzType","default","class","btn-reload",3,"click",4,"ngIf"],["nz-button","","nzType","default",1,"btn-reload",3,"click"],["nz-icon","","nzType","reload","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"click"],["nz-icon","","nzType","file-add","nzTheme","fill"],["nz-icon","","nzType","search"],[4,"ngIf"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","disabled","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","danger",1,"btn-danger",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline"]],template:function(e,t){if(1&e&&(b.Ub(0,"page-header-wrapper",0),b.Ub(1,"nz-card",1),b.Ub(2,"div",2),b.Ub(3,"div",3),b.Ub(4,"nz-breadcrumb"),b.Ub(5,"nz-breadcrumb-item"),b.Ub(6,"a",4),b.Pb(7,"i",5),b.Tb(),b.Tb(),b.Ub(8,"nz-breadcrumb-item"),b.Ub(9,"a"),b.Ub(10,"span"),b.Nc(11),b.gc(12,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Ub(13,"nz-breadcrumb-item"),b.Ub(14,"a"),b.Nc(15),b.gc(16,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(17,"div",6),b.Tb(),b.Tb(),b.Ub(18,"div",7),b.Ub(19,"div",8),b.Ub(20,"nz-card",9),b.gc(21,"translate"),b.Lc(22,w,2,2,"ng-template",null,10,b.Mc),b.Ub(24,"nz-input-group",11),b.Ub(25,"input",12),b.bc("ngModelChange",(function(e){return t.searchMenuValue=e})),b.gc(26,"translate"),b.Tb(),b.Tb(),b.Lc(27,P,1,0,"ng-template",null,13,b.Mc),b.Ub(29,"nz-tree",14),b.bc("nzClick",(function(e){return t.show(e)})),b.Tb(),b.Tb(),b.Tb(),b.Ub(30,"div",15),b.Ub(31,"form",16),b.Ub(32,"nz-card"),b.Ub(33,"fieldset"),b.Ub(34,"legend"),b.Nc(35),b.gc(36,"translate"),b.Tb(),b.Ub(37,"nz-row"),b.Ub(38,"nz-col",17),b.Ub(39,"nz-form-item",18),b.Ub(40,"nz-form-label",19),b.Nc(41),b.gc(42,"translate"),b.Tb(),b.Ub(43,"nz-form-control"),b.Pb(44,"nz-tree-select",20),b.gc(45,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Pb(46,"nz-col",21),b.Ub(47,"nz-col",17),b.Ub(48,"nz-form-item",18),b.Ub(49,"nz-form-label",22),b.Nc(50),b.gc(51,"translate"),b.Tb(),b.Ub(52,"nz-form-control",23),b.Pb(53,"input",24),b.gc(54,"translate"),b.Lc(55,G,2,2,"ng-template",null,25,b.Mc),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(57,"br"),b.Ub(58,"nz-row"),b.Ub(59,"nz-col",17),b.Ub(60,"nz-form-item",18),b.Ub(61,"nz-form-label",26),b.Nc(62),b.gc(63,"translate"),b.Tb(),b.Ub(64,"nz-form-control",23),b.Pb(65,"input",27),b.gc(66,"translate"),b.Lc(67,$,2,2,"ng-template",null,28,b.Mc),b.Tb(),b.Tb(),b.Tb(),b.Pb(69,"nz-col",21),b.Ub(70,"nz-col",17),b.Ub(71,"nz-form-item",18),b.Ub(72,"nz-form-label",29),b.Nc(73),b.gc(74,"translate"),b.Tb(),b.Ub(75,"nz-form-control",23),b.Pb(76,"input",30),b.gc(77,"translate"),b.Lc(78,j,2,2,"ng-template",null,31,b.Mc),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(80,"br"),b.Ub(81,"nz-row"),b.Ub(82,"nz-col",17),b.Ub(83,"nz-form-item",18),b.Ub(84,"nz-form-label",32),b.Nc(85),b.gc(86,"translate"),b.Tb(),b.Ub(87,"nz-form-control",23),b.Pb(88,"input",33),b.gc(89,"translate"),b.Lc(90,J,2,2,"ng-template",null,34,b.Mc),b.Tb(),b.Tb(),b.Tb(),b.Pb(92,"nz-col",21),b.Ub(93,"nz-col",17),b.Ub(94,"nz-form-item",18),b.Ub(95,"nz-form-label",35),b.Nc(96),b.gc(97,"translate"),b.Tb(),b.Ub(98,"nz-form-control",23),b.Pb(99,"input",36),b.gc(100,"translate"),b.Lc(101,Z,2,2,"ng-template",null,37,b.Mc),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(103,"br"),b.Ub(104,"nz-row"),b.Ub(105,"nz-col",17),b.Ub(106,"nz-form-item"),b.Ub(107,"nz-form-label"),b.Nc(108),b.gc(109,"translate"),b.Tb(),b.Ub(110,"nz-form-control"),b.Ub(111,"nz-tree",38),b.bc("nzCheckBoxChange",(function(e){return t.nzEventRoleChange(e)}))("nzClick",(function(e){return t.nzEventRoleChange(e)})),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(112,"nz-col",21),b.Ub(113,"nz-col",39),b.Ub(114,"nz-form-item",18),b.Ub(115,"nz-form-label",40),b.Nc(116),b.gc(117,"translate"),b.Tb(),b.Ub(118,"nz-form-control",23),b.Pb(119,"input",41),b.gc(120,"translate"),b.Lc(121,te,1,1,"ng-template",null,42,b.Mc),b.Tb(),b.Tb(),b.Pb(123,"br"),b.Ub(124,"nz-form-item",18),b.Ub(125,"nz-form-control"),b.Ub(126,"label",43),b.Nc(127),b.gc(128,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Pb(129,"br"),b.Ub(130,"nz-form-item",18),b.Ub(131,"nz-form-label",44),b.Nc(132),b.gc(133,"translate"),b.Tb(),b.Ub(134,"nz-form-control"),b.Pb(135,"nz-switch",45),b.Ub(136,"label"),b.Ub(137,"nz-tag",46),b.Nc(138),b.gc(139,"translate"),b.Tb(),b.Ub(140,"nz-tag",46),b.Nc(141),b.gc(142,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(143,"br"),b.Tb(),b.Ub(144,"div",47),b.Lc(145,ne,3,1,"button",48),b.Lc(146,ie,3,3,"button",49),b.Lc(147,se,3,1,"button",50),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb()),2&e){const e=b.xc(23),n=b.xc(28),i=b.xc(56),s=b.xc(68),c=b.xc(79),r=b.xc(91),o=b.xc(102),a=b.xc(122);b.nc("title",t.tittle),b.Ab(6),b.nc("routerLink",b.rc(98,ce)),b.Ab(5),b.Oc(b.hc(12,50,"menu.permission")),b.Ab(4),b.Pc(" ",b.hc(16,52,"layout.breadcum.menu")," "),b.Ab(3),b.nc("nzGutter",32),b.Ab(2),b.oc("nzTitle",b.hc(21,54,"function.menu.list.header")),b.nc("nzExtra",e),b.Ab(4),b.nc("nzSuffix",n),b.Ab(1),b.oc("placeholder",b.hc(26,56,"layout.grid.search.text-search.placeholder")),b.nc("ngModel",t.searchMenuValue),b.Ab(4),b.nc("nzData",t.treeMenuData)("nzSearchValue",t.searchMenuValue)("nzExpandAll",t.expandAll),b.Ab(2),b.nc("formGroup",t.form),b.Ab(4),b.Oc(b.hc(36,58,"function.menu.menu-info.header")),b.Ab(6),b.Oc(b.hc(42,60,"function.menu.parent.label")),b.Ab(3),b.oc("nzPlaceHolder",b.hc(45,62,"function.menu.parent.placeholder")),b.nc("nzNodes",t.treeMenuData),b.Ab(6),b.Oc(b.hc(51,64,"function.menu.code.label")),b.Ab(2),b.nc("nzErrorTip",i),b.Ab(1),b.oc("placeholder",b.hc(54,66,"function.menu.code.placeholder")),b.Ab(9),b.Oc(b.hc(63,68,"function.menu.name.label")),b.Ab(2),b.nc("nzErrorTip",s),b.Ab(1),b.oc("placeholder",b.hc(66,70,"function.menu.name.placeholder")),b.Ab(8),b.Oc(b.hc(74,72,"function.menu.i18n.label")),b.Ab(2),b.nc("nzErrorTip",c),b.Ab(1),b.oc("placeholder",b.hc(77,74,"function.menu.i18n.placeholder")),b.Ab(9),b.Oc(b.hc(86,76,"function.menu.url.label")),b.Ab(2),b.nc("nzErrorTip",r),b.Ab(1),b.oc("placeholder",b.hc(89,78,"function.menu.url.placeholder")),b.Ab(8),b.Oc(b.hc(97,80,"function.menu.icon.label")),b.Ab(2),b.nc("nzErrorTip",o),b.Ab(1),b.oc("placeholder",b.hc(100,82,"function.menu.icon.placeholder")),b.Ab(9),b.Oc(b.hc(109,84,"function.menu.role.label")),b.Ab(3),b.nc("nzData",t.treeRoleData)("nzExpandAll",!0),b.Ab(5),b.Oc(b.hc(117,86,"function.menu.order.label")),b.Ab(2),b.nc("nzErrorTip",a),b.Ab(1),b.oc("placeholder",b.hc(120,88,"function.menu.order.placeholder")),b.Ab(8),b.Pc(" ",b.hc(128,90,"function.menu.hide-breadcrumb.label")," "),b.Ab(5),b.Oc(b.hc(133,92,"function.menu.status.label")),b.Ab(5),b.nc("nzColor","#00BB00")("hidden",!t.form.value.status),b.Ab(1),b.Oc(b.hc(139,94,"function.menu.status-true.label")),b.Ab(2),b.nc("nzColor","#EF5350")("hidden",t.form.value.status),b.Ab(1),b.Oc(b.hc(142,96,"function.menu.status-false.label")),b.Ab(4),b.nc("ngIf",t.btnEdit.visible&&t.btnEdit.grandAccess&&t.isInfo),b.Ab(1),b.nc("ngIf",!t.isInfo&&t.btnSave.visible&&t.btnSave.grandAccess),b.Ab(1),b.nc("ngIf",t.btnDelete.visible&&t.btnDelete.grandAccess&&(t.isInfo||t.isEdit))}},directives:[T.a,v.a,A.c,A.a,y.a,y.b,s.m,S.a,U.a,I.c,I.d,I.b,d.d,d.o,d.r,C.a,d.x,d.p,k.b,d.h,k.c,k.d,k.a,L.a,d.g,d.s,O.a,R.a,D.a,r.o,M.a,E.a],pipes:[x.c],styles:[".form-item-order[_ngcontent-%COMP%] > .ant-form-item-with-help[_ngcontent-%COMP%]{margin-bottom:24px}"]}),e})();function oe(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",40),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnReload.click(t)})),b.Pb(1,"i",41),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc("",e.btnReload.titlei18n," ")}}function ae(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",42),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnAdd.click(t)})),b.Pb(1,"i",43),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc("",e.btnAdd.titlei18n," ")}}function le(e,t){if(1&e&&(b.Lc(0,oe,3,1,"button",39),b.Lc(1,ae,3,1,"button",36)),2&e){const e=b.fc();b.nc("ngIf",e.btnReload.visible&&e.btnReload.grandAccess),b.Ab(1),b.nc("ngIf",e.btnAdd.visible&&e.btnAdd.grandAccess)}}function de(e,t){1&e&&b.Pb(0,"i",44)}function be(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.right.group-name.message.required"),""))}function he(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.right.group-name.message.pattern"),""))}function ue(e,t){if(1&e&&(b.Lc(0,be,3,3,"ng-container",45),b.Lc(1,he,3,3,"ng-container",45)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function me(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.right.code.message.required"),""))}function fe(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.right.code.message.pattern"),""))}function ge(e,t){if(1&e&&(b.Lc(0,me,3,3,"ng-container",45),b.Lc(1,fe,3,3,"ng-container",45)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function pe(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.right.name.message.required"),""))}function ze(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Pc(" ",b.hc(2,1,"function.right.name.message.pattern"),""))}function Te(e,t){if(1&e&&(b.Lc(0,pe,3,3,"ng-container",45),b.Lc(1,ze,3,3,"ng-container",45)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function ve(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",42),b.bc("click",(function(t){return b.Ac(e),b.fc().btnEdit.click(t)})),b.Pb(1,"i",46),b.Nc(2),b.Tb()}if(2&e){const e=b.fc();b.Ab(2),b.Pc("",e.btnEdit.titlei18n," ")}}function Ae(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",47),b.bc("click",(function(t){return b.Ac(e),b.fc().btnSave.click(t)})),b.Pb(1,"i",48),b.Nc(2),b.Tb()}if(2&e){const e=b.fc();b.nc("nzLoading",e.isLoading)("disabled",!e.form.valid),b.Ab(2),b.Pc("",e.btnSave.titlei18n," ")}}function ye(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",49),b.bc("click",(function(t){return b.Ac(e),b.fc().btnDelete.click(t)})),b.Pb(1,"i",50),b.Nc(2),b.Tb()}if(2&e){const e=b.fc();b.Ab(2),b.Pc("",e.btnDelete.titlei18n," ")}}const Se=function(){return["/"]};let Ue=(()=>{class e{constructor(e,t,n,i,s,c,r,o,b,h,u){this.fb=e,this.aclService=t,this.notification=n,this.elementRef=i,this.roleService=s,this.rightService=c,this.arrayService=r,this.messageService=o,this.modal=b,this.i18n=h,this.doc=u,this.isRenderComplete=!1,this.listStatus=a.m,this.filter=Object.assign({},a.s),this.pageSizeOptions=[],this.paginationMessage="",this.modules=[l.a],this.rowSelection="multiple",this.overlayLoadingTemplate=a.p,this.overlayNoRowsTemplate=a.q,this.quickText="",this.isLoadingDelete=!1,this.isShowDelete=!1,this.isShowImport=!1,this.tittle=""+this.i18n.fanyi("function.right.title"),this.treeRightData=[],this.rightList=[],this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.listRole=[],this.treeRoleData=[],this.isLoading=!1,this.delDisabled=!1,this.expandAll=!0,this.btnAdd={title:"Th\xeam m\u1edbi",titlei18n:""+this.i18n.fanyi("layout.button.btn-add.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.onAddItem()}},this.btnDelete={title:"X\xf3a",titlei18n:""+this.i18n.fanyi("layout.button.btn-delete.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.onDeleteItem()}},this.btnReload={title:"T\u1ea3i l\u1ea1i",titlei18n:""+this.i18n.fanyi("layout.button.btn-reload.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.initListRight()}},this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.save()}},this.btnEdit={title:"C\u1eadp nh\u1eadt",titlei18n:""+this.i18n.fanyi("layout.button.btn-edit.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.onEditItem(this.item)}},this.form=this.fb.group({code:[{value:null,disabled:!1},[d.w.required,d.w.pattern(a.t)]],name:[{value:null,disabled:!1},[d.w.required,d.w.pattern(a.v)]],groupName:[{value:null,disabled:!1},[d.w.required,d.w.pattern(a.v)]],order:[{value:0,disabled:!1},[d.w.min(0)]],status:[{value:!0,disabled:!1}]})}ngOnInit(){this.initRightOfUser(),this.isRenderComplete=!0,this.initListRole(),this.initListRight()}initRightOfUser(){this.btnAdd.grandAccess=this.aclService.canAbility("RIGHT-ADD"),this.btnDelete.grandAccess=this.aclService.canAbility("RIGHT-DELETE"),this.btnEdit.grandAccess=this.aclService.canAbility("RIGHT-EDIT")}initListRole(){this.roleService.getListCombobox().subscribe(e=>{e.data&&(e.data.forEach(e=>{e.parent_id=null}),this.listRole=e.data,this.convertListRoleToTreeData())},e=>console.log(e))}initListRight(){this.rightService.getListCombobox().subscribe(e=>{if(200!==e.code)return void this.notification.error(""+this.i18n.fanyi("function.right.message-error.title"),""+e.message);if(null==e.data)return void this.notification.error(""+this.i18n.fanyi("function.right.message-error.title"),""+e.message);const t=e.data,n=t.map(e=>e.groupName).filter((e,t,n)=>n.indexOf(e)===t),i=[];for(const c of n)i.push({groupName:null,name:c,code:c,id:c});const s=t.concat(i).map((e,t,n)=>{const i=n.some(t=>t.groupName===e.id);return{id:e.id,parent_id:e.groupName,title:e.name,isLeaf:!i,expanded:!0,selected:!1,checked:!1}});this.treeRightData=this.arrayService.arrToTreeNode(s,{cb:(e,t,n)=>{e.selected=0===e.id}})},e=>{})}convertListRoleToTreeData(e=!1){const t=this.listRole.map((t,n,i)=>{const s=i.some(e=>e.parentId===t.id);return{id:t.id,parent_id:t.parentId,title:t.name,isLeaf:!s,expanded:!1,selected:!1,checked:!1,disabled:e,disableCheckbox:e}});this.treeRoleData=this.arrayService.arrToTreeNode(t,{cb:(e,t,n)=>{e.selected=0===e.id}})}onAddItem(){this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.form.enable(),this.resetForm(),this.item=null}onEditItem(e=null){this.isAdd=!1,this.isEdit=!0,this.isInfo=!1,this.item=e,this.form.enable(),this.form.controls.code.disable(),this.getById(e.id,!1)}onViewItem(e=null){this.isAdd=!1,this.isEdit=!1,this.isInfo=!0,this.item=e,this.form.disable(),this.getById(e.id,!0)}resetForm(){var e,t,n;this.form.reset(),null===(e=this.form.get("status"))||void 0===e||e.setValue(!0),null===(t=this.form.get("order"))||void 0===t||t.setValue(0),null===(n=this.form.get("code"))||void 0===n||n.enable(),this.convertListRoleToTreeData()}onDeleteItem(){this.modal.confirm({nzTitle:""+this.i18n.fanyi("function.right.modal-delete.header"),nzContent:""+this.i18n.fanyi("function.right.modal-delete.body"),nzOkText:""+this.i18n.fanyi("function.right.modal-delete.button.yes"),nzOkType:"primary",nzOkDanger:!0,nzOnOk:()=>this.delete(),nzCancelText:""+this.i18n.fanyi("function.right.modal-delete.button.no"),nzOnCancel:()=>{}})}delete(){var e;const t=[null===(e=this.item)||void 0===e?void 0:e.id];this.rightService.delete(t).subscribe(e=>{200===e.code&&null!=e.data?e.data[0].result?(this.messageService.success(""+e.message),Object(a.B)(this.form),this.resetForm(),this.initListRight(),this.onAddItem()):this.notification.error(""+this.i18n.fanyi("function.menu.message-error.title"),""+e.data[0].message):this.notification.error(""+this.i18n.fanyi("function.right.message-error.title"),""+e.message)},e=>{this.notification.error(""+this.i18n.fanyi("function.right.message-error.title"),e.error?""+e.error.message:""+e.status)})}getById(e,t=!1){return Object(c.b)(this,void 0,void 0,(function*(){this.rightService.getById(e).subscribe(e=>{200===e.code&&null!=e.data?this.fillForm(e.data,t):this.notification.error(""+this.i18n.fanyi("function.right.message-error.title"),""+e.message)},e=>{this.notification.error(""+this.i18n.fanyi("function.right.message-error.title"),e.error?""+e.error.message:""+e.status)})}))}fillForm(e,t=!1){this.form.controls.code.setValue(e.code),this.form.controls.name.setValue(e.name),this.form.controls.groupName.setValue(e.groupName),this.form.controls.order.setValue(e.order),this.form.controls.status.setValue(e.status),this.convertListRoleToTreeData(t)}show(e){this.item=e.node.origin,this.item.isLeaf&&this.onViewItem(this.item)}save(){var e;this.isLoading=!0,Object(a.B)(this.form);for(const n in this.form.controls)this.form.controls[n].markAsDirty(),this.form.controls[n].updateValueAndValidity();if(!this.form.valid)return this.isLoading=!1,this.messageService.error(""+this.i18n.fanyi("function.right.message-error.form-invalid")),void(this.isLoading=!1);const t={id:null===(e=this.item)||void 0===e?void 0:e.id,name:this.form.controls.name.value,groupName:this.form.controls.groupName.value,code:this.form.controls.code.value.toUpperCase(),order:this.form.controls.order.value?this.form.controls.order.value:0,status:this.form.controls.status.value};this.isAdd&&this.rightService.create(t).subscribe(e=>{this.isLoading=!1,200===e.code&&null!=e.data?(this.messageService.success(""+e.message),this.resetForm(),this.initListRight(),this.onAddItem()):this.messageService.error(""+e.message)},e=>{this.isLoading=!1,this.messageService.error(e.error?""+e.error.message:""+e.status)}),this.isEdit&&this.rightService.update(t).subscribe(e=>{this.isLoading=!1,200===e.code&&null!=e.data?(this.messageService.success(""+e.message),this.resetForm(),this.initListRight(),this.onAddItem()):this.messageService.error(""+e.message)},e=>{this.isLoading=!1,this.messageService.error(e.error?""+e.error.message:""+e.status)})}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(d.e),b.Ob(h.a),b.Ob(u.b),b.Ob(b.l),b.Ob(m.a),b.Ob(f.r),b.Ob(g.c),b.Ob(p.e),b.Ob(z.f),b.Ob(o.a),b.Ob(r.e))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-right"]],viewQuery:function(e,t){var n;1&e&&b.Sc(i.f,!0),2&e&&b.wc(n=b.cc())&&(t.deleteModal=n.first)},decls:102,vars:72,consts:[["onBack","{() => window.history.back()}",3,"title"],[1,"card-header"],["nz-row","",1,"header"],["nz-col","","nzSpan","12"],[3,"routerLink"],["nz-icon","","nzType","home"],["nz-col","","nzSpan","12",2,"text-align","right"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","24","nzLg","8"],[3,"nzTitle","nzExtra"],["extraTpl",""],[3,"nzSuffix"],["type","text","nz-input","",3,"placeholder","ngModel","ngModelChange"],["suffixIcon",""],["nzShowLine","",2,"margin-top","10px","height","68vh","overflow-y","auto",3,"nzData","nzSearchValue","nzExpandAll","nzClick"],["nz-col","","nzMd","24","nzLg","16"],["nz-form","","id","formRight",3,"formGroup"],["nzSm","24","nzLg","11","nzXs","24"],[1,"flex-column"],["nzRequired","","nzFor","groupName"],[3,"nzErrorTip"],["nz-input","","formControlName","groupName","id","groupName","autocomplete","on",3,"placeholder"],["validateGroupName",""],["nzSm","24","nzLg","2","nzXs","24"],["nzRequired","","nzFor","code"],["nz-input","","formControlName","code","id","code",2,"text-transform","uppercase",3,"placeholder"],["validateCode",""],["nzRequired","","nzFor","name"],["nz-input","","formControlName","name","id","name",3,"placeholder"],["validateName",""],["nzFor","order"],["nz-input","","type","number","formControlName","order","id","order",3,"placeholder"],["nzFor","status"],["formControlName","status","nzSize","small",2,"margin-right","5px"],[3,"nzColor","hidden"],[2,"float","right","margin","10px 0"],["nz-button","","nzType","primary","class","btn-primary",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","","nzType","danger","class","btn-danger",3,"click",4,"ngIf"],["nz-button","","nzType","default","class","btn-reload",3,"click",4,"ngIf"],["nz-button","","nzType","default",1,"btn-reload",3,"click"],["nz-icon","","nzType","reload","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"click"],["nz-icon","","nzType","file-add","nzTheme","fill"],["nz-icon","","nzType","search"],[4,"ngIf"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","disabled","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","danger",1,"btn-danger",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline"]],template:function(e,t){if(1&e&&(b.Ub(0,"page-header-wrapper",0),b.Ub(1,"nz-card",1),b.Ub(2,"div",2),b.Ub(3,"div",3),b.Ub(4,"nz-breadcrumb"),b.Ub(5,"nz-breadcrumb-item"),b.Ub(6,"a",4),b.Pb(7,"i",5),b.Tb(),b.Tb(),b.Ub(8,"nz-breadcrumb-item"),b.Ub(9,"a"),b.Ub(10,"span"),b.Nc(11),b.gc(12,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Ub(13,"nz-breadcrumb-item"),b.Ub(14,"a"),b.Nc(15),b.gc(16,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(17,"div",6),b.Tb(),b.Tb(),b.Ub(18,"div",7),b.Ub(19,"div",8),b.Ub(20,"nz-card",9),b.gc(21,"translate"),b.Lc(22,le,2,2,"ng-template",null,10,b.Mc),b.Ub(24,"nz-input-group",11),b.Ub(25,"input",12),b.bc("ngModelChange",(function(e){return t.searchRightValue=e})),b.gc(26,"translate"),b.Tb(),b.Tb(),b.Lc(27,de,1,0,"ng-template",null,13,b.Mc),b.Ub(29,"nz-tree",14),b.bc("nzClick",(function(e){return t.show(e)})),b.Tb(),b.Tb(),b.Tb(),b.Ub(30,"div",15),b.Ub(31,"form",16),b.Ub(32,"nz-card"),b.Ub(33,"fieldset"),b.Ub(34,"legend"),b.Nc(35),b.gc(36,"translate"),b.Tb(),b.Ub(37,"nz-row"),b.Ub(38,"nz-col",17),b.Ub(39,"nz-form-item",18),b.Ub(40,"nz-form-label",19),b.Nc(41),b.gc(42,"translate"),b.Tb(),b.Ub(43,"nz-form-control",20),b.Pb(44,"input",21),b.gc(45,"translate"),b.Lc(46,ue,2,2,"ng-template",null,22,b.Mc),b.Tb(),b.Tb(),b.Tb(),b.Pb(48,"nz-col",23),b.Ub(49,"nz-col",17),b.Ub(50,"nz-form-item",18),b.Ub(51,"nz-form-label",24),b.Nc(52),b.gc(53,"translate"),b.Tb(),b.Ub(54,"nz-form-control",20),b.Pb(55,"input",25),b.gc(56,"translate"),b.Lc(57,ge,2,2,"ng-template",null,26,b.Mc),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(59,"br"),b.Ub(60,"nz-row"),b.Ub(61,"nz-col",17),b.Ub(62,"nz-form-item",18),b.Ub(63,"nz-form-label",27),b.Nc(64),b.gc(65,"translate"),b.Tb(),b.Ub(66,"nz-form-control",20),b.Pb(67,"input",28),b.gc(68,"translate"),b.Lc(69,Te,2,2,"ng-template",null,29,b.Mc),b.Tb(),b.Tb(),b.Tb(),b.Pb(71,"nz-col",23),b.Ub(72,"nz-col",17),b.Ub(73,"nz-form-item",18),b.Ub(74,"nz-form-label",30),b.Nc(75),b.gc(76,"translate"),b.Tb(),b.Ub(77,"nz-form-control",20),b.gc(78,"translate"),b.Pb(79,"input",31),b.gc(80,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(81,"br"),b.Ub(82,"nz-row"),b.Ub(83,"nz-col",17),b.Ub(84,"nz-form-item",18),b.Ub(85,"nz-form-label",32),b.Nc(86),b.gc(87,"translate"),b.Tb(),b.Ub(88,"nz-form-control"),b.Pb(89,"nz-switch",33),b.Ub(90,"label"),b.Ub(91,"nz-tag",34),b.Nc(92),b.gc(93,"translate"),b.Tb(),b.Ub(94,"nz-tag",34),b.Nc(95),b.gc(96,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Pb(97,"br"),b.Tb(),b.Ub(98,"div",35),b.Lc(99,ve,3,1,"button",36),b.Lc(100,Ae,3,3,"button",37),b.Lc(101,ye,3,1,"button",38),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb()),2&e){const e=b.xc(23),n=b.xc(28),i=b.xc(47),s=b.xc(58),c=b.xc(70);b.nc("title",t.tittle),b.Ab(6),b.nc("routerLink",b.rc(71,Se)),b.Ab(5),b.Oc(b.hc(12,37,"menu.permission")),b.Ab(4),b.Pc(" ",b.hc(16,39,"layout.breadcum.right")," "),b.Ab(3),b.nc("nzGutter",32),b.Ab(2),b.oc("nzTitle",b.hc(21,41,"function.right.list.header")),b.nc("nzExtra",e),b.Ab(4),b.nc("nzSuffix",n),b.Ab(1),b.oc("placeholder",b.hc(26,43,"layout.grid.search.text-search.placeholder")),b.nc("ngModel",t.searchRightValue),b.Ab(4),b.nc("nzData",t.treeRightData)("nzSearchValue",t.searchRightValue)("nzExpandAll",t.expandAll),b.Ab(2),b.nc("formGroup",t.form),b.Ab(4),b.Oc(b.hc(36,45,"function.right.right-info.header")),b.Ab(6),b.Oc(b.hc(42,47,"function.right.group-name.label")),b.Ab(2),b.nc("nzErrorTip",i),b.Ab(1),b.oc("placeholder",b.hc(45,49,"function.right.group-name.placeholder")),b.Ab(8),b.Oc(b.hc(53,51,"function.right.code.label")),b.Ab(2),b.nc("nzErrorTip",s),b.Ab(1),b.oc("placeholder",b.hc(56,53,"function.right.code.placeholder")),b.Ab(9),b.Oc(b.hc(65,55,"function.right.name.label")),b.Ab(2),b.nc("nzErrorTip",c),b.Ab(1),b.oc("placeholder",b.hc(68,57,"function.right.name.placeholder")),b.Ab(8),b.Oc(b.hc(76,59,"function.right.order.label")),b.Ab(2),b.oc("nzErrorTip",b.hc(78,61,"function.right.order.error.message")),b.Ab(2),b.oc("placeholder",b.hc(80,63,"function.right.order.placeholder")),b.Ab(7),b.Oc(b.hc(87,65,"function.right.status.label")),b.Ab(5),b.nc("nzColor","#00BB00")("hidden",!t.form.value.status),b.Ab(1),b.Oc(b.hc(93,67,"function.right.status-true.label")),b.Ab(2),b.nc("nzColor","#EF5350")("hidden",t.form.value.status),b.Ab(1),b.Oc(b.hc(96,69,"function.right.status-false.label")),b.Ab(4),b.nc("ngIf",t.btnEdit.visible&&t.btnEdit.grandAccess&&t.isInfo),b.Ab(1),b.nc("ngIf",!t.isInfo&&t.btnSave.visible&&t.btnSave.grandAccess),b.Ab(1),b.nc("ngIf",t.btnDelete.visible&&t.btnDelete.grandAccess&&(t.isInfo||t.isEdit))}},directives:[T.a,v.a,A.c,A.a,y.a,y.b,s.m,S.a,U.a,I.c,I.d,I.b,d.d,d.o,d.r,C.a,d.x,d.p,k.b,d.h,k.c,k.d,k.a,d.g,d.s,R.a,D.a,r.o,M.a,E.a],pipes:[x.c],styles:[""]}),e})();function Ie(e,t){if(1&e&&b.Nc(0),2&e){const e=b.fc();b.Pc(" ",e.tittle," ")}}function Ce(e,t){1&e&&b.Pb(0,"i",13)}function ke(e,t){1&e&&b.Pb(0,"i",13)}function Le(e,t){if(1&e){const e=b.Vb();b.Ub(0,"nz-row"),b.Ub(1,"nz-col",4),b.Ub(2,"fieldset",5),b.Ub(3,"legend"),b.Nc(4),b.gc(5,"translate"),b.Tb(),b.Ub(6,"h3"),b.Nc(7),b.gc(8,"translate"),b.Tb(),b.Ub(9,"nz-tree",6),b.bc("nzCheckBoxChange",(function(t){return b.Ac(e),b.fc().nzEventDocType(t)}))("nzClick",(function(t){return b.Ac(e),b.fc().nzEventDocType(t)})),b.Tb(),b.Pb(10,"br"),b.Ub(11,"h3"),b.Nc(12),b.gc(13,"translate"),b.Ub(14,"span",7),b.Ub(15,"i"),b.Nc(16,"(\u0111\xe3 ch\u1ecdn "),b.Ub(17,"b"),b.Nc(18),b.Tb(),b.Nc(19,")"),b.Tb(),b.Tb(),b.Tb(),b.Ub(20,"nz-input-group",8),b.Ub(21,"input",9),b.bc("ngModelChange",(function(t){return b.Ac(e),b.fc().orgDocSearchValue=t})),b.Tb(),b.Tb(),b.Lc(22,Ce,1,0,"ng-template",null,10,b.Mc),b.Ub(24,"nz-tree",11),b.bc("nzCheckBoxChange",(function(t){return b.Ac(e),b.fc().nzEventOrgDoc(t)}))("nzClick",(function(t){return b.Ac(e),b.fc().nzEventOrgDoc(t)}))("nzSearchValueChange",(function(t){return b.Ac(e),b.fc().nzEventOrgDocSearch(t)})),b.Tb(),b.Tb(),b.Tb(),b.Ub(25,"nz-col",4),b.Ub(26,"fieldset",5),b.Ub(27,"legend"),b.Nc(28),b.gc(29,"translate"),b.Tb(),b.Ub(30,"h3"),b.Nc(31),b.gc(32,"translate"),b.Ub(33,"span",7),b.Ub(34,"i"),b.Nc(35,"(\u0111\xe3 ch\u1ecdn "),b.Ub(36,"b"),b.Nc(37),b.Tb(),b.Nc(38,")"),b.Tb(),b.Tb(),b.Tb(),b.Ub(39,"nz-input-group",8),b.Ub(40,"input",12),b.bc("ngModelChange",(function(t){return b.Ac(e),b.fc().orgUserSearchValue=t})),b.Tb(),b.Tb(),b.Lc(41,ke,1,0,"ng-template",null,10,b.Mc),b.Ub(43,"nz-tree",11),b.bc("nzCheckBoxChange",(function(t){return b.Ac(e),b.fc().nzEventOrgUser(t)}))("nzClick",(function(t){return b.Ac(e),b.fc().nzEventOrgUser(t)}))("nzSearchValueChange",(function(t){return b.Ac(e),b.fc().nzEventOrgUserSearch(t)})),b.Tb(),b.Tb(),b.Tb(),b.Tb()}if(2&e){const e=b.xc(23),t=b.fc();b.Ab(1),b.nc("nzSm",12)("nzXs",12),b.Ab(3),b.Oc(b.hc(5,25,"function.role.modal-permission.document")),b.Ab(3),b.Oc(b.hc(8,27,"function.role.modal-permission.document.document-type.label")),b.Ab(2),b.nc("nzData",t.documentTypes)("nzExpandAll",!0),b.Ab(3),b.Pc(" ",b.hc(13,29,"function.role.modal-permission.document.organization.label"),": "),b.Ab(6),b.Oc(t.orgDocCheckedLength),b.Ab(2),b.nc("nzSuffix",e),b.Ab(1),b.nc("ngModel",t.orgDocSearchValue),b.Ab(3),b.nc("nzData",t.organizationDataDoc)("nzExpandAll",t.expandAllOrgDoc)("nzCheckStrictly",t.checkStrictlyOrgDoc)("nzSearchValue",t.orgDocSearchValue),b.Ab(1),b.nc("nzSm",12)("nzXs",12),b.Ab(3),b.Oc(b.hc(29,31,"function.role.modal-permission.user")),b.Ab(3),b.Pc(" ",b.hc(32,33,"function.role.modal-permission.user.organization.label"),": "),b.Ab(6),b.Oc(t.orgUserCheckedLength),b.Ab(2),b.nc("nzSuffix",e),b.Ab(1),b.nc("ngModel",t.orgUserSearchValue),b.Ab(3),b.nc("nzData",t.organizationDataUser)("nzExpandAll",t.expandAllOrgUser)("nzCheckStrictly",t.checkStrictlyOrgUser)("nzSearchValue",t.orgUserSearchValue)}}function Oe(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",16),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnSave.click(t)})),b.Pb(1,"i",17),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.nc("nzLoading",e.isLoading),b.Ab(2),b.Pc(" ",e.btnSave.titlei18n," ")}}function Re(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",18),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnCancel.click(t)})),b.Pb(1,"i",19),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc(" ",e.btnCancel.titlei18n," ")}}function De(e,t){if(1&e&&(b.Lc(0,Oe,3,2,"button",14),b.Lc(1,Re,3,1,"button",15)),2&e){const e=b.fc();b.nc("ngIf",e.btnSave.visible&&e.btnSave.grandAccess),b.Ab(1),b.nc("ngIf",e.btnCancel.visible&&e.btnCancel.grandAccess)}}let Me=(()=>{class e{constructor(e,t,n,i){this.messageService=e,this.roleApiService=t,this.arrayService=n,this.i18n=i,this.isVisibleModalPermission=!1,this.eventEmmit=new b.n,this.tittle="",this.isLoading=!1,this.documentTypes=[],this.organizationDataDoc=[],this.organizationDataUser=[],this.expandAllOrgDoc=!1,this.expandAllOrgUser=!1,this.checkStrictlyOrgDoc=!0,this.checkStrictlyOrgUser=!0,this.docTypeIds=[],this.orgDocIds=[],this.orgUserIds=[],this.levelExpand=2,this.orgDocCheckedLength=0,this.orgUserCheckedLength=0,this.listOrg=[],this.listDocType=[],this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.handleCancel()}}}ngOnInit(){}docTypeConvertToTree(){const e=this.listDocType.map((e,t,n)=>{const i=n.some(t=>t.parentId===e.id),s=this.docTypeIds.some(t=>t===e.id);return{id:e.id,parent_id:e.parentId,title:e.name,isLeaf:!i,expanded:!1,selected:!1,checked:s}});this.documentTypes=this.arrayService.arrToTreeNode(e,{cb:(e,t,n)=>{e.selected=0===e.id}})}organizationConvertToTree(){const e=this.listOrg.map((e,t,n)=>{const i=n.some(t=>t.parentId===e.id),s=this.orgDocIds.some(t=>t===e.id);return{id:e.id,parent_id:e.parentId,title:e.name,isLeaf:!i,expanded:!1,selected:!1,checked:s}}),t=this.listOrg.map((e,t,n)=>{const i=n.some(t=>t.parentId===e.id),s=this.orgUserIds.some(t=>t===e.id);return{id:e.id,parent_id:e.parentId,title:e.name,isLeaf:!i,expanded:!1,selected:!1,checked:s}});this.organizationDataDoc=this.arrayService.arrToTreeNode(e,{cb:(e,t,n)=>{e.expanded=n<=this.levelExpand,e.selected=0===e.id}}),this.organizationDataUser=this.arrayService.arrToTreeNode(t,{cb:(e,t,n)=>{e.expanded=n<=this.levelExpand,e.selected=0===e.id}})}handleCancel(){this.isVisibleModalPermission=!1,this.eventEmmit.emit({type:"close"})}initData(e,t,n){this.listDocType=t,this.listOrg=n,this.orgDocCheckedLength=0,this.orgUserCheckedLength=0,this.isVisibleModalPermission=!0,this.roleId=e.id,this.tittle=`${this.i18n.fanyi("function.role.modal-permission.header")}: ${e.code}`,this.getDataPermission()}getDataPermission(){this.roleApiService.getDataPermission({id:this.roleId}).subscribe(e=>{this.docTypeIds=e.data.listDocumentTypeId,this.orgUserIds=e.data.listUserInfoOfOrganizationId,this.orgDocIds=e.data.listDocumentOfOrganizationId,this.orgDocCheckedLength=this.orgDocIds.filter((e,t,n)=>n.indexOf(e)===t).length,this.orgUserCheckedLength=this.orgUserIds.filter((e,t,n)=>n.indexOf(e)===t).length,this.docTypeConvertToTree(),this.organizationConvertToTree()},e=>{console.log(e)})}nzEventDocType(e){this.docTypeIds=e.checkedKeys&&e.checkedKeys.length>0?this.docTypeIds.concat(e.checkedKeys.map(e=>e.origin.id)).filter((e,t,n)=>n.indexOf(e)===t):this.docTypeIds.filter(t=>{var n;return t!==(null===(n=e.node)||void 0===n?void 0:n.key)})}nzEventOrgDoc(e){e.checkedKeys&&e.checkedKeys.length>0?(this.orgDocIds=this.orgDocIds.concat(e.checkedKeys.map(e=>e.origin.id)).filter((e,t,n)=>n.indexOf(e)===t),this.orgDocCheckedLength=this.orgDocIds.length):(this.orgDocIds=this.orgDocIds.filter(t=>{var n;return t!==(null===(n=e.node)||void 0===n?void 0:n.key)}),this.orgDocCheckedLength=this.orgDocIds.length)}nzEventOrgUser(e){e.checkedKeys&&e.checkedKeys.length>0?(this.orgUserIds=this.orgUserIds.concat(e.checkedKeys.map(e=>e.origin.id)).filter((e,t,n)=>n.indexOf(e)===t),this.orgUserCheckedLength=this.orgUserIds.length):(this.orgUserIds=this.orgUserIds.filter(t=>{var n;return t!==(null===(n=e.node)||void 0===n?void 0:n.key)}),this.orgUserCheckedLength=this.orgUserIds.length)}save(){const e={listDocumentTypeId:this.docTypeIds.filter((e,t,n)=>n.indexOf(e)===t),listDocumentOfOrganizationId:this.orgDocIds.filter((e,t,n)=>n.indexOf(e)===t),listUserInfoOfOrganizationId:this.orgUserIds.filter((e,t,n)=>n.indexOf(e)===t),id:this.roleId};this.roleApiService.savePermission(e).subscribe(e=>{200===e.code&&null!=e.data?(this.messageService.success(""+e.message),this.isVisibleModalPermission=!1):this.messageService.error(""+e.message)},e=>{console.log(e)})}nzEventOrgDocSearch(e){e.matchedKeys.length<1&&this.docTypeConvertToTree()}nzEventOrgUserSearch(e){e.matchedKeys.length<1&&this.docTypeConvertToTree()}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(p.e),b.Ob(m.a),b.Ob(g.c),b.Ob(o.a))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-role-data-permission"]],inputs:{isVisibleModalPermission:"isVisibleModalPermission"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","1000px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[2,"padding","10px",3,"nzSm","nzXs"],[2,"height","70vh","overflow-y","scroll"],["nzCheckable","","nzMultiple","",3,"nzData","nzExpandAll","nzCheckBoxChange","nzClick"],[2,"color","#1890ff","font-weight","100","font-size","13px"],[3,"nzSuffix"],["type","text","nz-input","","placeholder","T\xecm ki\u1ebfm \u0111\u01a1n v\u1ecb","on","",3,"ngModel","ngModelChange"],["suffixIcon",""],["nzCheckable","","nzMultiple","",3,"nzData","nzExpandAll","nzCheckStrictly","nzSearchValue","nzCheckBoxChange","nzClick","nzSearchValueChange"],["type","text","nz-input","","placeholder","T\xecm ki\u1ebfm \u0111\u01a1n v\u1ecb",3,"ngModel","ngModelChange"],["nz-icon","","nzType","search"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,t){if(1&e&&(b.Ub(0,"nz-modal",0),b.bc("nzVisibleChange",(function(e){return t.isVisibleModalPermission=e}))("nzOnCancel",(function(){return t.handleCancel()})),b.Lc(1,Ie,1,1,"ng-template",null,1,b.Mc),b.Lc(3,Le,44,35,"ng-template",null,2,b.Mc),b.Lc(5,De,2,2,"ng-template",null,3,b.Mc),b.Tb()),2&e){const e=b.xc(2),n=b.xc(4),i=b.xc(6);b.nc("nzVisible",t.isVisibleModalPermission)("nzTitle",e)("nzContent",n)("nzFooter",i)}},directives:[z.a,A.c,A.a,C.a,S.a,I.c,I.d,I.b,d.d,d.o,d.r,U.a,r.o,M.a,E.a],pipes:[x.c],styles:[""]}),e})();function Ee(e,t){if(1&e&&b.Nc(0),2&e){const e=b.fc();b.Pc(" ",e.tittle," ")}}function xe(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Oc(b.hc(2,1,"function.role.modal-item.code.message.maxlength")))}function Ne(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Oc(b.hc(2,1,"function.role.modal-item.code.message.minlength")))}function Ve(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Oc(b.hc(2,1,"function.role.modal-item.code.message.required")))}function we(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Oc(b.hc(2,1,"function.role.modal-item.code.message.pattern")))}function Pe(e,t){if(1&e&&(b.Lc(0,xe,3,3,"ng-container",21),b.Lc(1,Ne,3,3,"ng-container",21),b.Lc(2,Ve,3,3,"ng-container",21),b.Lc(3,we,3,3,"ng-container",21)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("maxlength")),b.Ab(1),b.nc("ngIf",e.hasError("minlength")),b.Ab(1),b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function Fe(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Oc(b.hc(2,1,"function.role.modal-item.name.message.maxlength")))}function Be(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Oc(b.hc(2,1,"function.role.modal-item.name.message.minlength")))}function Ge(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Oc(b.hc(2,1,"function.role.modal-item.name.message.required")))}function qe(e,t){1&e&&(b.Sb(0),b.Nc(1),b.gc(2,"translate"),b.Rb()),2&e&&(b.Ab(1),b.Oc(b.hc(2,1,"function.role.modal-item.name.message.pattern")))}function Xe(e,t){if(1&e&&(b.Lc(0,Fe,3,3,"ng-container",21),b.Lc(1,Be,3,3,"ng-container",21),b.Lc(2,Ge,3,3,"ng-container",21),b.Lc(3,qe,3,3,"ng-container",21)),2&e){const e=t.$implicit;b.nc("ngIf",e.hasError("maxlength")),b.Ab(1),b.nc("ngIf",e.hasError("minlength")),b.Ab(1),b.nc("ngIf",e.hasError("required")),b.Ab(1),b.nc("ngIf",e.hasError("pattern"))}}function $e(e,t){if(1&e){const e=b.Vb();b.Ub(0,"form",4),b.bc("ngSubmit",(function(){return b.Ac(e),b.fc().save()})),b.Ub(1,"nz-form-item"),b.Ub(2,"nz-form-label",5),b.Nc(3),b.gc(4,"translate"),b.Tb(),b.Ub(5,"nz-form-control",6),b.Pb(6,"input",7),b.gc(7,"translate"),b.Lc(8,Pe,4,4,"ng-template",null,8,b.Mc),b.Tb(),b.Tb(),b.Ub(10,"nz-form-item"),b.Ub(11,"nz-form-label",9),b.Nc(12),b.gc(13,"translate"),b.Tb(),b.Ub(14,"nz-form-control",6),b.Pb(15,"input",10),b.gc(16,"translate"),b.Lc(17,Xe,4,4,"ng-template",null,11,b.Mc),b.Tb(),b.Tb(),b.Ub(19,"nz-form-item",12),b.Ub(20,"nz-form-label",13),b.Nc(21),b.gc(22,"translate"),b.Tb(),b.Ub(23,"nz-form-control",14),b.Pb(24,"nz-switch",15),b.Ub(25,"label"),b.Ub(26,"nz-tag",16),b.Nc(27),b.gc(28,"translate"),b.Tb(),b.Ub(29,"nz-tag",16),b.Nc(30),b.gc(31,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(32,"nz-form-item",17),b.Ub(33,"nz-form-label",18),b.Nc(34),b.gc(35,"translate"),b.Tb(),b.Ub(36,"nz-form-control",19),b.Pb(37,"textarea",20),b.gc(38,"translate"),b.Tb(),b.Tb(),b.Tb()}if(2&e){const e=b.xc(9),t=b.xc(18),n=b.fc();b.nc("formGroup",n.form),b.Ab(2),b.nc("nzSm",7)("nzXs",24),b.Ab(1),b.Oc(b.hc(4,31,"function.role.modal-item.code.label")),b.Ab(2),b.nc("nzSm",16)("nzXs",24)("nzErrorTip",e),b.Ab(1),b.oc("placeholder",b.hc(7,33,"function.role.modal-item.code.placeholder")),b.Ab(5),b.nc("nzSm",7)("nzXs",24),b.Ab(1),b.Oc(b.hc(13,35,"function.role.modal-item.name.label")),b.Ab(2),b.nc("nzSm",16)("nzXs",24)("nzErrorTip",t),b.Ab(1),b.oc("placeholder",b.hc(16,37,"function.role.modal-item.name.placeholder")),b.Ab(5),b.nc("nzSm",7)("nzXs",24),b.Ab(1),b.Oc(b.hc(22,39,"function.role.modal-item.status.label")),b.Ab(2),b.nc("nzSpan",16),b.Ab(3),b.nc("nzColor","#00BB00")("hidden",!n.form.value.status),b.Ab(1),b.Oc(b.hc(28,41,"function.role.modal-item.status-true.label")),b.Ab(2),b.nc("nzColor","#EF5350")("hidden",n.form.value.status),b.Ab(1),b.Oc(b.hc(31,43,"function.role.modal-item.status-false.label")),b.Ab(3),b.nc("nzSm",7)("nzXs",24),b.Ab(1),b.Pc(" ",b.hc(35,45,"function.role.modal-item.description.label")," "),b.Ab(2),b.nc("nzSm",16)("nzXs",24),b.Ab(1),b.oc("placeholder",b.hc(38,47,"function.role.modal-item.description.placeholder"))}}function Ke(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",25),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnEdit.click(t)})),b.Pb(1,"i",26),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc("",e.btnEdit.titlei18n," ")}}function He(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",27),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnSave.click(t)})),b.Pb(1,"i",28),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.nc("nzLoading",e.isLoading)("disabled",e.form.invalid),b.Ab(2),b.Pc(" ",e.btnSave.titlei18n," ")}}function je(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",29),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnCancel.click(t)})),b.Pb(1,"i",30),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc(" ",e.btnCancel.titlei18n," ")}}function _e(e,t){if(1&e&&(b.Lc(0,Ke,3,1,"button",22),b.Lc(1,He,3,3,"button",23),b.Lc(2,je,3,1,"button",24)),2&e){const e=b.fc();b.nc("ngIf",e.isInfo&&e.btnEdit.visible&&e.btnEdit.grandAccess),b.Ab(1),b.nc("ngIf",!e.isInfo&&e.btnSave.visible&&e.btnSave.grandAccess),b.Ab(1),b.nc("ngIf",e.btnCancel.visible&&e.btnCancel.grandAccess)}}let We=(()=>{class e{constructor(e,t,n,i,s){this.fb=e,this.messageService=t,this.roleApiService=n,this.aclService=i,this.i18n=s,this.isVisible=!1,this.eventEmmit=new b.n,this.type="add",this.tittle="",this.isReloadGrid=!1,this.isLoading=!1,this.regexCode=a.t,this.regexName=a.v,this.isInfo=!1,this.isEdit=!1,this.isAdd=!1,this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.handleCancel()}},this.btnEdit={title:"C\u1eadp nh\u1eadt",titlei18n:""+this.i18n.fanyi("layout.button.btn-edit.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.updateFormToEdit()}},this.form=this.fb.group({code:[{value:null},[d.w.required,d.w.pattern(a.t)]],name:[null,[d.w.required,d.w.pattern(a.v)]],order:[null],status:[{value:!0}],description:[null]})}ngOnInit(){this.initRightOfUser()}initRightOfUser(){this.btnEdit.grandAccess=this.aclService.canAbility("ROLE-EDIT"),this.btnSave.grandAccess=this.aclService.canAbility("ROLE-ADD")||this.aclService.canAbility("ROLE-EDIT")}handleCancel(){this.isVisible=!1,this.eventEmmit.emit(this.isReloadGrid?{type:"success"}:{type:"close"})}initData(e,t=null,n={}){var i,s,c,r,o,a,l,d,b,h,u,m,f,g,p,z;this.isLoading=!1,this.isReloadGrid=!1,this.item=e,this.type=t,this.option=n,this.updateFormType(t),this.isAdd&&(null===(i=this.form.get("code"))||void 0===i||i.enable(),null===(s=this.form.get("name"))||void 0===s||s.enable(),null===(c=this.form.get("status"))||void 0===c||c.enable(),null===(r=this.form.get("description"))||void 0===r||r.enable(),this.resetForm(),this.tittle=""+this.i18n.fanyi("function.role.modal-item.header-add")),this.isEdit&&(null===(o=this.form.get("code"))||void 0===o||o.disable(),null===(a=this.form.get("name"))||void 0===a||a.enable(),null===(l=this.form.get("status"))||void 0===l||l.enable(),null===(d=this.form.get("description"))||void 0===d||d.enable(),null===(b=this.form.get("status"))||void 0===b||b.setValue(null==e?void 0:e.status),this.tittle=`${this.i18n.fanyi("function.role.modal-item.header-edit")}: ${e.code}`),this.isInfo&&(null===(h=this.form.get("code"))||void 0===h||h.disable(),null===(u=this.form.get("name"))||void 0===u||u.disable(),null===(m=this.form.get("description"))||void 0===m||m.disable(),null===(f=this.form.get("status"))||void 0===f||f.setValue(null==e?void 0:e.status),this.tittle=`${this.i18n.fanyi("function.role.modal-item.header-info")}: ${e.code}`),null===(g=this.form.get("code"))||void 0===g||g.setValue(null==e?void 0:e.code),null===(p=this.form.get("name"))||void 0===p||p.setValue(null==e?void 0:e.name),null===(z=this.form.get("description"))||void 0===z||z.setValue(null==e?void 0:e.description)}updateFormType(e){switch(e){case"add":this.isInfo=!1,this.isEdit=!1,this.isAdd=!0;break;case"info":this.isInfo=!0,this.isEdit=!1,this.isAdd=!1;break;case"edit":this.isInfo=!1,this.isEdit=!0,this.isAdd=!1;break;default:this.isInfo=!1,this.isEdit=!1,this.isAdd=!0}}resetForm(){var e,t,n,i;this.form.reset(),null===(e=this.form.get("status"))||void 0===e||e.setValue(!0),null===(t=this.form.get("order"))||void 0===t||t.setValue(0),null===(n=this.form.get("code"))||void 0===n||n.setValue(""),null===(i=this.form.get("name"))||void 0===i||i.setValue("")}save(e=!1){this.isLoading=!0,Object(a.B)(this.form);for(const n in this.form.controls)this.form.controls[n].markAsDirty(),this.form.controls[n].updateValueAndValidity();if(!this.form.valid)return this.isLoading=!1,void this.messageService.error(""+this.i18n.fanyi("function.role.modal-item.error.message.form-invalid"));const t={id:this.item.id,name:this.form.controls.name.value,code:this.form.controls.code.value.toUpperCase(),status:this.form.controls.status.value,description:this.form.controls.description.value};return null==t.name||""===t.name?(this.isLoading=!1,void this.messageService.error(""+this.i18n.fanyi("function.role.modal-item.error.message.name"))):this.isAdd?this.roleApiService.create(t).subscribe(t=>{this.isLoading=!1,200===t.code&&null!=t.data?(this.messageService.success(""+t.message),this.isReloadGrid=!0,e?this.resetForm():this.closeModalReloadData()):this.messageService.error(""+t.message)},e=>{this.isLoading=!1,this.messageService.error(e.error?""+e.error.message:""+e.status)}):this.isEdit?this.roleApiService.update(t).subscribe(e=>{this.isLoading=!1,200===e.code&&null!=e.data?(this.messageService.success(""+e.message),this.closeModalReloadData()):this.messageService.error(""+e.message)},e=>{this.isLoading=!1,this.messageService.error(e.error?""+e.error.message:""+e.status)}):void 0}updateFormToEdit(){var e,t,n,i;this.updateFormType("edit"),null===(e=this.form.get("name"))||void 0===e||e.enable(),null===(t=this.form.get("order"))||void 0===t||t.enable(),null===(n=this.form.get("status"))||void 0===n||n.enable(),null===(i=this.form.get("description"))||void 0===i||i.enable()}closeModalReloadData(){this.resetForm(),this.isVisible=!1,this.eventEmmit.emit({type:"success"})}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(d.e),b.Ob(p.e),b.Ob(m.a),b.Ob(h.a),b.Ob(o.a))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-role-item"]],inputs:{isVisible:"isVisible",type:"type",item:"item",option:"option"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","700px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","code",3,"nzSm","nzXs"],["nzHasFeedback","",3,"nzSm","nzXs","nzErrorTip"],["nz-input","","minlength","1","maxlength","70","required","","formControlName","code","id","code",2,"text-transform","uppercase",3,"placeholder"],["validateCode",""],["nzRequired","","nzFor","name",3,"nzSm","nzXs"],["nz-input","","minlength","1","maxlength","256","required","","formControlName","name","id","name",3,"placeholder"],["validateName",""],["nz-row",""],["nzFor","status",3,"nzSm","nzXs"],[3,"nzSpan"],["formControlName","status","nzSize","small",2,"margin-right","5px"],[3,"nzColor","hidden"],[2,"margin-bottom","0"],["nzFor","description",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["rows","3","nz-input","","id","description","formControlName","description",3,"placeholder"],[4,"ngIf"],["nz-button","","nzType","primary","class","btn-secondary",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-secondary",3,"click"],["nz-icon","","nzType","edit","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","disabled","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,t){if(1&e&&(b.Ub(0,"nz-modal",0),b.bc("nzVisibleChange",(function(e){return t.isVisible=e}))("nzOnCancel",(function(){return t.handleCancel()})),b.Lc(1,Ee,1,1,"ng-template",null,1,b.Mc),b.Lc(3,$e,39,49,"ng-template",null,2,b.Mc),b.Lc(5,_e,3,3,"ng-template",null,3,b.Mc),b.Tb()),2&e){const e=b.xc(2),n=b.xc(4),i=b.xc(6);b.nc("nzVisible",t.isVisible)("nzTitle",e)("nzContent",n)("nzFooter",i)}},directives:[z.a,d.x,d.p,k.b,d.h,A.c,k.c,A.a,k.d,k.a,I.b,d.d,d.k,d.j,d.v,d.o,d.g,R.a,D.a,r.o,M.a,E.a,S.a,U.a],pipes:[x.c],styles:[""]}),e})();function Je(e,t){if(1&e&&b.Nc(0),2&e){const e=b.fc();b.Pc(" ",e.tittle," ")}}function Qe(e,t){1&e&&b.Pb(0,"i",10)}function Ye(e,t){if(1&e){const e=b.Vb();b.Ub(0,"nz-row"),b.Ub(1,"nz-col",4),b.Ub(2,"fieldset",5),b.Ub(3,"legend"),b.Nc(4),b.gc(5,"translate"),b.Tb(),b.Ub(6,"nz-input-group",6),b.Ub(7,"input",7),b.bc("ngModelChange",(function(t){return b.Ac(e),b.fc().searchMenuValue=t})),b.gc(8,"translate"),b.Tb(),b.Tb(),b.Lc(9,Qe,1,0,"ng-template",null,8,b.Mc),b.Ub(11,"nz-tree",9),b.bc("nzCheckBoxChange",(function(t){return b.Ac(e),b.fc().nzEventMenuChange(t)})),b.Tb(),b.Tb(),b.Tb(),b.Tb()}if(2&e){const e=b.xc(10),t=b.fc();b.Ab(1),b.nc("nzSm",24)("nzXs",24),b.Ab(3),b.Oc(b.hc(5,10,"function.role.modal-menu.header")),b.Ab(2),b.nc("nzSuffix",e),b.Ab(1),b.oc("placeholder",b.hc(8,12,"function.role.modal-menu.search.label")),b.nc("ngModel",t.searchMenuValue),b.Ab(4),b.nc("nzData",t.treeMenuData)("nzSearchValue",t.searchMenuValue)("nzExpandAll",t.expandAll)("nzCheckStrictly",!0)}}function Ze(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",13),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnSave.click(t)})),b.Pb(1,"i",14),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.nc("nzLoading",e.isLoading),b.Ab(2),b.Pc(" ",e.btnSave.titlei18n," ")}}function et(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",15),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnCancel.click(t)})),b.Pb(1,"i",16),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc(" ",e.btnCancel.titlei18n," ")}}function tt(e,t){if(1&e&&(b.Lc(0,Ze,3,2,"button",11),b.Lc(1,et,3,1,"button",12)),2&e){const e=b.fc();b.nc("ngIf",e.btnSave.visible&&e.btnSave.grandAccess),b.Ab(1),b.nc("ngIf",e.btnCancel.visible&&e.btnCancel.grandAccess)}}let nt=(()=>{class e{constructor(e,t,n,i){this.messageService=e,this.roleApiService=t,this.arrayService=n,this.i18n=i,this.isVisibleModalMenu=!1,this.eventEmmit=new b.n,this.tittle="",this.isLoading=!1,this.listMenu=[],this.treeMenuData=[],this.menuIdSelected=[],this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.handleCancel()}}}ngOnInit(){}handleCancel(){this.isVisibleModalMenu=!1,this.eventEmmit.emit({type:"close"})}initData(e,t){this.listMenu=t,this.isVisibleModalMenu=!0,this.roleId=e.id,this.tittle=`${this.i18n.fanyi("function.role.modal-navigation.header")}: ${e.code}`,this.getMenuByRole()}initMenuTree(){const e=this.listMenu.map((e,t,n)=>{const i=n.some(t=>t.parentId===e.id),s=this.menuIdSelected.some(t=>t===e.id);return{id:e.id,parent_id:e.parentId,title:e.name,isLeaf:!i,expanded:!0,selected:!1,checked:s}});this.treeMenuData=this.arrayService.arrToTreeNode(e,{cb:(e,t,n)=>{e.selected=0===e.id}})}getMenuByRole(){this.roleApiService.getListMenuIdByRole({roleId:this.roleId}).subscribe(e=>{e.data&&(this.menuIdSelected=e.data.navigationIds),this.initMenuTree()},e=>{this.initMenuTree(),console.log(e)})}save(){const e={roleId:this.roleId,navigationIds:this.menuIdSelected.filter((e,t,n)=>n.indexOf(e)===t)};this.roleApiService.updateMenuByRole(e).subscribe(e=>{200===e.code&&null!=e.data?(this.messageService.success(""+e.message),this.isVisibleModalMenu=!1):this.messageService.error(""+e.message)},e=>{this.messageService.error(e.error?""+e.error.message:""+e.status)})}nzEventMenuChange(e){this.menuIdSelected=e.checkedKeys&&e.checkedKeys.length>0?this.menuIdSelected.concat(e.checkedKeys.map(e=>e.origin.id)).filter((e,t,n)=>n.indexOf(e)===t):this.menuIdSelected.filter(t=>{var n;return t!==(null===(n=e.node)||void 0===n?void 0:n.key)})}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(p.e),b.Ob(m.a),b.Ob(g.c),b.Ob(o.a))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-role-menu"]],inputs:{isVisibleModalMenu:"isVisibleModalMenu"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","600px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[2,"padding","10px",3,"nzSm","nzXs"],[2,"height","60vh","overflow-y","scroll"],[3,"nzSuffix"],["type","text","nz-input","",3,"placeholder","ngModel","ngModelChange"],["suffixIcon",""],["nzCheckable","","nzMultiple","",2,"margin-top","10px",3,"nzData","nzSearchValue","nzExpandAll","nzCheckStrictly","nzCheckBoxChange"],["nz-icon","","nzType","search"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,t){if(1&e&&(b.Ub(0,"nz-modal",0),b.bc("nzVisibleChange",(function(e){return t.isVisibleModalMenu=e}))("nzOnCancel",(function(){return t.handleCancel()})),b.Lc(1,Je,1,1,"ng-template",null,1,b.Mc),b.Lc(3,Ye,12,14,"ng-template",null,2,b.Mc),b.Lc(5,tt,2,2,"ng-template",null,3,b.Mc),b.Tb()),2&e){const e=b.xc(2),n=b.xc(4),i=b.xc(6);b.nc("nzVisible",t.isVisibleModalMenu)("nzTitle",e)("nzContent",n)("nzFooter",i)}},directives:[z.a,A.c,A.a,S.a,I.c,I.d,I.b,d.d,d.o,d.r,C.a,U.a,r.o,M.a,E.a],pipes:[x.c],styles:[""]}),e})();function it(e,t){if(1&e&&b.Nc(0),2&e){const e=b.fc();b.Pc(" ",e.tittle," ")}}function st(e,t){1&e&&b.Pb(0,"i",10)}function ct(e,t){if(1&e){const e=b.Vb();b.Ub(0,"nz-row"),b.Ub(1,"nz-col",4),b.Ub(2,"fieldset",5),b.Ub(3,"legend"),b.Nc(4),b.gc(5,"translate"),b.Tb(),b.Ub(6,"nz-input-group",6),b.Ub(7,"input",7),b.bc("ngModelChange",(function(t){return b.Ac(e),b.fc().searchRightValue=t})),b.gc(8,"translate"),b.Tb(),b.Tb(),b.Lc(9,st,1,0,"ng-template",null,8,b.Mc),b.Ub(11,"nz-tree",9),b.bc("nzCheckBoxChange",(function(t){return b.Ac(e),b.fc().nzEventRightChange(t)})),b.Tb(),b.Tb(),b.Tb(),b.Tb()}if(2&e){const e=b.xc(10),t=b.fc();b.Ab(1),b.nc("nzSm",24)("nzXs",24),b.Ab(3),b.Oc(b.hc(5,9,"function.role.modal-right.header")),b.Ab(2),b.nc("nzSuffix",e),b.Ab(1),b.oc("placeholder",b.hc(8,11,"function.role.modal-right.search.label")),b.nc("ngModel",t.searchRightValue),b.Ab(4),b.nc("nzData",t.treeRightData)("nzSearchValue",t.searchRightValue)("nzExpandAll",t.expandAll)}}function rt(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",13),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnSave.click(t)})),b.Pb(1,"i",14),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.nc("nzLoading",e.isLoading),b.Ab(2),b.Pc(" ",e.btnSave.titlei18n," ")}}function ot(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",15),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnCancel.click(t)})),b.Pb(1,"i",16),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc(" ",e.btnCancel.titlei18n," ")}}function at(e,t){if(1&e&&(b.Lc(0,rt,3,2,"button",11),b.Lc(1,ot,3,1,"button",12)),2&e){const e=b.fc();b.nc("ngIf",e.btnSave.visible&&e.btnSave.grandAccess),b.Ab(1),b.nc("ngIf",e.btnCancel.visible&&e.btnCancel.grandAccess)}}let lt=(()=>{class e{constructor(e,t,n,i,s){this.messageService=e,this.roleApiService=t,this.arrayService=n,this.com=i,this.i18n=s,this.isVisibleModalRight=!1,this.eventEmmit=new b.n,this.tittle="",this.isLoading=!1,this.listRight=[],this.treeRightData=[],this.rightIdSelected=[],this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.handleCancel()}}}ngOnInit(){}handleCancel(){this.isVisibleModalRight=!1,this.eventEmmit.emit({type:"close"})}initData(e,t){this.listRight=t,this.isVisibleModalRight=!0,this.roleId=e.id,this.tittle=`${this.i18n.fanyi("function.role.modal-right.header")}: ${e.code}`,this.getRightByRole()}initRightTree(){const e=this.listRight.map(e=>e.groupName).filter((e,t,n)=>n.indexOf(e)===t),t=[];for(const i of e)t.push({groupName:null,name:i,code:i,id:i});const n=this.listRight.concat(t).map((e,t,n)=>{const i=n.some(t=>t.groupName===e.id),s=this.rightIdSelected.some(t=>t===e.id);return{id:e.id,parent_id:e.groupName,title:e.name,isLeaf:!i,expanded:!0,selected:!1,checked:s,disabled:i,disableCheckbox:i}});this.treeRightData=this.arrayService.arrToTreeNode(n,{cb:(e,t,n)=>{e.selected=0===e.id}})}getRightByRole(){this.roleApiService.getListRightIdByRole({roleId:this.roleId}).subscribe(e=>{e.data&&(this.rightIdSelected=e.data.rightIds),this.initRightTree()},e=>{this.initRightTree(),console.log(e)})}save(){const e={roleId:this.roleId,rightIds:this.rightIdSelected.filter((e,t,n)=>n.indexOf(e)===t)};this.roleApiService.updateRightByRole(e).subscribe(e=>{200===e.code&&null!=e.data?(this.messageService.success(""+e.message),this.isVisibleModalRight=!1):this.messageService.error(""+e.message)},e=>{this.messageService.error(e.error?""+e.error.message:""+e.status)}),this.com.changeMessage("RightChanged")}nzEventRightChange(e){this.rightIdSelected=e.checkedKeys&&e.checkedKeys.length>0?this.rightIdSelected.concat(e.checkedKeys.map(e=>e.origin.id)).filter((e,t,n)=>n.indexOf(e)===t):this.rightIdSelected.filter(t=>{var n;return t!==(null===(n=e.node)||void 0===n?void 0:n.key)})}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(p.e),b.Ob(m.a),b.Ob(g.c),b.Ob(f.c),b.Ob(o.a))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-role-right"]],inputs:{isVisibleModalRight:"isVisibleModalRight"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","600px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[2,"padding","10px",3,"nzSm","nzXs"],[2,"height","60vh","overflow-y","scroll"],[3,"nzSuffix"],["type","text","nz-input","",3,"placeholder","ngModel","ngModelChange"],["suffixIcon",""],["nzCheckable","","nzMultiple","",2,"margin-top","10px",3,"nzData","nzSearchValue","nzExpandAll","nzCheckBoxChange"],["nz-icon","","nzType","search"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,t){if(1&e&&(b.Ub(0,"nz-modal",0),b.bc("nzVisibleChange",(function(e){return t.isVisibleModalRight=e}))("nzOnCancel",(function(){return t.handleCancel()})),b.Lc(1,it,1,1,"ng-template",null,1,b.Mc),b.Lc(3,ct,12,13,"ng-template",null,2,b.Mc),b.Lc(5,at,2,2,"ng-template",null,3,b.Mc),b.Tb()),2&e){const e=b.xc(2),n=b.xc(4),i=b.xc(6);b.nc("nzVisible",t.isVisibleModalRight)("nzTitle",e)("nzContent",n)("nzFooter",i)}},directives:[z.a,A.c,A.a,S.a,I.c,I.d,I.b,d.d,d.o,d.r,C.a,U.a,r.o,M.a,E.a],pipes:[x.c],styles:[""]}),e})();var dt=n("GuFl"),bt=n("rMZv");function ht(e,t){if(1&e&&b.Nc(0),2&e){const e=b.fc();b.Pc(" ",e.tittle," ")}}function ut(e,t){if(1&e){const e=b.Vb();b.Ub(0,"tr",12),b.bc("click",(function(){b.Ac(e);const n=t.$implicit;return(0,b.fc().onItemSelect)(n)})),b.Ub(1,"td",13),b.bc("nzCheckedChange",(function(){b.Ac(e);const n=t.$implicit;return(0,b.fc().onItemSelect)(n)})),b.Tb(),b.Ub(2,"td"),b.Nc(3),b.Tb(),b.Ub(4,"td"),b.Nc(5),b.Tb(),b.Tb()}if(2&e){const e=t.$implicit;b.Ab(1),b.nc("nzChecked",!!e.checked),b.Ab(2),b.Oc(e.name),b.Ab(2),b.Oc(e.code)}}function mt(e,t){if(1&e){const e=b.Vb();b.Ub(0,"nz-table",8,9),b.Ub(2,"thead"),b.Ub(3,"tr"),b.Ub(4,"th",10),b.bc("nzCheckedChange",(function(n){return b.Ac(e),(0,t.onItemSelectAll)(n)})),b.Tb(),b.Ub(5,"th"),b.Nc(6),b.gc(7,"translate"),b.Tb(),b.Ub(8,"th"),b.Nc(9),b.gc(10,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Ub(11,"tbody"),b.Lc(12,ut,6,3,"tr",11),b.Tb(),b.Tb()}if(2&e){const e=t.$implicit,n=t.stat,i=b.xc(1),s=b.fc(2);b.nc("nzData",s.$asTransferItems(e)),b.Ab(4),b.nc("nzChecked",n.checkAll)("nzIndeterminate",n.checkHalf),b.Ab(2),b.Oc(b.hc(7,6,"function.role.modal-user-role.table.header.name")),b.Ab(3),b.Oc(b.hc(10,8,"function.role.modal-user-role.table.header.code")),b.Ab(3),b.nc("ngForOf",i.data)}}const ft=function(e,t){return[e,t]};function gt(e,t){if(1&e){const e=b.Vb();b.Ub(0,"nz-form-item"),b.Ub(1,"nz-form-label",4),b.Nc(2),b.gc(3,"translate"),b.Tb(),b.Ub(4,"nz-form-control",4),b.Ub(5,"nz-tree-select",5),b.bc("ngModelChange",(function(t){return b.Ac(e),b.fc().orgSelected=t}))("ngModelChange",(function(t){return b.Ac(e),b.fc().onChangeOrg(t)})),b.gc(6,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Ub(7,"nz-transfer",6),b.bc("nzSelectChange",(function(t){return b.Ac(e),b.fc().selectUser(t)}))("nzChange",(function(t){return b.Ac(e),b.fc().changeUser(t)}))("nzSearchChange",(function(t){return b.Ac(e),b.fc().searchUser(t)})),b.Lc(8,mt,13,10,"ng-template",null,7,b.Mc),b.Tb()}if(2&e){const e=b.xc(9),t=b.fc();b.Ab(1),b.nc("nzSm",4)("nzXs",24),b.Ab(1),b.Pc(" ",b.hc(3,13,"function.role.modal-user-role.organization.label"),""),b.Ab(2),b.nc("nzSm",8)("nzXs",24),b.Ab(1),b.oc("nzPlaceHolder",b.hc(6,15,"function.role.modal-user-role.organization.placeholder")),b.nc("nzNodes",t.listOrgTree)("ngModel",t.orgSelected),b.Ab(2),b.nc("nzDataSource",t.listUserTransfer)("nzShowSearch",!0)("nzShowSelectAll",!1)("nzRenderList",b.tc(17,ft,e,e))("nzFilterOption",t.filterUserOption)}}function pt(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",16),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnSave.click(t)})),b.Pb(1,"i",17),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.nc("nzLoading",e.isLoading),b.Ab(2),b.Pc(" ",e.btnSave.titlei18n," ")}}function zt(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",18),b.bc("click",(function(t){return b.Ac(e),b.fc(2).btnCancel.click(t)})),b.Pb(1,"i",19),b.Nc(2),b.Tb()}if(2&e){const e=b.fc(2);b.Ab(2),b.Pc(" ",e.btnCancel.titlei18n," ")}}function Tt(e,t){if(1&e&&(b.Lc(0,pt,3,2,"button",14),b.Lc(1,zt,3,1,"button",15)),2&e){const e=b.fc();b.nc("ngIf",e.btnSave.visible&&e.btnSave.grandAccess),b.Ab(1),b.nc("ngIf",e.btnCancel.visible&&e.btnCancel.grandAccess)}}let vt=(()=>{class e{constructor(e,t,n,i,s,c){this.fb=e,this.messageService=t,this.roleApiService=n,this.arrayService=i,this.userService=s,this.i18n=c,this.isVisibleRoleUser=!1,this.eventEmmit=new b.n,this.type="add",this.tittle="",this.isReloadGrid=!1,this.isLoading=!1,this.regexCode=a.t,this.regexName=a.v,this.isInfo=!1,this.isEdit=!1,this.isAdd=!1,this.listUser=[],this.listOrg=[],this.listOrgTree=[],this.listUserTransfer=[],this.listUserTemp=[],this.listUserTransferTemp=[],this.listUserSelected=[],this.$asTransferItems=e=>e,this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.handleCancel()}}}ngOnInit(){}handleCancel(){this.isVisibleRoleUser=!1,this.eventEmmit.emit(this.isReloadGrid?{type:"success"}:{type:"close"})}initData(e,t,n){this.listUserSelected=[],this.listUser=t,this.listUserTemp=t,this.listOrg=n,this.isVisibleRoleUser=!0,this.item=e,this.tittle=`${this.i18n.fanyi("function.role.modal-user-role.header")}: ${e.code}`,this.initTreeData(),this.getListUserIdByRoleId()}initTreeData(){const e=this.listOrg.map((e,t,n)=>{const i=n.some(t=>t.parentId===e.id);return{id:e.id,parent_id:e.parentId,title:e.name,isLeaf:!i,expanded:!1,selected:!1}});this.listOrgTree=this.arrayService.arrToTreeNode(e,{cb:(e,t,n)=>{e.selected=0===e.id}})}initTransferData(){this.listUserTransfer=[];for(let e=0;e<this.listUser.length;e++){let t=this.listUser[e];this.listUserTransfer.push({key:e.toString(),id:t.id,title:t.name,name:t.name,code:t.code,organizationId:t.organizationId,checked:!1,direction:this.listUserSelected.some(e=>e===t.id)?"right":"left"})}this.listUserTransferTemp=this.listUserTransfer}getListUserIdByRoleId(){this.userService.getListUserIdByRole({roleId:this.item.id}).subscribe(e=>{e.data&&e.data.listUserId&&(this.listUserSelected=e.data.listUserId),this.initTransferData()},e=>{this.initTransferData()})}save(){this.userService.saveListUserRole({roleId:this.item.id,userIds:this.listUserSelected}).subscribe(e=>{200===e.code&&null!=e.data?(this.isVisibleRoleUser=!1,this.messageService.success(""+e.message)):this.messageService.error(""+e.message)},e=>{this.messageService.error(e.error?""+e.error.message:""+e.status)})}onChangeOrg(e){this.orgSelected=e,this.orgSelected?(this.listUser=this.listUserTemp.filter(e=>e.organizationId===this.orgSelected),this.listUserTransfer=this.listUserTransferTemp.filter(e=>e.organizationId===this.orgSelected)):(this.listUser=this.listUserTemp,this.listUserTransfer=this.listUserTransferTemp)}selectUser(e){}changeUser(e){"left"===e.to?this.listUserSelected=this.listUserSelected.filter(t=>!e.list.map(e=>e.id).includes(t)):"right"===e.to&&(this.listUserSelected=this.listUserSelected.concat(e.list.map(e=>e.id)));const t=e.list.map(e=>e.key);this.listUserTransfer=this.listUserTransfer.map(n=>(t.includes(n.key)&&(e=>e.hasOwnProperty("key"))(n)&&("left"===e.to?delete n.hide:"right"===e.to&&(n.hide=!1)),n))}searchUser(e){}filterUserOption(e,t){return t.name.indexOf(e)>-1||t.code.indexOf(e)>-1}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(d.e),b.Ob(p.e),b.Ob(m.a),b.Ob(g.c),b.Ob(f.u),b.Ob(o.a))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-role-user"]],inputs:{isVisibleRoleUser:"isVisibleRoleUser",type:"type",item:"item",option:"option"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","1200px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[3,"nzSm","nzXs"],["nzShowSearch","","nzShowLine","",3,"nzNodes","nzPlaceHolder","ngModel","ngModelChange"],[3,"nzDataSource","nzShowSearch","nzShowSelectAll","nzRenderList","nzFilterOption","nzSelectChange","nzChange","nzSearchChange"],["renderList",""],["nzSize","small",3,"nzData"],["t",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"nzChecked","nzCheckedChange"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,t){if(1&e&&(b.Ub(0,"nz-modal",0),b.bc("nzVisibleChange",(function(e){return t.isVisibleRoleUser=e}))("nzOnCancel",(function(){return t.handleCancel()})),b.Lc(1,ht,1,1,"ng-template",null,1,b.Mc),b.Lc(3,gt,10,20,"ng-template",null,2,b.Mc),b.Lc(5,Tt,2,2,"ng-template",null,3,b.Mc),b.Tb()),2&e){const e=b.xc(2),n=b.xc(4),i=b.xc(6);b.nc("nzVisible",t.isVisibleRoleUser)("nzTitle",e)("nzContent",n)("nzFooter",i)}},directives:[z.a,A.c,k.c,A.a,k.d,k.a,L.a,d.o,d.r,dt.a,bt.c,bt.l,bt.m,bt.b,bt.j,bt.k,bt.g,r.n,bt.h,r.o,M.a,E.a,S.a,U.a],pipes:[x.c],styles:[""]}),e})();var At=n("zAKX"),yt=n("cWTo"),St=n("NhFE"),Ut=n("8dLC");function It(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",35),b.bc("click",(function(t){return b.Ac(e),b.fc().btnReload.click(t)})),b.Pb(1,"i",36),b.Nc(2),b.Tb()}if(2&e){const e=b.fc();b.Ab(2),b.Pc("",e.btnReload.titlei18n," ")}}function Ct(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",37),b.bc("click",(function(t){return b.Ac(e),b.fc().btnAdd.click(t)})),b.Pb(1,"i",38),b.Nc(2),b.Tb()}if(2&e){const e=b.fc();b.Ab(2),b.Pc(" ",e.btnAdd.titlei18n," ")}}function kt(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",39),b.bc("click",(function(t){return b.Ac(e),b.fc().btnDelete.click(t)})),b.Pb(1,"i",40),b.Nc(2),b.Tb()}if(2&e){const e=b.fc();b.Ab(2),b.Pc("",e.btnDelete.titlei18n," ")}}function Lt(e,t){1&e&&b.Pb(0,"i",44)}function Ot(e,t){1&e&&b.Pb(0,"i",45)}function Rt(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",41),b.bc("click",(function(){b.Ac(e);const t=b.fc();return t.filter.ShowAdSearch=!t.filter.ShowAdSearch,t.onResetSearch(!0)})),b.gc(1,"translate"),b.Lc(2,Lt,1,0,"i",42),b.Lc(3,Ot,1,0,"i",43),b.Tb()}if(2&e){const e=b.fc();b.oc("title",b.hc(1,3,"layout.button.btn-show-ad-search.label")),b.Ab(2),b.nc("ngIf",!e.filter.ShowAdSearch),b.Ab(1),b.nc("ngIf",e.filter.ShowAdSearch)}}function Dt(e,t){if(1&e&&b.Pb(0,"nz-option",46),2&e){const e=t.$implicit;b.nc("nzLabel",e.name)("nzValue",e.id)}}const Mt=function(){return["/"]},Et=[{path:"",children:[{path:"",redirectTo:"user",pathMatch:"full"},{path:"role",component:(()=>{class e{constructor(e,t,n,s,c,r,o,d,b,h){this.roleApiService=e,this.notification=t,this.documentTypeApiService=n,this.organizationApiService=s,this.messageService=c,this.userService=r,this.rightService=o,this.menuService=d,this.aclService=b,this.i18n=h,this.tittle=""+this.i18n.fanyi("function.country.title"),this.filter=Object.assign({},a.s),this.modules=[l.a],this.columnDefs=[],this.rowSelection="multiple",this.grid={dataCount:0,rowData:[],totalData:0},this.overlayLoadingTemplate=a.p,this.overlayNoRowsTemplate=a.q,this.pageSizeOptions=[],this.paginationMessage="",this.listStatus=a.m,this.modal={type:"",item:{},isShow:!1,option:{}},this.isShowDelete=!1,this.isLoadingDelete=!1,this.listOrg=[],this.listDocType=[],this.listUser=[],this.listRight=[],this.listMenu=[],this.columnDefs=[{field:"index",headerName:""+this.i18n.fanyi("layout.grid.index"),width:150,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,checkboxSelection:!0},{field:"code",headerName:""+this.i18n.fanyi("function.role.grid.code"),minWidth:180,flex:1},{field:"name",headerName:""+this.i18n.fanyi("function.role.grid.name"),sortable:!0,filter:!0,minWidth:180,flex:1},{field:"status",headerName:""+this.i18n.fanyi("function.role.grid.status"),minWidth:150,cellRenderer:"statusNameCellRender"},{headerName:""+this.i18n.fanyi("layout.grid.action"),minWidth:150,cellRenderer:"btnCellRender",cellRendererParams:{infoClicked:e=>this.onViewItem(e),editClicked:e=>this.onEditItem(e),deleteClicked:e=>this.onDeleteItem(e),addRoleClicked:e=>this.onAddRoleItem(e),btnUpdateUserRole:e=>this.btnUpdateUserRole(e),addRightClickedHandler:e=>this.addRightClickedHandler(e),addMenuClickedHandler:e=>this.addMenuClickedHandler(e)}}],this.defaultColDef={minWidth:100,resizable:!0},this.frameworkComponents={btnCellRender:i.a,dateCellRender:i.e,statusNameCellRender:i.q},this.excelStyles=[...a.b],this.btnAdd={title:"Th\xeam m\u1edbi",titlei18n:""+this.i18n.fanyi("layout.button.btn-add.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.onAddItem()}},this.btnDelete={title:"X\xf3a",titlei18n:""+this.i18n.fanyi("layout.button.btn-delete.label"),visible:!1,enable:!0,grandAccess:!0,click:e=>{this.onDeleteItem()}},this.btnSearch={title:"T\xecm ki\u1ebfm",titlei18n:""+this.i18n.fanyi("layout.button.btn-search.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.initGridData()}},this.btnResetSearch={title:"\u0110\u1eb7t l\u1ea1i",titlei18n:""+this.i18n.fanyi("layout.button.btn-reset.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.onResetSearch(!1)}},this.btnReload={title:"T\u1ea3i l\u1ea1i",titlei18n:""+this.i18n.fanyi("layout.button.btn-reload.label"),visible:!0,enable:!0,grandAccess:!0,click:e=>{this.onResetSearch(!1)}}}ngOnInit(){this.initRightOfUser(),this.initDocumentType(),this.initOrganization(),this.getListUserInternal(),this.initListRight(),this.initListMenu()}initRightOfUser(){this.btnAdd.grandAccess=this.aclService.canAbility("ROLE-ADD"),this.btnDelete.grandAccess=this.aclService.canAbility("ROLE-DELETE")}btnUpdateUserRole(e){this.itemRoleUserModal.initData(e,this.listUser,this.listOrg)}initDocumentType(){this.documentTypeApiService.getListComboboxAllStatus().subscribe(e=>{e.data&&(e.data.forEach(e=>{e.parent_id=null}),this.listDocType=e.data)},e=>{console.log("get document type combobox error: ",e)})}initOrganization(){this.organizationApiService.getListComboboxCurrentOrgOfUser().subscribe(e=>{200===e.code&&null!=e.data?this.listOrg=e.data:this.messageService.error(""+e.message)},e=>{})}initGridData(){return this.btnDelete.visible=!1,this.gridApi.showLoadingOverlay(),this.roleApiService.getFilter(this.filter).subscribe(e=>{var t;if(this.gridApi.hideOverlay(),200!==e.code)return void this.notification.error(""+this.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+e.message);if(null==e.data)return void this.notification.error(""+this.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+e.message);const n=e.data;let i=(void 0===this.filter.pageSize?0:this.filter.pageSize)*((void 0===this.filter.pageNumber?0:this.filter.pageNumber)-1);this.paginationMessage=`Hi\u1ec3n th\u1ecb <b>${i+1} - ${i+n.dataCount}</b> tr\xean t\u1ed5ng s\u1ed1 <b>${n.totalCount}</b> k\u1ebft qu\u1ea3`;for(const s of n.data)s.index=++i,s.statusName=null===(t=this.listStatus.find(e=>e.id===s.status))||void 0===t?void 0:t.name,s.infoGrantAccess=!0,s.editGrantAccess=this.aclService.canAbility("ROLE-EDIT"),s.deleteGrantAccess=this.aclService.canAbility("ROLE-DELETE"),s.addRoleGrantAccess=this.aclService.canAbility("ROLE-ADD-DATA"),s.userGroupAddGrantAccess=this.aclService.canAbility("ROLE-ADD-USER"),s.addRightGrantAccess=this.aclService.canAbility("ROLE-ADD-RIGHT"),s.addMenuGrantAccess=this.aclService.canAbility("ROLE-ADD-NAVIGATION");this.grid.totalData=n.totalCount,this.grid.dataCount=n.dataCount,this.grid.rowData=n.data,this.pageSizeOptions=[...a.r],this.pageSizeOptions=this.pageSizeOptions.filter(e=>e<n.totalCount),this.pageSizeOptions.push(n.totalCount)},e=>{this.gridApi.hideOverlay()})}initListMenu(){this.menuService.getListCombobox().subscribe(e=>{200===e.code&&null!=e.data?this.listMenu=e.data:this.messageService.error(""+e.message)},e=>{console.log(e)})}onResetSearch(e){this.filter.pageNumber=1,this.filter.textSearch=void 0,this.filter.status=null,e&&this.initGridData()}onGridReady(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.initGridData()}onSelectionChanged(e){const t=this.gridApi.getSelectedRows();this.btnDelete.visible=t.length>0}onCellDoubleClicked(e){this.onViewItem(e.data)}addRightClickedHandler(e){this.itemRightModal.initData(e,this.listRight)}addMenuClickedHandler(e){this.itemMenuModal.initData(e,this.listMenu)}initListRight(){this.rightService.getListCombobox().subscribe(e=>{200===e.code&&null!=e.data?this.listRight=e.data:this.notification.error(""+this.i18n.fanyi("function.right.message-error.title"),""+e.message)},e=>{})}onEditItem(e=null){return Object(c.b)(this,void 0,void 0,(function*(){const t=yield this.roleApiService.getById(e.id).toPromise();200===t.code&&null!=t.data?(this.modal={type:"edit",item:e,isShow:!0,option:{}},this.itemModal.initData(t.data,"edit")):this.notification.error(""+this.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+t.message)}))}onViewItem(e=null){return Object(c.b)(this,void 0,void 0,(function*(){const t=yield this.roleApiService.getById(e.id).toPromise();200===t.code&&null!=t.data?(this.modal={type:"info",item:e,isShow:!0,option:{}},this.itemModal.initData(t.data,"info")):this.notification.error(""+this.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+t.message)}))}onDeleteItem(e=null){let t=this.gridApi.getSelectedRows();null!==e&&(t=[],t.push(e)),this.i18n.fanyi("delete-modal.grid.header");let n="";n=t.length>1?""+this.i18n.fanyi("layout-modal.delete.message.many"):""+this.i18n.fanyi("layout-modal.delete.message.one"),this.isShowDelete=!0,this.deleteModal.initData(t,n)}onAddRoleItem(e){this.itemPermissionModal.initData(e,this.listDocType,this.listOrg)}onPageNumberChange(){this.initGridData()}onPageSizeChange(){this.initGridData()}onAddItem(){this.modal={type:"add",item:{},isShow:!0,option:{}},this.itemModal.initData({},"add")}onModalEventEmmit(e){this.modal.isShow=!1,"success"===e.type&&this.initGridData()}onDeleteEventEmmit(e){"success"===e.type?this.initGridData():"confirm"===e.type&&(this.deleteModal.updateIsLoading(!0),this.deleteListItem(e.listId))}onModalRoleUserEventEmmit(e){}onModalRightEventEmmit(e){}onModalMenuEventEmmit(e){}getListUserInternal(){this.userService.getListComboboxFilterInternalUser(!0,null).subscribe(e=>{this.listUser=e.data},e=>{})}deleteListItem(e){return this.isLoadingDelete=!0,this.roleApiService.delete(e).subscribe(e=>{this.isLoadingDelete=!1,200===e.code&&null!=e.data?this.deleteModal.updateData(e.data):this.notification.error(""+this.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+e.message)},e=>{this.isLoadingDelete=!1,this.deleteModal.updateData(void 0),this.notification.error(""+this.i18n.fanyi("function.role.modal-item.name.message.error.title"),e.error?""+e.error.message:""+e.status)})}changeStatus(e){this.filter.status=e,this.initGridData()}onModalPermissionEventEmmit(e){this.initGridData()}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(m.a),b.Ob(u.b),b.Ob(f.b),b.Ob(f.o),b.Ob(p.e),b.Ob(f.u),b.Ob(f.r),b.Ob(f.l),b.Ob(h.a),b.Ob(o.a))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-role"]],viewQuery:function(e,t){var n;1&e&&(b.Sc(nt,!0),b.Sc(lt,!0),b.Sc(We,!0),b.Sc(Me,!0),b.Sc(i.f,!0),b.Sc(vt,!0)),2&e&&(b.wc(n=b.cc())&&(t.itemMenuModal=n.first),b.wc(n=b.cc())&&(t.itemRightModal=n.first),b.wc(n=b.cc())&&(t.itemModal=n.first),b.wc(n=b.cc())&&(t.itemPermissionModal=n.first),b.wc(n=b.cc())&&(t.deleteModal=n.first),b.wc(n=b.cc())&&(t.itemRoleUserModal=n.first))},decls:57,vars:45,consts:[["onBack","{() => window.history.back()}",3,"title"],[1,"card-header"],["nz-row","",1,"header"],["nz-col","","nzSpan","12"],[3,"routerLink"],["nz-icon","","nzType","home"],[3,"nzBordered"],["nzSm","10","nzXS","24","nzMd","10",1,"padding-bottom-10"],["nz-button","","nzType","default","class","btn-reload",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-primary",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-danger",3,"click",4,"ngIf"],["nzSm","14","nzXS","24","nzMd","14",1,"pull-right","padding-bottom-10"],["nzJustify","end"],["nzSm","12","nzXS","12","nzMd","12",1,"padding-bottom-10"],["nzSearch","",3,"nzAddOnAfter"],["type","text","nz-input","",3,"ngModel","placeholder","ngModelChange","keyup.enter"],["suffixIconButton",""],["nz-row","","nzJustify","start",3,"hidden"],["nzSm","12","nzXS","24","nzMd","12",1,"padding-bottom-10"],[1,"margin-0"],["nzSm","4","nzXS","24","nzMd","4","nzFor","status"],["nzSm","18","nzXS","24","nzMd","18"],["nzShowSearch","","nzAllowClear","",2,"text-align","center",3,"nzPlaceHolder","ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["id","unit-grid",1,"ag-theme-alpine",2,"width","100%","height","70vh",3,"modules","columnDefs","defaultColDef","suppressRowClickSelection","rowSelection","rowData","overlayLoadingTemplate","overlayNoRowsTemplate","frameworkComponents","excelStyles","selectionChanged","cellDoubleClicked","gridReady"],["agGrid",""],[3,"grid","filter","pageSizeOptions","pageNumberChange","pageSizeChange"],[3,"isVisible","item","type","option","eventEmmit"],["itemModal",""],[3,"isVisible","eventEmmit"],["deleteModal",""],[3,"eventEmmit"],["itemRoleUserModal",""],["itemRightModal",""],["itemMenuModal",""],["nz-button","","nzType","default",1,"btn-reload",3,"click"],["nz-icon","","nzType","reload","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"click"],["nz-icon","","nzType","file-add","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-danger",3,"click"],["nz-icon","","nzType","delete","nzTheme","fill"],["nz-button","","nzType","default","nzSearch","",3,"title","click"],["nz-icon","","nzType","caret-down","nzTheme","outline",4,"ngIf"],["nz-icon","","nzType","caret-up","nzTheme","outline",4,"ngIf"],["nz-icon","","nzType","caret-down","nzTheme","outline"],["nz-icon","","nzType","caret-up","nzTheme","outline"],[3,"nzLabel","nzValue"]],template:function(e,t){if(1&e&&(b.Ub(0,"page-header-wrapper",0),b.Ub(1,"nz-card",1),b.Ub(2,"div",2),b.Ub(3,"div",3),b.Ub(4,"nz-breadcrumb"),b.Ub(5,"nz-breadcrumb-item"),b.Ub(6,"a",4),b.Pb(7,"i",5),b.Tb(),b.Tb(),b.Ub(8,"nz-breadcrumb-item"),b.Ub(9,"a"),b.Ub(10,"span"),b.Nc(11),b.gc(12,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Ub(13,"nz-breadcrumb-item"),b.Ub(14,"a"),b.Nc(15),b.gc(16,"translate"),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(17,"nz-card",6),b.Ub(18,"nz-row"),b.Ub(19,"nz-col",7),b.Lc(20,It,3,1,"button",8),b.Lc(21,Ct,3,1,"button",9),b.Lc(22,kt,3,1,"button",10),b.Tb(),b.Ub(23,"nz-col",11),b.Ub(24,"nz-row",12),b.Ub(25,"nz-col",13),b.Ub(26,"nz-input-group",14),b.Ub(27,"input",15),b.bc("ngModelChange",(function(e){return t.filter.textSearch=e}))("keyup.enter",(function(){return t.initGridData()})),b.gc(28,"translate"),b.Tb(),b.Tb(),b.Lc(29,Rt,4,5,"ng-template",null,16,b.Mc),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(31,"div",17),b.Ub(32,"nz-col",18),b.Ub(33,"nz-form-item",19),b.Ub(34,"nz-form-label",20),b.Nc(35),b.gc(36,"translate"),b.Tb(),b.Ub(37,"nz-form-control",21),b.Ub(38,"nz-select",22),b.bc("ngModelChange",(function(e){return t.changeStatus(e)}))("ngModelChange",(function(e){return t.filter.status=e})),b.gc(39,"translate"),b.Lc(40,Dt,1,2,"nz-option",23),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(41,"nz-row"),b.Ub(42,"ag-grid-angular",24,25),b.bc("selectionChanged",(function(e){return t.onSelectionChanged(e)}))("cellDoubleClicked",(function(e){return t.onCellDoubleClicked(e)}))("gridReady",(function(e){return t.onGridReady(e)})),b.Tb(),b.Tb(),b.Ub(44,"app-ag-grid-pagination",26),b.bc("pageNumberChange",(function(){return t.onPageNumberChange()}))("pageSizeChange",(function(){return t.onPageSizeChange()})),b.Tb(),b.Tb(),b.Tb(),b.Ub(45,"app-role-item",27,28),b.bc("eventEmmit",(function(e){return t.onModalEventEmmit(e)})),b.Tb(),b.Ub(47,"delete-modal",29,30),b.bc("eventEmmit",(function(e){return t.onDeleteEventEmmit(e)})),b.Tb(),b.Ub(49,"app-role-data-permission",31,28),b.bc("eventEmmit",(function(e){return t.onModalPermissionEventEmmit(e)})),b.Tb(),b.Ub(51,"app-role-user",31,32),b.bc("eventEmmit",(function(e){return t.onModalRoleUserEventEmmit(e)})),b.Tb(),b.Ub(53,"app-role-right",31,33),b.bc("eventEmmit",(function(e){return t.onModalRightEventEmmit(e)})),b.Tb(),b.Ub(55,"app-role-menu",31,34),b.bc("eventEmmit",(function(e){return t.onModalMenuEventEmmit(e)})),b.Tb()),2&e){const e=b.xc(30);b.nc("title",t.tittle),b.Ab(6),b.nc("routerLink",b.rc(44,Mt)),b.Ab(5),b.Oc(b.hc(12,34,"menu.permission")),b.Ab(4),b.Pc(" ",b.hc(16,36,"layout.breadcum.role")," "),b.Ab(2),b.nc("nzBordered",!1),b.Ab(3),b.nc("ngIf",t.btnReload.visible&&t.btnReload.grandAccess),b.Ab(1),b.nc("ngIf",t.btnAdd.visible&&t.btnAdd.grandAccess),b.Ab(1),b.nc("ngIf",t.btnDelete.visible&&t.btnDelete.grandAccess),b.Ab(4),b.nc("nzAddOnAfter",e),b.Ab(1),b.oc("placeholder",b.hc(28,38,"layout.grid.search.text-search.placeholder")),b.nc("ngModel",t.filter.textSearch),b.Ab(4),b.nc("hidden",!t.filter.ShowAdSearch),b.Ab(4),b.Oc(b.hc(36,40,"layout.grid.search.status.label")),b.Ab(3),b.oc("nzPlaceHolder",b.hc(39,42,"layout.grid.search.status.placeholder")),b.nc("ngModel",t.filter.status),b.Ab(2),b.nc("ngForOf",t.listStatus),b.Ab(2),b.nc("modules",t.modules)("columnDefs",t.columnDefs)("defaultColDef",t.defaultColDef)("suppressRowClickSelection",!0)("rowSelection",t.rowSelection)("rowData",t.grid.rowData)("overlayLoadingTemplate",t.overlayLoadingTemplate)("overlayNoRowsTemplate",t.overlayNoRowsTemplate)("frameworkComponents",t.frameworkComponents)("excelStyles",t.excelStyles),b.Ab(2),b.nc("grid",t.grid)("filter",t.filter)("pageSizeOptions",t.pageSizeOptions),b.Ab(1),b.nc("isVisible",t.modal.isShow)("item",t.modal.item)("type",t.modal.type)("option",t.modal.option),b.Ab(2),b.nc("isVisible",t.isShowDelete)}},directives:[T.a,v.a,A.c,A.a,y.a,y.b,s.m,S.a,U.a,r.o,I.c,I.b,d.d,d.o,d.r,k.c,k.d,k.a,At.e,r.n,yt.a,St.a,We,Ut.a,Me,vt,lt,nt,M.a,E.a,At.a],pipes:[x.c],styles:[""]}),e})()},{path:"menu",component:re},{path:"right",component:Ue}]}];let xt=(()=>{class e{}return e.\u0275mod=b.Mb({type:e}),e.\u0275inj=b.Lb({factory:function(t){return new(t||e)},imports:[[s.n.forChild(Et)],s.n]}),e})(),Nt=(()=>{class e{}return e.\u0275mod=b.Mb({type:e}),e.\u0275inj=b.Lb({factory:function(t){return new(t||e)},imports:[[i.k,xt,yt.b.withComponents([])]]}),e})()}}]);