!function(){function e(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||t(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=t(e))||n&&e&&"number"==typeof e.length){i&&(e=i);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,l=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){l=!0,c=e},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw c}}}}function t(e,n){if(e){if("string"==typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function a(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,n,t){return n&&a(e.prototype,n),t&&a(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{W9jO:function(t,i,a){"use strict";a.r(i),a.d(i,"PermissionModule",(function(){return Jn}));var o=a("M0ag"),l=a("tyNb"),s=a("mrSG"),u=a("ofXK"),d=a("Ac7g"),b=a("YMfE"),h=a("sspt"),f=a("3Pt+"),m=a("fXoL"),g=a("atJ9"),p=a("bNXi"),v=a("hdNf"),z=a("o0su"),y=a("RY2A"),T=a("PScX"),A=a("dEAy"),S=(a("ey9i"),a("qBMM")),k=a("JA5x"),U=a("B+r4"),I=a("yNE/"),C=a("C2AL"),L=a("FwiY"),O=a("PTRe"),R=a("nxWG"),D=a("ocnv"),E=a("VXpv"),M=a("TaO5"),x=a("EGpF"),N=a("ZyQt"),w=a("OzZK"),V=a("RwU8"),P=a("sYmb");function F(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",52),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnReload.click(e)})),m.Pb(1,"i",53),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc("",i.btnReload.titlei18n," ")}}function B(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",54),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnAdd.click(e)})),m.Pb(1,"i",55),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc("",i.btnAdd.titlei18n," ")}}function G(e,n){if(1&e&&(m.Lc(0,F,3,1,"button",51),m.Lc(1,B,3,1,"button",48)),2&e){var t=m.fc();m.nc("ngIf",t.btnReload.visible&&t.btnReload.grandAccess),m.Ab(1),m.nc("ngIf",t.btnAdd.visible&&t.btnAdd.grandAccess)}}function q(e,n){1&e&&m.Pb(0,"i",56)}function X(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.code.message.required"),""))}function j(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.code.message.pattern"),""))}function K(e,n){if(1&e&&(m.Lc(0,X,3,3,"ng-container",57),m.Lc(1,j,3,3,"ng-container",57)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function H(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.name.message.required"),""))}function $(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.name.message.pattern"),""))}function _(e,n){if(1&e&&(m.Lc(0,H,3,3,"ng-container",57),m.Lc(1,$,3,3,"ng-container",57)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function W(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.i18n-name.message.required"),""))}function J(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.i18n-name.message.pattern"),""))}function Q(e,n){if(1&e&&(m.Lc(0,W,3,3,"ng-container",57),m.Lc(1,J,3,3,"ng-container",57)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function Y(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.url.message.required"),""))}function Z(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.url.message.pattern"),""))}function ee(e,n){if(1&e&&(m.Lc(0,Y,3,3,"ng-container",57),m.Lc(1,Z,3,3,"ng-container",57)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function ne(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.icon.message.required"),""))}function te(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.icon.message.pattern"),""))}function ie(e,n){if(1&e&&(m.Lc(0,ne,3,3,"ng-container",57),m.Lc(1,te,3,3,"ng-container",57)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function re(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.menu.order.error.message"),""))}function ae(e,n){1&e&&m.Lc(0,re,3,3,"ng-container",57),2&e&&m.nc("ngIf",n.$implicit.hasError("min"))}function ce(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",54),m.bc("click",(function(e){return m.Ac(t),m.fc().btnEdit.click(e)})),m.Pb(1,"i",58),m.Nc(2),m.Tb()}if(2&e){var i=m.fc();m.Ab(2),m.Pc("",i.btnEdit.titlei18n," ")}}function oe(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",59),m.bc("click",(function(e){return m.Ac(t),m.fc().btnSave.click(e)})),m.Pb(1,"i",60),m.Nc(2),m.Tb()}if(2&e){var i=m.fc();m.nc("nzLoading",i.isLoading)("disabled",!i.form.valid),m.Ab(2),m.Pc("",i.btnSave.titlei18n," ")}}function le(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",61),m.bc("click",(function(e){return m.Ac(t),m.fc().btnDelete.click(e)})),m.Pb(1,"i",62),m.Nc(2),m.Tb()}if(2&e){var i=m.fc();m.Ab(2),m.Pc("",i.btnDelete.titlei18n," ")}}var se,ue=function(){return["/"]},de=((se=function(){function e(n,t,i,a,c,o,l,s,u,d,m){var g=this;r(this,e),this.fb=n,this.aclService=t,this.notification=i,this.elementRef=a,this.roleService=c,this.menuService=o,this.arrayService=l,this.messageService=s,this.modal=u,this.i18n=d,this.doc=m,this.isRenderComplete=!1,this.listStatus=b.m,this.filter=Object.assign({},b.s),this.pageSizeOptions=[],this.paginationMessage="",this.modules=[h.a],this.rowSelection="multiple",this.overlayLoadingTemplate=b.p,this.overlayNoRowsTemplate=b.q,this.quickText="",this.isLoadingDelete=!1,this.isShowDelete=!1,this.isShowImport=!1,this.tittle=""+this.i18n.fanyi("function.menu.title"),this.treeMenuData=[],this.menuParentList=[],this.rightList=[],this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.listRole=[],this.treeRoleData=[],this.roleIdsSelected=[],this.isLoading=!1,this.delDisabled=!1,this.expandAll=!0,this.btnAdd={title:"Th\xeam m\u1edbi",titlei18n:""+this.i18n.fanyi("layout.button.btn-add.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.onAddItem()}},this.btnDelete={title:"X\xf3a",titlei18n:""+this.i18n.fanyi("layout.button.btn-delete.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.onDeleteItem()}},this.btnReload={title:"T\u1ea3i l\u1ea1i",titlei18n:""+this.i18n.fanyi("layout.button.btn-reload.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.initListMenu()}},this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.save()}},this.btnEdit={title:"C\u1eadp nh\u1eadt",titlei18n:""+this.i18n.fanyi("layout.button.btn-edit.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.onEditItem(g.item)}},this.form=this.fb.group({parentId:[null],code:[{value:null,disabled:!1},[f.w.required,f.w.pattern(b.t)]],name:[{value:null,disabled:!1},[f.w.required,f.w.pattern(b.v)]],i18n:[{value:null,disabled:!1}],url:[{value:null,disabled:!1}],icon:[{value:null,disabled:!1}],order:[{value:0,disabled:!1},[f.w.min(0)]],hideBreadcrumb:[{value:!0,disabled:!1}],status:[{value:!0,disabled:!1}]})}return c(e,[{key:"ngOnInit",value:function(){this.initRightOfUser(),this.isRenderComplete=!0,this.initListRole(),this.initListMenu()}},{key:"initRightOfUser",value:function(){this.btnAdd.grandAccess=this.aclService.canAbility("NAVIGATION-ADD"),this.btnDelete.grandAccess=this.aclService.canAbility("NAVIGATION-DELETE"),this.btnEdit.grandAccess=this.aclService.canAbility("NAVIGATION-EDIT")}},{key:"initListRole",value:function(){var e=this;this.roleService.getListCombobox().subscribe((function(n){n.data&&(n.data.forEach((function(e){e.parent_id=null})),e.listRole=n.data,e.convertListRoleToTreeData())}),(function(e){return console.log(e)}))}},{key:"initListMenu",value:function(){var e=this;this.menuService.getAllListCombobox().subscribe((function(n){if(200===n.code)if(null!=n.data){var t=n.data.map((function(e,n,t){var i=t.some((function(n){return n.parentId===e.id}));return{id:e.id,parent_id:e.parentId,title:e.name,isLeaf:!i,expanded:!0,selected:!1,checked:!1}}));e.treeMenuData=e.arrayService.arrToTreeNode(t,{cb:function(e,n,t){e.selected=0===e.id}})}else e.notification.error(""+e.i18n.fanyi("function.menu.message-error.title"),""+n.message);else e.notification.error(""+e.i18n.fanyi("function.menu.message-error.title"),""+n.message)}),(function(e){}))}},{key:"convertListRoleToTreeData",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.listRole.map((function(t,i,r){var a=r.some((function(e){return e.parentId===t.id})),c=e.roleIdsSelected.some((function(e){return e===t.id}));return{id:t.id,parent_id:t.parentId,title:t.name,isLeaf:!a,expanded:!1,selected:!1,checked:c,disabled:n,disableCheckbox:n}}));this.treeRoleData=this.arrayService.arrToTreeNode(t,{cb:function(e,n,t){e.selected=0===e.id}})}},{key:"onAddItem",value:function(){this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.form.enable(),this.resetForm(),this.item=null}},{key:"onAddItemFromParent",value:function(e){this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.form.enable(),this.resetForm(),this.form.controls.parentId.setValue(e.id),this.item=null}},{key:"onEditItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isAdd=!1,this.isEdit=!0,this.isInfo=!1,this.item=e,this.form.enable(),this.form.controls.code.disable(),this.form.controls.i18n.disable(),this.form.controls.url.disable(),this.getById(e.id,!1)}},{key:"onViewItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isAdd=!1,this.isEdit=!1,this.isInfo=!0,this.item=e,this.form.disable(),this.getById(e.id,!0)}},{key:"resetForm",value:function(){var e,n,t,i;this.form.reset(),null===(e=this.form.get("status"))||void 0===e||e.setValue(!0),null===(n=this.form.get("hideBreadcrumb"))||void 0===n||n.setValue(!0),null===(t=this.form.get("order"))||void 0===t||t.setValue(0),null===(i=this.form.get("code"))||void 0===i||i.enable(),this.roleIdsSelected=[],this.convertListRoleToTreeData()}},{key:"onDeleteItem",value:function(){var e=this;this.modal.confirm({nzTitle:""+this.i18n.fanyi("function.menu.modal-delete.header"),nzContent:""+this.i18n.fanyi("function.menu.modal-delete.body"),nzOkText:""+this.i18n.fanyi("function.menu.modal-delete.button.yes"),nzOkType:"primary",nzOkDanger:!0,nzOnOk:function(){return e.delete()},nzCancelText:""+this.i18n.fanyi("function.menu.modal-delete.button.no"),nzOnCancel:function(){}})}},{key:"delete",value:function(){var e,n=this,t=[null===(e=this.item)||void 0===e?void 0:e.id];this.menuService.delete(t).subscribe((function(e){200===e.code&&null!=e.data?e.data[0].result?(n.messageService.success(""+e.message),Object(b.B)(n.form),n.resetForm(),n.initListMenu(),n.onAddItem()):n.notification.error(""+n.i18n.fanyi("function.menu.message-error.title"),""+e.data[0].message):n.notification.error(""+n.i18n.fanyi("function.menu.message-error.title"),""+e.message)}),(function(e){n.notification.error(""+n.i18n.fanyi("function.menu.message-error.title"),e.error?""+e.error.message:""+e.status)}))}},{key:"getById",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(s.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.menuService.getById(e).subscribe((function(e){200===e.code&&null!=e.data?i.fillForm(e.data,n):i.notification.error(""+i.i18n.fanyi("function.menu.message-error.title"),""+e.message)}),(function(e){i.notification.error(""+i.i18n.fanyi("function.menu.message-error.title"),e.error?""+e.error.message:""+e.status)}));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"fillForm",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.form.controls.parentId.setValue(e.parentId),this.form.controls.code.setValue(e.code),this.form.controls.name.setValue(e.name),this.form.controls.i18n.setValue(e.i18nName),this.form.controls.url.setValue(e.link),this.form.controls.icon.setValue(e.icon),this.form.controls.order.setValue(e.order),this.form.controls.hideBreadcrumb.setValue(e.hideInBreadcrumb),this.form.controls.status.setValue(e.status),this.roleIdsSelected=e.roleIds,this.convertListRoleToTreeData(n)}},{key:"show",value:function(e){this.item=e.node.origin,this.onViewItem(this.item)}},{key:"save",value:function(){var e,n=this;for(var t in this.isLoading=!0,Object(b.B)(this.form),this.form.controls)this.form.controls[t].markAsDirty(),this.form.controls[t].updateValueAndValidity();if(!this.form.valid)return this.isLoading=!1,this.messageService.error(""+this.i18n.fanyi("function.menu.message-error.form-invalid")),void(this.isLoading=!1);var i={id:null===(e=this.item)||void 0===e?void 0:e.id,name:this.form.controls.name.value,i18nName:this.form.controls.i18n.value,code:this.form.controls.code.value.toUpperCase(),parentId:this.form.controls.parentId.value,link:this.form.controls.url.value,icon:this.form.controls.icon.value,order:this.form.controls.order.value?this.form.controls.order.value:0,hideInBreadcrumb:!!this.form.controls.hideBreadcrumb.value&&this.form.controls.hideBreadcrumb.value,status:this.form.controls.status.value,roleIds:this.roleIdsSelected.filter((function(e,n,t){return t.indexOf(e)===n}))};this.isAdd&&this.menuService.create(i).subscribe((function(e){n.isLoading=!1,200===e.code&&null!=e.data?(n.messageService.success(""+e.message),n.resetForm(),n.initListMenu(),n.onAddItem()):n.messageService.error(""+e.message)}),(function(e){n.isLoading=!1,n.messageService.error(e.error?""+e.error.message:""+e.status)})),this.isEdit&&this.menuService.update(i).subscribe((function(e){n.isLoading=!1,200===e.code&&null!=e.data?(n.messageService.success(""+e.message),n.resetForm(),n.initListMenu(),n.onAddItem()):n.messageService.error(""+e.message)}),(function(e){n.isLoading=!1,n.messageService.error(e.error?""+e.error.message:""+e.status)}))}},{key:"nzEventRoleChange",value:function(e){this.roleIdsSelected=e.checkedKeys&&e.checkedKeys.length>0?this.roleIdsSelected.concat(e.checkedKeys.map((function(e){return e.origin.id}))).filter((function(e,n,t){return t.indexOf(e)===n})):this.roleIdsSelected.filter((function(n){var t;return n!==(null===(t=e.node)||void 0===t?void 0:t.key)}))}}]),e}()).\u0275fac=function(e){return new(e||se)(m.Ob(f.e),m.Ob(g.a),m.Ob(p.b),m.Ob(m.l),m.Ob(v.a),m.Ob(z.l),m.Ob(y.c),m.Ob(T.e),m.Ob(A.f),m.Ob(d.a),m.Ob(u.e))},se.\u0275cmp=m.Ib({type:se,selectors:[["app-menu"]],viewQuery:function(e,n){var t;1&e&&m.Sc(o.f,!0),2&e&&m.wc(t=m.cc())&&(n.deleteModal=t.first)},decls:148,vars:99,consts:[["onBack","{() => window.history.back()}",3,"title"],[1,"card-header"],["nz-row","",1,"header"],["nz-col","","nzSpan","12"],[3,"routerLink"],["nz-icon","","nzType","home"],["nz-col","","nzSpan","12",2,"text-align","right"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","24","nzLg","8"],[3,"nzTitle","nzExtra"],["extraTpl",""],[3,"nzSuffix"],["type","text","nz-input","",3,"placeholder","ngModel","ngModelChange"],["suffixIcon",""],["nzShowLine","",2,"margin-top","10px",3,"nzData","nzSearchValue","nzExpandAll","nzClick"],["nz-col","","nzMd","24","nzLg","16"],["nz-form","","id","formMenu",3,"formGroup"],["nzSm","24","nzLg","11","nzXs","24"],[1,"flex-column"],["nzFor","parentId"],["formControlName","parentId","nzShowSearch","","nzShowLine","",3,"nzNodes","nzPlaceHolder"],["nzSm","24","nzLg","2","nzXs","24"],["nzRequired","","nzFor","code"],[3,"nzErrorTip"],["nz-input","","formControlName","code","id","code",2,"text-transform","uppercase",3,"placeholder"],["validateCode",""],["nzRequired","","nzFor","name"],["nz-input","","formControlName","name","id","name",3,"placeholder"],["validateName",""],["nzFor","i18n","nzRequired",""],["nz-input","","formControlName","i18n","id","i18n",3,"placeholder"],["validateI18nName",""],["nzFor","url"],["nz-input","","formControlName","url","id","url",3,"placeholder"],["validateUrl",""],["nzFor","icon"],["nz-input","","formControlName","icon","id","icon",3,"placeholder"],["validateIcon",""],["nzCheckable","","nzMultiple","",3,"nzData","nzExpandAll","nzCheckBoxChange","nzClick"],["nzSm","24","nzLg","11","nzXs","24",1,"form-item-order"],["nzFor","order"],["nz-input","","type","number","formControlName","order","id","order",3,"placeholder"],["validateOrder",""],["formControlName","hideBreadcrumb","nz-checkbox",""],["nzFor","status"],["formControlName","status","nzSize","small",2,"margin-right","5px"],[3,"nzColor","hidden"],[2,"float","right","margin","10px 0"],["nz-button","","nzType","primary","class","btn-primary",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","","nzType","danger","class","btn-danger",3,"click",4,"ngIf"],["nz-button","","nzType","default","class","btn-reload",3,"click",4,"ngIf"],["nz-button","","nzType","default",1,"btn-reload",3,"click"],["nz-icon","","nzType","reload","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"click"],["nz-icon","","nzType","file-add","nzTheme","fill"],["nz-icon","","nzType","search"],[4,"ngIf"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","disabled","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","danger",1,"btn-danger",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline"]],template:function(e,n){if(1&e&&(m.Ub(0,"page-header-wrapper",0),m.Ub(1,"nz-card",1),m.Ub(2,"div",2),m.Ub(3,"div",3),m.Ub(4,"nz-breadcrumb"),m.Ub(5,"nz-breadcrumb-item"),m.Ub(6,"a",4),m.Pb(7,"i",5),m.Tb(),m.Tb(),m.Ub(8,"nz-breadcrumb-item"),m.Ub(9,"a"),m.Ub(10,"span"),m.Nc(11),m.gc(12,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Ub(13,"nz-breadcrumb-item"),m.Ub(14,"a"),m.Nc(15),m.gc(16,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(17,"div",6),m.Tb(),m.Tb(),m.Ub(18,"div",7),m.Ub(19,"div",8),m.Ub(20,"nz-card",9),m.gc(21,"translate"),m.Lc(22,G,2,2,"ng-template",null,10,m.Mc),m.Ub(24,"nz-input-group",11),m.Ub(25,"input",12),m.bc("ngModelChange",(function(e){return n.searchMenuValue=e})),m.gc(26,"translate"),m.Tb(),m.Tb(),m.Lc(27,q,1,0,"ng-template",null,13,m.Mc),m.Ub(29,"nz-tree",14),m.bc("nzClick",(function(e){return n.show(e)})),m.Tb(),m.Tb(),m.Tb(),m.Ub(30,"div",15),m.Ub(31,"form",16),m.Ub(32,"nz-card"),m.Ub(33,"fieldset"),m.Ub(34,"legend"),m.Nc(35),m.gc(36,"translate"),m.Tb(),m.Ub(37,"nz-row"),m.Ub(38,"nz-col",17),m.Ub(39,"nz-form-item",18),m.Ub(40,"nz-form-label",19),m.Nc(41),m.gc(42,"translate"),m.Tb(),m.Ub(43,"nz-form-control"),m.Pb(44,"nz-tree-select",20),m.gc(45,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Pb(46,"nz-col",21),m.Ub(47,"nz-col",17),m.Ub(48,"nz-form-item",18),m.Ub(49,"nz-form-label",22),m.Nc(50),m.gc(51,"translate"),m.Tb(),m.Ub(52,"nz-form-control",23),m.Pb(53,"input",24),m.gc(54,"translate"),m.Lc(55,K,2,2,"ng-template",null,25,m.Mc),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(57,"br"),m.Ub(58,"nz-row"),m.Ub(59,"nz-col",17),m.Ub(60,"nz-form-item",18),m.Ub(61,"nz-form-label",26),m.Nc(62),m.gc(63,"translate"),m.Tb(),m.Ub(64,"nz-form-control",23),m.Pb(65,"input",27),m.gc(66,"translate"),m.Lc(67,_,2,2,"ng-template",null,28,m.Mc),m.Tb(),m.Tb(),m.Tb(),m.Pb(69,"nz-col",21),m.Ub(70,"nz-col",17),m.Ub(71,"nz-form-item",18),m.Ub(72,"nz-form-label",29),m.Nc(73),m.gc(74,"translate"),m.Tb(),m.Ub(75,"nz-form-control",23),m.Pb(76,"input",30),m.gc(77,"translate"),m.Lc(78,Q,2,2,"ng-template",null,31,m.Mc),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(80,"br"),m.Ub(81,"nz-row"),m.Ub(82,"nz-col",17),m.Ub(83,"nz-form-item",18),m.Ub(84,"nz-form-label",32),m.Nc(85),m.gc(86,"translate"),m.Tb(),m.Ub(87,"nz-form-control",23),m.Pb(88,"input",33),m.gc(89,"translate"),m.Lc(90,ee,2,2,"ng-template",null,34,m.Mc),m.Tb(),m.Tb(),m.Tb(),m.Pb(92,"nz-col",21),m.Ub(93,"nz-col",17),m.Ub(94,"nz-form-item",18),m.Ub(95,"nz-form-label",35),m.Nc(96),m.gc(97,"translate"),m.Tb(),m.Ub(98,"nz-form-control",23),m.Pb(99,"input",36),m.gc(100,"translate"),m.Lc(101,ie,2,2,"ng-template",null,37,m.Mc),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(103,"br"),m.Ub(104,"nz-row"),m.Ub(105,"nz-col",17),m.Ub(106,"nz-form-item"),m.Ub(107,"nz-form-label"),m.Nc(108),m.gc(109,"translate"),m.Tb(),m.Ub(110,"nz-form-control"),m.Ub(111,"nz-tree",38),m.bc("nzCheckBoxChange",(function(e){return n.nzEventRoleChange(e)}))("nzClick",(function(e){return n.nzEventRoleChange(e)})),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(112,"nz-col",21),m.Ub(113,"nz-col",39),m.Ub(114,"nz-form-item",18),m.Ub(115,"nz-form-label",40),m.Nc(116),m.gc(117,"translate"),m.Tb(),m.Ub(118,"nz-form-control",23),m.Pb(119,"input",41),m.gc(120,"translate"),m.Lc(121,ae,1,1,"ng-template",null,42,m.Mc),m.Tb(),m.Tb(),m.Pb(123,"br"),m.Ub(124,"nz-form-item",18),m.Ub(125,"nz-form-control"),m.Ub(126,"label",43),m.Nc(127),m.gc(128,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Pb(129,"br"),m.Ub(130,"nz-form-item",18),m.Ub(131,"nz-form-label",44),m.Nc(132),m.gc(133,"translate"),m.Tb(),m.Ub(134,"nz-form-control"),m.Pb(135,"nz-switch",45),m.Ub(136,"label"),m.Ub(137,"nz-tag",46),m.Nc(138),m.gc(139,"translate"),m.Tb(),m.Ub(140,"nz-tag",46),m.Nc(141),m.gc(142,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(143,"br"),m.Tb(),m.Ub(144,"div",47),m.Lc(145,ce,3,1,"button",48),m.Lc(146,oe,3,3,"button",49),m.Lc(147,le,3,1,"button",50),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb()),2&e){var t=m.xc(23),i=m.xc(28),r=m.xc(56),a=m.xc(68),c=m.xc(79),o=m.xc(91),l=m.xc(102),s=m.xc(122);m.nc("title",n.tittle),m.Ab(6),m.nc("routerLink",m.rc(98,ue)),m.Ab(5),m.Oc(m.hc(12,50,"menu.permission")),m.Ab(4),m.Pc(" ",m.hc(16,52,"layout.breadcum.menu")," "),m.Ab(3),m.nc("nzGutter",32),m.Ab(2),m.oc("nzTitle",m.hc(21,54,"function.menu.list.header")),m.nc("nzExtra",t),m.Ab(4),m.nc("nzSuffix",i),m.Ab(1),m.oc("placeholder",m.hc(26,56,"layout.grid.search.text-search.placeholder")),m.nc("ngModel",n.searchMenuValue),m.Ab(4),m.nc("nzData",n.treeMenuData)("nzSearchValue",n.searchMenuValue)("nzExpandAll",n.expandAll),m.Ab(2),m.nc("formGroup",n.form),m.Ab(4),m.Oc(m.hc(36,58,"function.menu.menu-info.header")),m.Ab(6),m.Oc(m.hc(42,60,"function.menu.parent.label")),m.Ab(3),m.oc("nzPlaceHolder",m.hc(45,62,"function.menu.parent.placeholder")),m.nc("nzNodes",n.treeMenuData),m.Ab(6),m.Oc(m.hc(51,64,"function.menu.code.label")),m.Ab(2),m.nc("nzErrorTip",r),m.Ab(1),m.oc("placeholder",m.hc(54,66,"function.menu.code.placeholder")),m.Ab(9),m.Oc(m.hc(63,68,"function.menu.name.label")),m.Ab(2),m.nc("nzErrorTip",a),m.Ab(1),m.oc("placeholder",m.hc(66,70,"function.menu.name.placeholder")),m.Ab(8),m.Oc(m.hc(74,72,"function.menu.i18n.label")),m.Ab(2),m.nc("nzErrorTip",c),m.Ab(1),m.oc("placeholder",m.hc(77,74,"function.menu.i18n.placeholder")),m.Ab(9),m.Oc(m.hc(86,76,"function.menu.url.label")),m.Ab(2),m.nc("nzErrorTip",o),m.Ab(1),m.oc("placeholder",m.hc(89,78,"function.menu.url.placeholder")),m.Ab(8),m.Oc(m.hc(97,80,"function.menu.icon.label")),m.Ab(2),m.nc("nzErrorTip",l),m.Ab(1),m.oc("placeholder",m.hc(100,82,"function.menu.icon.placeholder")),m.Ab(9),m.Oc(m.hc(109,84,"function.menu.role.label")),m.Ab(3),m.nc("nzData",n.treeRoleData)("nzExpandAll",!0),m.Ab(5),m.Oc(m.hc(117,86,"function.menu.order.label")),m.Ab(2),m.nc("nzErrorTip",s),m.Ab(1),m.oc("placeholder",m.hc(120,88,"function.menu.order.placeholder")),m.Ab(8),m.Pc(" ",m.hc(128,90,"function.menu.hide-breadcrumb.label")," "),m.Ab(5),m.Oc(m.hc(133,92,"function.menu.status.label")),m.Ab(5),m.nc("nzColor","#00BB00")("hidden",!n.form.value.status),m.Ab(1),m.Oc(m.hc(139,94,"function.menu.status-true.label")),m.Ab(2),m.nc("nzColor","#EF5350")("hidden",n.form.value.status),m.Ab(1),m.Oc(m.hc(142,96,"function.menu.status-false.label")),m.Ab(4),m.nc("ngIf",n.btnEdit.visible&&n.btnEdit.grandAccess&&n.isInfo),m.Ab(1),m.nc("ngIf",!n.isInfo&&n.btnSave.visible&&n.btnSave.grandAccess),m.Ab(1),m.nc("ngIf",n.btnDelete.visible&&n.btnDelete.grandAccess&&(n.isInfo||n.isEdit))}},directives:[S.a,k.a,U.c,U.a,I.a,I.b,l.m,C.a,L.a,O.c,O.d,O.b,f.d,f.o,f.r,R.a,f.x,f.p,D.b,f.h,D.c,D.d,D.a,E.a,f.g,f.s,M.a,x.a,N.a,u.o,w.a,V.a],pipes:[P.c],styles:[".form-item-order[_ngcontent-%COMP%] > .ant-form-item-with-help[_ngcontent-%COMP%]{margin-bottom:24px}"]}),se);function be(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",40),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnReload.click(e)})),m.Pb(1,"i",41),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc("",i.btnReload.titlei18n," ")}}function he(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",42),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnAdd.click(e)})),m.Pb(1,"i",43),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc("",i.btnAdd.titlei18n," ")}}function fe(e,n){if(1&e&&(m.Lc(0,be,3,1,"button",39),m.Lc(1,he,3,1,"button",36)),2&e){var t=m.fc();m.nc("ngIf",t.btnReload.visible&&t.btnReload.grandAccess),m.Ab(1),m.nc("ngIf",t.btnAdd.visible&&t.btnAdd.grandAccess)}}function me(e,n){1&e&&m.Pb(0,"i",44)}function ge(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.right.group-name.message.required"),""))}function pe(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.right.group-name.message.pattern"),""))}function ve(e,n){if(1&e&&(m.Lc(0,ge,3,3,"ng-container",45),m.Lc(1,pe,3,3,"ng-container",45)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function ze(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.right.code.message.required"),""))}function ye(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.right.code.message.pattern"),""))}function Te(e,n){if(1&e&&(m.Lc(0,ze,3,3,"ng-container",45),m.Lc(1,ye,3,3,"ng-container",45)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function Ae(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.right.name.message.required"),""))}function Se(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Pc(" ",m.hc(2,1,"function.right.name.message.pattern"),""))}function ke(e,n){if(1&e&&(m.Lc(0,Ae,3,3,"ng-container",45),m.Lc(1,Se,3,3,"ng-container",45)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function Ue(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",42),m.bc("click",(function(e){return m.Ac(t),m.fc().btnEdit.click(e)})),m.Pb(1,"i",46),m.Nc(2),m.Tb()}if(2&e){var i=m.fc();m.Ab(2),m.Pc("",i.btnEdit.titlei18n," ")}}function Ie(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",47),m.bc("click",(function(e){return m.Ac(t),m.fc().btnSave.click(e)})),m.Pb(1,"i",48),m.Nc(2),m.Tb()}if(2&e){var i=m.fc();m.nc("nzLoading",i.isLoading)("disabled",!i.form.valid),m.Ab(2),m.Pc("",i.btnSave.titlei18n," ")}}function Ce(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",49),m.bc("click",(function(e){return m.Ac(t),m.fc().btnDelete.click(e)})),m.Pb(1,"i",50),m.Nc(2),m.Tb()}if(2&e){var i=m.fc();m.Ab(2),m.Pc("",i.btnDelete.titlei18n," ")}}var Le,Oe=function(){return["/"]},Re=((Le=function(){function e(n,t,i,a,c,o,l,s,u,d,m){var g=this;r(this,e),this.fb=n,this.aclService=t,this.notification=i,this.elementRef=a,this.roleService=c,this.rightService=o,this.arrayService=l,this.messageService=s,this.modal=u,this.i18n=d,this.doc=m,this.isRenderComplete=!1,this.listStatus=b.m,this.filter=Object.assign({},b.s),this.pageSizeOptions=[],this.paginationMessage="",this.modules=[h.a],this.rowSelection="multiple",this.overlayLoadingTemplate=b.p,this.overlayNoRowsTemplate=b.q,this.quickText="",this.isLoadingDelete=!1,this.isShowDelete=!1,this.isShowImport=!1,this.tittle=""+this.i18n.fanyi("function.right.title"),this.treeRightData=[],this.rightList=[],this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.listRole=[],this.treeRoleData=[],this.isLoading=!1,this.delDisabled=!1,this.expandAll=!0,this.btnAdd={title:"Th\xeam m\u1edbi",titlei18n:""+this.i18n.fanyi("layout.button.btn-add.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.onAddItem()}},this.btnDelete={title:"X\xf3a",titlei18n:""+this.i18n.fanyi("layout.button.btn-delete.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.onDeleteItem()}},this.btnReload={title:"T\u1ea3i l\u1ea1i",titlei18n:""+this.i18n.fanyi("layout.button.btn-reload.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.initListRight()}},this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.save()}},this.btnEdit={title:"C\u1eadp nh\u1eadt",titlei18n:""+this.i18n.fanyi("layout.button.btn-edit.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.onEditItem(g.item)}},this.form=this.fb.group({code:[{value:null,disabled:!1},[f.w.required,f.w.pattern(b.t)]],name:[{value:null,disabled:!1},[f.w.required,f.w.pattern(b.v)]],groupName:[{value:null,disabled:!1},[f.w.required,f.w.pattern(b.v)]],order:[{value:0,disabled:!1},[f.w.min(0)]],status:[{value:!0,disabled:!1}]})}return c(e,[{key:"ngOnInit",value:function(){this.initRightOfUser(),this.isRenderComplete=!0,this.initListRole(),this.initListRight()}},{key:"initRightOfUser",value:function(){this.btnAdd.grandAccess=this.aclService.canAbility("RIGHT-ADD"),this.btnDelete.grandAccess=this.aclService.canAbility("RIGHT-DELETE"),this.btnEdit.grandAccess=this.aclService.canAbility("RIGHT-EDIT")}},{key:"initListRole",value:function(){var e=this;this.roleService.getListCombobox().subscribe((function(n){n.data&&(n.data.forEach((function(e){e.parent_id=null})),e.listRole=n.data,e.convertListRoleToTreeData())}),(function(e){return console.log(e)}))}},{key:"initListRight",value:function(){var e=this;this.rightService.getListCombobox().subscribe((function(t){if(200===t.code)if(null!=t.data){var i,r=t.data,a=[],c=n(r.map((function(e){return e.groupName})).filter((function(e,n,t){return t.indexOf(e)===n})));try{for(c.s();!(i=c.n()).done;){var o=i.value;a.push({groupName:null,name:o,code:o,id:o})}}catch(s){c.e(s)}finally{c.f()}var l=r.concat(a).map((function(e,n,t){var i=t.some((function(n){return n.groupName===e.id}));return{id:e.id,parent_id:e.groupName,title:e.name,isLeaf:!i,expanded:!0,selected:!1,checked:!1}}));e.treeRightData=e.arrayService.arrToTreeNode(l,{cb:function(e,n,t){e.selected=0===e.id}})}else e.notification.error(""+e.i18n.fanyi("function.right.message-error.title"),""+t.message);else e.notification.error(""+e.i18n.fanyi("function.right.message-error.title"),""+t.message)}),(function(e){}))}},{key:"convertListRoleToTreeData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.listRole.map((function(n,t,i){var r=i.some((function(e){return e.parentId===n.id}));return{id:n.id,parent_id:n.parentId,title:n.name,isLeaf:!r,expanded:!1,selected:!1,checked:!1,disabled:e,disableCheckbox:e}}));this.treeRoleData=this.arrayService.arrToTreeNode(n,{cb:function(e,n,t){e.selected=0===e.id}})}},{key:"onAddItem",value:function(){this.isAdd=!0,this.isEdit=!1,this.isInfo=!1,this.form.enable(),this.resetForm(),this.item=null}},{key:"onEditItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isAdd=!1,this.isEdit=!0,this.isInfo=!1,this.item=e,this.form.enable(),this.form.controls.code.disable(),this.getById(e.id,!1)}},{key:"onViewItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isAdd=!1,this.isEdit=!1,this.isInfo=!0,this.item=e,this.form.disable(),this.getById(e.id,!0)}},{key:"resetForm",value:function(){var e,n,t;this.form.reset(),null===(e=this.form.get("status"))||void 0===e||e.setValue(!0),null===(n=this.form.get("order"))||void 0===n||n.setValue(0),null===(t=this.form.get("code"))||void 0===t||t.enable(),this.convertListRoleToTreeData()}},{key:"onDeleteItem",value:function(){var e=this;this.modal.confirm({nzTitle:""+this.i18n.fanyi("function.right.modal-delete.header"),nzContent:""+this.i18n.fanyi("function.right.modal-delete.body"),nzOkText:""+this.i18n.fanyi("function.right.modal-delete.button.yes"),nzOkType:"primary",nzOkDanger:!0,nzOnOk:function(){return e.delete()},nzCancelText:""+this.i18n.fanyi("function.right.modal-delete.button.no"),nzOnCancel:function(){}})}},{key:"delete",value:function(){var e,n=this,t=[null===(e=this.item)||void 0===e?void 0:e.id];this.rightService.delete(t).subscribe((function(e){200===e.code&&null!=e.data?e.data[0].result?(n.messageService.success(""+e.message),Object(b.B)(n.form),n.resetForm(),n.initListRight(),n.onAddItem()):n.notification.error(""+n.i18n.fanyi("function.menu.message-error.title"),""+e.data[0].message):n.notification.error(""+n.i18n.fanyi("function.right.message-error.title"),""+e.message)}),(function(e){n.notification.error(""+n.i18n.fanyi("function.right.message-error.title"),e.error?""+e.error.message:""+e.status)}))}},{key:"getById",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(s.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.rightService.getById(e).subscribe((function(e){200===e.code&&null!=e.data?i.fillForm(e.data,n):i.notification.error(""+i.i18n.fanyi("function.right.message-error.title"),""+e.message)}),(function(e){i.notification.error(""+i.i18n.fanyi("function.right.message-error.title"),e.error?""+e.error.message:""+e.status)}));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"fillForm",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.form.controls.code.setValue(e.code),this.form.controls.name.setValue(e.name),this.form.controls.groupName.setValue(e.groupName),this.form.controls.order.setValue(e.order),this.form.controls.status.setValue(e.status),this.convertListRoleToTreeData(n)}},{key:"show",value:function(e){this.item=e.node.origin,this.item.isLeaf&&this.onViewItem(this.item)}},{key:"save",value:function(){var e,n=this;for(var t in this.isLoading=!0,Object(b.B)(this.form),this.form.controls)this.form.controls[t].markAsDirty(),this.form.controls[t].updateValueAndValidity();if(!this.form.valid)return this.isLoading=!1,this.messageService.error(""+this.i18n.fanyi("function.right.message-error.form-invalid")),void(this.isLoading=!1);var i={id:null===(e=this.item)||void 0===e?void 0:e.id,name:this.form.controls.name.value,groupName:this.form.controls.groupName.value,code:this.form.controls.code.value.toUpperCase(),order:this.form.controls.order.value?this.form.controls.order.value:0,status:this.form.controls.status.value};this.isAdd&&this.rightService.create(i).subscribe((function(e){n.isLoading=!1,200===e.code&&null!=e.data?(n.messageService.success(""+e.message),n.resetForm(),n.initListRight(),n.onAddItem()):n.messageService.error(""+e.message)}),(function(e){n.isLoading=!1,n.messageService.error(e.error?""+e.error.message:""+e.status)})),this.isEdit&&this.rightService.update(i).subscribe((function(e){n.isLoading=!1,200===e.code&&null!=e.data?(n.messageService.success(""+e.message),n.resetForm(),n.initListRight(),n.onAddItem()):n.messageService.error(""+e.message)}),(function(e){n.isLoading=!1,n.messageService.error(e.error?""+e.error.message:""+e.status)}))}}]),e}()).\u0275fac=function(e){return new(e||Le)(m.Ob(f.e),m.Ob(g.a),m.Ob(p.b),m.Ob(m.l),m.Ob(v.a),m.Ob(z.r),m.Ob(y.c),m.Ob(T.e),m.Ob(A.f),m.Ob(d.a),m.Ob(u.e))},Le.\u0275cmp=m.Ib({type:Le,selectors:[["app-right"]],viewQuery:function(e,n){var t;1&e&&m.Sc(o.f,!0),2&e&&m.wc(t=m.cc())&&(n.deleteModal=t.first)},decls:102,vars:72,consts:[["onBack","{() => window.history.back()}",3,"title"],[1,"card-header"],["nz-row","",1,"header"],["nz-col","","nzSpan","12"],[3,"routerLink"],["nz-icon","","nzType","home"],["nz-col","","nzSpan","12",2,"text-align","right"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","24","nzLg","8"],[3,"nzTitle","nzExtra"],["extraTpl",""],[3,"nzSuffix"],["type","text","nz-input","",3,"placeholder","ngModel","ngModelChange"],["suffixIcon",""],["nzShowLine","",2,"margin-top","10px","height","68vh","overflow-y","auto",3,"nzData","nzSearchValue","nzExpandAll","nzClick"],["nz-col","","nzMd","24","nzLg","16"],["nz-form","","id","formRight",3,"formGroup"],["nzSm","24","nzLg","11","nzXs","24"],[1,"flex-column"],["nzRequired","","nzFor","groupName"],[3,"nzErrorTip"],["nz-input","","formControlName","groupName","id","groupName","autocomplete","on",3,"placeholder"],["validateGroupName",""],["nzSm","24","nzLg","2","nzXs","24"],["nzRequired","","nzFor","code"],["nz-input","","formControlName","code","id","code",2,"text-transform","uppercase",3,"placeholder"],["validateCode",""],["nzRequired","","nzFor","name"],["nz-input","","formControlName","name","id","name",3,"placeholder"],["validateName",""],["nzFor","order"],["nz-input","","type","number","formControlName","order","id","order",3,"placeholder"],["nzFor","status"],["formControlName","status","nzSize","small",2,"margin-right","5px"],[3,"nzColor","hidden"],[2,"float","right","margin","10px 0"],["nz-button","","nzType","primary","class","btn-primary",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","","nzType","danger","class","btn-danger",3,"click",4,"ngIf"],["nz-button","","nzType","default","class","btn-reload",3,"click",4,"ngIf"],["nz-button","","nzType","default",1,"btn-reload",3,"click"],["nz-icon","","nzType","reload","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"click"],["nz-icon","","nzType","file-add","nzTheme","fill"],["nz-icon","","nzType","search"],[4,"ngIf"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","disabled","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","danger",1,"btn-danger",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline"]],template:function(e,n){if(1&e&&(m.Ub(0,"page-header-wrapper",0),m.Ub(1,"nz-card",1),m.Ub(2,"div",2),m.Ub(3,"div",3),m.Ub(4,"nz-breadcrumb"),m.Ub(5,"nz-breadcrumb-item"),m.Ub(6,"a",4),m.Pb(7,"i",5),m.Tb(),m.Tb(),m.Ub(8,"nz-breadcrumb-item"),m.Ub(9,"a"),m.Ub(10,"span"),m.Nc(11),m.gc(12,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Ub(13,"nz-breadcrumb-item"),m.Ub(14,"a"),m.Nc(15),m.gc(16,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(17,"div",6),m.Tb(),m.Tb(),m.Ub(18,"div",7),m.Ub(19,"div",8),m.Ub(20,"nz-card",9),m.gc(21,"translate"),m.Lc(22,fe,2,2,"ng-template",null,10,m.Mc),m.Ub(24,"nz-input-group",11),m.Ub(25,"input",12),m.bc("ngModelChange",(function(e){return n.searchRightValue=e})),m.gc(26,"translate"),m.Tb(),m.Tb(),m.Lc(27,me,1,0,"ng-template",null,13,m.Mc),m.Ub(29,"nz-tree",14),m.bc("nzClick",(function(e){return n.show(e)})),m.Tb(),m.Tb(),m.Tb(),m.Ub(30,"div",15),m.Ub(31,"form",16),m.Ub(32,"nz-card"),m.Ub(33,"fieldset"),m.Ub(34,"legend"),m.Nc(35),m.gc(36,"translate"),m.Tb(),m.Ub(37,"nz-row"),m.Ub(38,"nz-col",17),m.Ub(39,"nz-form-item",18),m.Ub(40,"nz-form-label",19),m.Nc(41),m.gc(42,"translate"),m.Tb(),m.Ub(43,"nz-form-control",20),m.Pb(44,"input",21),m.gc(45,"translate"),m.Lc(46,ve,2,2,"ng-template",null,22,m.Mc),m.Tb(),m.Tb(),m.Tb(),m.Pb(48,"nz-col",23),m.Ub(49,"nz-col",17),m.Ub(50,"nz-form-item",18),m.Ub(51,"nz-form-label",24),m.Nc(52),m.gc(53,"translate"),m.Tb(),m.Ub(54,"nz-form-control",20),m.Pb(55,"input",25),m.gc(56,"translate"),m.Lc(57,Te,2,2,"ng-template",null,26,m.Mc),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(59,"br"),m.Ub(60,"nz-row"),m.Ub(61,"nz-col",17),m.Ub(62,"nz-form-item",18),m.Ub(63,"nz-form-label",27),m.Nc(64),m.gc(65,"translate"),m.Tb(),m.Ub(66,"nz-form-control",20),m.Pb(67,"input",28),m.gc(68,"translate"),m.Lc(69,ke,2,2,"ng-template",null,29,m.Mc),m.Tb(),m.Tb(),m.Tb(),m.Pb(71,"nz-col",23),m.Ub(72,"nz-col",17),m.Ub(73,"nz-form-item",18),m.Ub(74,"nz-form-label",30),m.Nc(75),m.gc(76,"translate"),m.Tb(),m.Ub(77,"nz-form-control",20),m.gc(78,"translate"),m.Pb(79,"input",31),m.gc(80,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(81,"br"),m.Ub(82,"nz-row"),m.Ub(83,"nz-col",17),m.Ub(84,"nz-form-item",18),m.Ub(85,"nz-form-label",32),m.Nc(86),m.gc(87,"translate"),m.Tb(),m.Ub(88,"nz-form-control"),m.Pb(89,"nz-switch",33),m.Ub(90,"label"),m.Ub(91,"nz-tag",34),m.Nc(92),m.gc(93,"translate"),m.Tb(),m.Ub(94,"nz-tag",34),m.Nc(95),m.gc(96,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Pb(97,"br"),m.Tb(),m.Ub(98,"div",35),m.Lc(99,Ue,3,1,"button",36),m.Lc(100,Ie,3,3,"button",37),m.Lc(101,Ce,3,1,"button",38),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb()),2&e){var t=m.xc(23),i=m.xc(28),r=m.xc(47),a=m.xc(58),c=m.xc(70);m.nc("title",n.tittle),m.Ab(6),m.nc("routerLink",m.rc(71,Oe)),m.Ab(5),m.Oc(m.hc(12,37,"menu.permission")),m.Ab(4),m.Pc(" ",m.hc(16,39,"layout.breadcum.right")," "),m.Ab(3),m.nc("nzGutter",32),m.Ab(2),m.oc("nzTitle",m.hc(21,41,"function.right.list.header")),m.nc("nzExtra",t),m.Ab(4),m.nc("nzSuffix",i),m.Ab(1),m.oc("placeholder",m.hc(26,43,"layout.grid.search.text-search.placeholder")),m.nc("ngModel",n.searchRightValue),m.Ab(4),m.nc("nzData",n.treeRightData)("nzSearchValue",n.searchRightValue)("nzExpandAll",n.expandAll),m.Ab(2),m.nc("formGroup",n.form),m.Ab(4),m.Oc(m.hc(36,45,"function.right.right-info.header")),m.Ab(6),m.Oc(m.hc(42,47,"function.right.group-name.label")),m.Ab(2),m.nc("nzErrorTip",r),m.Ab(1),m.oc("placeholder",m.hc(45,49,"function.right.group-name.placeholder")),m.Ab(8),m.Oc(m.hc(53,51,"function.right.code.label")),m.Ab(2),m.nc("nzErrorTip",a),m.Ab(1),m.oc("placeholder",m.hc(56,53,"function.right.code.placeholder")),m.Ab(9),m.Oc(m.hc(65,55,"function.right.name.label")),m.Ab(2),m.nc("nzErrorTip",c),m.Ab(1),m.oc("placeholder",m.hc(68,57,"function.right.name.placeholder")),m.Ab(8),m.Oc(m.hc(76,59,"function.right.order.label")),m.Ab(2),m.oc("nzErrorTip",m.hc(78,61,"function.right.order.error.message")),m.Ab(2),m.oc("placeholder",m.hc(80,63,"function.right.order.placeholder")),m.Ab(7),m.Oc(m.hc(87,65,"function.right.status.label")),m.Ab(5),m.nc("nzColor","#00BB00")("hidden",!n.form.value.status),m.Ab(1),m.Oc(m.hc(93,67,"function.right.status-true.label")),m.Ab(2),m.nc("nzColor","#EF5350")("hidden",n.form.value.status),m.Ab(1),m.Oc(m.hc(96,69,"function.right.status-false.label")),m.Ab(4),m.nc("ngIf",n.btnEdit.visible&&n.btnEdit.grandAccess&&n.isInfo),m.Ab(1),m.nc("ngIf",!n.isInfo&&n.btnSave.visible&&n.btnSave.grandAccess),m.Ab(1),m.nc("ngIf",n.btnDelete.visible&&n.btnDelete.grandAccess&&(n.isInfo||n.isEdit))}},directives:[S.a,k.a,U.c,U.a,I.a,I.b,l.m,C.a,L.a,O.c,O.d,O.b,f.d,f.o,f.r,R.a,f.x,f.p,D.b,f.h,D.c,D.d,D.a,f.g,f.s,x.a,N.a,u.o,w.a,V.a],pipes:[P.c],styles:[""]}),Le);function De(e,n){if(1&e&&m.Nc(0),2&e){var t=m.fc();m.Pc(" ",t.tittle," ")}}function Ee(e,n){1&e&&m.Pb(0,"i",13)}function Me(e,n){1&e&&m.Pb(0,"i",13)}function xe(e,n){if(1&e){var t=m.Vb();m.Ub(0,"nz-row"),m.Ub(1,"nz-col",4),m.Ub(2,"fieldset",5),m.Ub(3,"legend"),m.Nc(4),m.gc(5,"translate"),m.Tb(),m.Ub(6,"h3"),m.Nc(7),m.gc(8,"translate"),m.Tb(),m.Ub(9,"nz-tree",6),m.bc("nzCheckBoxChange",(function(e){return m.Ac(t),m.fc().nzEventDocType(e)}))("nzClick",(function(e){return m.Ac(t),m.fc().nzEventDocType(e)})),m.Tb(),m.Pb(10,"br"),m.Ub(11,"h3"),m.Nc(12),m.gc(13,"translate"),m.Ub(14,"span",7),m.Ub(15,"i"),m.Nc(16,"(\u0111\xe3 ch\u1ecdn "),m.Ub(17,"b"),m.Nc(18),m.Tb(),m.Nc(19,")"),m.Tb(),m.Tb(),m.Tb(),m.Ub(20,"nz-input-group",8),m.Ub(21,"input",9),m.bc("ngModelChange",(function(e){return m.Ac(t),m.fc().orgDocSearchValue=e})),m.Tb(),m.Tb(),m.Lc(22,Ee,1,0,"ng-template",null,10,m.Mc),m.Ub(24,"nz-tree",11),m.bc("nzCheckBoxChange",(function(e){return m.Ac(t),m.fc().nzEventOrgDoc(e)}))("nzClick",(function(e){return m.Ac(t),m.fc().nzEventOrgDoc(e)}))("nzSearchValueChange",(function(e){return m.Ac(t),m.fc().nzEventOrgDocSearch(e)})),m.Tb(),m.Tb(),m.Tb(),m.Ub(25,"nz-col",4),m.Ub(26,"fieldset",5),m.Ub(27,"legend"),m.Nc(28),m.gc(29,"translate"),m.Tb(),m.Ub(30,"h3"),m.Nc(31),m.gc(32,"translate"),m.Ub(33,"span",7),m.Ub(34,"i"),m.Nc(35,"(\u0111\xe3 ch\u1ecdn "),m.Ub(36,"b"),m.Nc(37),m.Tb(),m.Nc(38,")"),m.Tb(),m.Tb(),m.Tb(),m.Ub(39,"nz-input-group",8),m.Ub(40,"input",12),m.bc("ngModelChange",(function(e){return m.Ac(t),m.fc().orgUserSearchValue=e})),m.Tb(),m.Tb(),m.Lc(41,Me,1,0,"ng-template",null,10,m.Mc),m.Ub(43,"nz-tree",11),m.bc("nzCheckBoxChange",(function(e){return m.Ac(t),m.fc().nzEventOrgUser(e)}))("nzClick",(function(e){return m.Ac(t),m.fc().nzEventOrgUser(e)}))("nzSearchValueChange",(function(e){return m.Ac(t),m.fc().nzEventOrgUserSearch(e)})),m.Tb(),m.Tb(),m.Tb(),m.Tb()}if(2&e){var i=m.xc(23),r=m.fc();m.Ab(1),m.nc("nzSm",12)("nzXs",12),m.Ab(3),m.Oc(m.hc(5,25,"function.role.modal-permission.document")),m.Ab(3),m.Oc(m.hc(8,27,"function.role.modal-permission.document.document-type.label")),m.Ab(2),m.nc("nzData",r.documentTypes)("nzExpandAll",!0),m.Ab(3),m.Pc(" ",m.hc(13,29,"function.role.modal-permission.document.organization.label"),": "),m.Ab(6),m.Oc(r.orgDocCheckedLength),m.Ab(2),m.nc("nzSuffix",i),m.Ab(1),m.nc("ngModel",r.orgDocSearchValue),m.Ab(3),m.nc("nzData",r.organizationDataDoc)("nzExpandAll",r.expandAllOrgDoc)("nzCheckStrictly",r.checkStrictlyOrgDoc)("nzSearchValue",r.orgDocSearchValue),m.Ab(1),m.nc("nzSm",12)("nzXs",12),m.Ab(3),m.Oc(m.hc(29,31,"function.role.modal-permission.user")),m.Ab(3),m.Pc(" ",m.hc(32,33,"function.role.modal-permission.user.organization.label"),": "),m.Ab(6),m.Oc(r.orgUserCheckedLength),m.Ab(2),m.nc("nzSuffix",i),m.Ab(1),m.nc("ngModel",r.orgUserSearchValue),m.Ab(3),m.nc("nzData",r.organizationDataUser)("nzExpandAll",r.expandAllOrgUser)("nzCheckStrictly",r.checkStrictlyOrgUser)("nzSearchValue",r.orgUserSearchValue)}}function Ne(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",16),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnSave.click(e)})),m.Pb(1,"i",17),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.nc("nzLoading",i.isLoading),m.Ab(2),m.Pc(" ",i.btnSave.titlei18n," ")}}function we(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",18),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnCancel.click(e)})),m.Pb(1,"i",19),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc(" ",i.btnCancel.titlei18n," ")}}function Ve(e,n){if(1&e&&(m.Lc(0,Ne,3,2,"button",14),m.Lc(1,we,3,1,"button",15)),2&e){var t=m.fc();m.nc("ngIf",t.btnSave.visible&&t.btnSave.grandAccess),m.Ab(1),m.nc("ngIf",t.btnCancel.visible&&t.btnCancel.grandAccess)}}var Pe,Fe=((Pe=function(){function e(n,t,i,a){var c=this;r(this,e),this.messageService=n,this.roleApiService=t,this.arrayService=i,this.i18n=a,this.isVisibleModalPermission=!1,this.eventEmmit=new m.n,this.tittle="",this.isLoading=!1,this.documentTypes=[],this.organizationDataDoc=[],this.organizationDataUser=[],this.expandAllOrgDoc=!1,this.expandAllOrgUser=!1,this.checkStrictlyOrgDoc=!0,this.checkStrictlyOrgUser=!0,this.docTypeIds=[],this.orgDocIds=[],this.orgUserIds=[],this.levelExpand=2,this.orgDocCheckedLength=0,this.orgUserCheckedLength=0,this.listOrg=[],this.listDocType=[],this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){c.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){c.handleCancel()}}}return c(e,[{key:"ngOnInit",value:function(){}},{key:"docTypeConvertToTree",value:function(){var e=this,n=this.listDocType.map((function(n,t,i){var r=i.some((function(e){return e.parentId===n.id})),a=e.docTypeIds.some((function(e){return e===n.id}));return{id:n.id,parent_id:n.parentId,title:n.name,isLeaf:!r,expanded:!1,selected:!1,checked:a}}));this.documentTypes=this.arrayService.arrToTreeNode(n,{cb:function(e,n,t){e.selected=0===e.id}})}},{key:"organizationConvertToTree",value:function(){var e=this,n=this.listOrg.map((function(n,t,i){var r=i.some((function(e){return e.parentId===n.id})),a=e.orgDocIds.some((function(e){return e===n.id}));return{id:n.id,parent_id:n.parentId,title:n.name,isLeaf:!r,expanded:!1,selected:!1,checked:a}})),t=this.listOrg.map((function(n,t,i){var r=i.some((function(e){return e.parentId===n.id})),a=e.orgUserIds.some((function(e){return e===n.id}));return{id:n.id,parent_id:n.parentId,title:n.name,isLeaf:!r,expanded:!1,selected:!1,checked:a}}));this.organizationDataDoc=this.arrayService.arrToTreeNode(n,{cb:function(n,t,i){n.expanded=i<=e.levelExpand,n.selected=0===n.id}}),this.organizationDataUser=this.arrayService.arrToTreeNode(t,{cb:function(n,t,i){n.expanded=i<=e.levelExpand,n.selected=0===n.id}})}},{key:"handleCancel",value:function(){this.isVisibleModalPermission=!1,this.eventEmmit.emit({type:"close"})}},{key:"initData",value:function(e,n,t){this.listDocType=n,this.listOrg=t,this.orgDocCheckedLength=0,this.orgUserCheckedLength=0,this.isVisibleModalPermission=!0,this.roleId=e.id,this.tittle="".concat(this.i18n.fanyi("function.role.modal-permission.header"),": ").concat(e.code),this.getDataPermission()}},{key:"getDataPermission",value:function(){var e=this;this.roleApiService.getDataPermission({id:this.roleId}).subscribe((function(n){e.docTypeIds=n.data.listDocumentTypeId,e.orgUserIds=n.data.listUserInfoOfOrganizationId,e.orgDocIds=n.data.listDocumentOfOrganizationId,e.orgDocCheckedLength=e.orgDocIds.filter((function(e,n,t){return t.indexOf(e)===n})).length,e.orgUserCheckedLength=e.orgUserIds.filter((function(e,n,t){return t.indexOf(e)===n})).length,e.docTypeConvertToTree(),e.organizationConvertToTree()}),(function(e){console.log(e)}))}},{key:"nzEventDocType",value:function(e){this.docTypeIds=e.checkedKeys&&e.checkedKeys.length>0?this.docTypeIds.concat(e.checkedKeys.map((function(e){return e.origin.id}))).filter((function(e,n,t){return t.indexOf(e)===n})):this.docTypeIds.filter((function(n){var t;return n!==(null===(t=e.node)||void 0===t?void 0:t.key)}))}},{key:"nzEventOrgDoc",value:function(e){e.checkedKeys&&e.checkedKeys.length>0?(this.orgDocIds=this.orgDocIds.concat(e.checkedKeys.map((function(e){return e.origin.id}))).filter((function(e,n,t){return t.indexOf(e)===n})),this.orgDocCheckedLength=this.orgDocIds.length):(this.orgDocIds=this.orgDocIds.filter((function(n){var t;return n!==(null===(t=e.node)||void 0===t?void 0:t.key)})),this.orgDocCheckedLength=this.orgDocIds.length)}},{key:"nzEventOrgUser",value:function(e){e.checkedKeys&&e.checkedKeys.length>0?(this.orgUserIds=this.orgUserIds.concat(e.checkedKeys.map((function(e){return e.origin.id}))).filter((function(e,n,t){return t.indexOf(e)===n})),this.orgUserCheckedLength=this.orgUserIds.length):(this.orgUserIds=this.orgUserIds.filter((function(n){var t;return n!==(null===(t=e.node)||void 0===t?void 0:t.key)})),this.orgUserCheckedLength=this.orgUserIds.length)}},{key:"save",value:function(){var e=this,n={listDocumentTypeId:this.docTypeIds.filter((function(e,n,t){return t.indexOf(e)===n})),listDocumentOfOrganizationId:this.orgDocIds.filter((function(e,n,t){return t.indexOf(e)===n})),listUserInfoOfOrganizationId:this.orgUserIds.filter((function(e,n,t){return t.indexOf(e)===n})),id:this.roleId};this.roleApiService.savePermission(n).subscribe((function(n){200===n.code&&null!=n.data?(e.messageService.success(""+n.message),e.isVisibleModalPermission=!1):e.messageService.error(""+n.message)}),(function(e){console.log(e)}))}},{key:"nzEventOrgDocSearch",value:function(e){e.matchedKeys.length<1&&this.docTypeConvertToTree()}},{key:"nzEventOrgUserSearch",value:function(e){e.matchedKeys.length<1&&this.docTypeConvertToTree()}}]),e}()).\u0275fac=function(e){return new(e||Pe)(m.Ob(T.e),m.Ob(v.a),m.Ob(y.c),m.Ob(d.a))},Pe.\u0275cmp=m.Ib({type:Pe,selectors:[["app-role-data-permission"]],inputs:{isVisibleModalPermission:"isVisibleModalPermission"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","1000px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[2,"padding","10px",3,"nzSm","nzXs"],[2,"height","70vh","overflow-y","scroll"],["nzCheckable","","nzMultiple","",3,"nzData","nzExpandAll","nzCheckBoxChange","nzClick"],[2,"color","#1890ff","font-weight","100","font-size","13px"],[3,"nzSuffix"],["type","text","nz-input","","placeholder","T\xecm ki\u1ebfm \u0111\u01a1n v\u1ecb","on","",3,"ngModel","ngModelChange"],["suffixIcon",""],["nzCheckable","","nzMultiple","",3,"nzData","nzExpandAll","nzCheckStrictly","nzSearchValue","nzCheckBoxChange","nzClick","nzSearchValueChange"],["type","text","nz-input","","placeholder","T\xecm ki\u1ebfm \u0111\u01a1n v\u1ecb",3,"ngModel","ngModelChange"],["nz-icon","","nzType","search"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,n){if(1&e&&(m.Ub(0,"nz-modal",0),m.bc("nzVisibleChange",(function(e){return n.isVisibleModalPermission=e}))("nzOnCancel",(function(){return n.handleCancel()})),m.Lc(1,De,1,1,"ng-template",null,1,m.Mc),m.Lc(3,xe,44,35,"ng-template",null,2,m.Mc),m.Lc(5,Ve,2,2,"ng-template",null,3,m.Mc),m.Tb()),2&e){var t=m.xc(2),i=m.xc(4),r=m.xc(6);m.nc("nzVisible",n.isVisibleModalPermission)("nzTitle",t)("nzContent",i)("nzFooter",r)}},directives:[A.a,U.c,U.a,R.a,C.a,O.c,O.d,O.b,f.d,f.o,f.r,L.a,u.o,w.a,V.a],pipes:[P.c],styles:[""]}),Pe);function Be(e,n){if(1&e&&m.Nc(0),2&e){var t=m.fc();m.Pc(" ",t.tittle," ")}}function Ge(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Oc(m.hc(2,1,"function.role.modal-item.code.message.maxlength")))}function qe(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Oc(m.hc(2,1,"function.role.modal-item.code.message.minlength")))}function Xe(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Oc(m.hc(2,1,"function.role.modal-item.code.message.required")))}function je(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Oc(m.hc(2,1,"function.role.modal-item.code.message.pattern")))}function Ke(e,n){if(1&e&&(m.Lc(0,Ge,3,3,"ng-container",21),m.Lc(1,qe,3,3,"ng-container",21),m.Lc(2,Xe,3,3,"ng-container",21),m.Lc(3,je,3,3,"ng-container",21)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("maxlength")),m.Ab(1),m.nc("ngIf",t.hasError("minlength")),m.Ab(1),m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function He(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Oc(m.hc(2,1,"function.role.modal-item.name.message.maxlength")))}function $e(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Oc(m.hc(2,1,"function.role.modal-item.name.message.minlength")))}function _e(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Oc(m.hc(2,1,"function.role.modal-item.name.message.required")))}function We(e,n){1&e&&(m.Sb(0),m.Nc(1),m.gc(2,"translate"),m.Rb()),2&e&&(m.Ab(1),m.Oc(m.hc(2,1,"function.role.modal-item.name.message.pattern")))}function Je(e,n){if(1&e&&(m.Lc(0,He,3,3,"ng-container",21),m.Lc(1,$e,3,3,"ng-container",21),m.Lc(2,_e,3,3,"ng-container",21),m.Lc(3,We,3,3,"ng-container",21)),2&e){var t=n.$implicit;m.nc("ngIf",t.hasError("maxlength")),m.Ab(1),m.nc("ngIf",t.hasError("minlength")),m.Ab(1),m.nc("ngIf",t.hasError("required")),m.Ab(1),m.nc("ngIf",t.hasError("pattern"))}}function Qe(e,n){if(1&e){var t=m.Vb();m.Ub(0,"form",4),m.bc("ngSubmit",(function(){return m.Ac(t),m.fc().save()})),m.Ub(1,"nz-form-item"),m.Ub(2,"nz-form-label",5),m.Nc(3),m.gc(4,"translate"),m.Tb(),m.Ub(5,"nz-form-control",6),m.Pb(6,"input",7),m.gc(7,"translate"),m.Lc(8,Ke,4,4,"ng-template",null,8,m.Mc),m.Tb(),m.Tb(),m.Ub(10,"nz-form-item"),m.Ub(11,"nz-form-label",9),m.Nc(12),m.gc(13,"translate"),m.Tb(),m.Ub(14,"nz-form-control",6),m.Pb(15,"input",10),m.gc(16,"translate"),m.Lc(17,Je,4,4,"ng-template",null,11,m.Mc),m.Tb(),m.Tb(),m.Ub(19,"nz-form-item",12),m.Ub(20,"nz-form-label",13),m.Nc(21),m.gc(22,"translate"),m.Tb(),m.Ub(23,"nz-form-control",14),m.Pb(24,"nz-switch",15),m.Ub(25,"label"),m.Ub(26,"nz-tag",16),m.Nc(27),m.gc(28,"translate"),m.Tb(),m.Ub(29,"nz-tag",16),m.Nc(30),m.gc(31,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Ub(32,"nz-form-item",17),m.Ub(33,"nz-form-label",18),m.Nc(34),m.gc(35,"translate"),m.Tb(),m.Ub(36,"nz-form-control",19),m.Pb(37,"textarea",20),m.gc(38,"translate"),m.Tb(),m.Tb(),m.Tb()}if(2&e){var i=m.xc(9),r=m.xc(18),a=m.fc();m.nc("formGroup",a.form),m.Ab(2),m.nc("nzSm",7)("nzXs",24),m.Ab(1),m.Oc(m.hc(4,31,"function.role.modal-item.code.label")),m.Ab(2),m.nc("nzSm",16)("nzXs",24)("nzErrorTip",i),m.Ab(1),m.oc("placeholder",m.hc(7,33,"function.role.modal-item.code.placeholder")),m.Ab(5),m.nc("nzSm",7)("nzXs",24),m.Ab(1),m.Oc(m.hc(13,35,"function.role.modal-item.name.label")),m.Ab(2),m.nc("nzSm",16)("nzXs",24)("nzErrorTip",r),m.Ab(1),m.oc("placeholder",m.hc(16,37,"function.role.modal-item.name.placeholder")),m.Ab(5),m.nc("nzSm",7)("nzXs",24),m.Ab(1),m.Oc(m.hc(22,39,"function.role.modal-item.status.label")),m.Ab(2),m.nc("nzSpan",16),m.Ab(3),m.nc("nzColor","#00BB00")("hidden",!a.form.value.status),m.Ab(1),m.Oc(m.hc(28,41,"function.role.modal-item.status-true.label")),m.Ab(2),m.nc("nzColor","#EF5350")("hidden",a.form.value.status),m.Ab(1),m.Oc(m.hc(31,43,"function.role.modal-item.status-false.label")),m.Ab(3),m.nc("nzSm",7)("nzXs",24),m.Ab(1),m.Pc(" ",m.hc(35,45,"function.role.modal-item.description.label")," "),m.Ab(2),m.nc("nzSm",16)("nzXs",24),m.Ab(1),m.oc("placeholder",m.hc(38,47,"function.role.modal-item.description.placeholder"))}}function Ye(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",25),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnEdit.click(e)})),m.Pb(1,"i",26),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc("",i.btnEdit.titlei18n," ")}}function Ze(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",27),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnSave.click(e)})),m.Pb(1,"i",28),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.nc("nzLoading",i.isLoading)("disabled",i.form.invalid),m.Ab(2),m.Pc(" ",i.btnSave.titlei18n," ")}}function en(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",29),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnCancel.click(e)})),m.Pb(1,"i",30),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc(" ",i.btnCancel.titlei18n," ")}}function nn(e,n){if(1&e&&(m.Lc(0,Ye,3,1,"button",22),m.Lc(1,Ze,3,3,"button",23),m.Lc(2,en,3,1,"button",24)),2&e){var t=m.fc();m.nc("ngIf",t.isInfo&&t.btnEdit.visible&&t.btnEdit.grandAccess),m.Ab(1),m.nc("ngIf",!t.isInfo&&t.btnSave.visible&&t.btnSave.grandAccess),m.Ab(1),m.nc("ngIf",t.btnCancel.visible&&t.btnCancel.grandAccess)}}var tn,rn=((tn=function(){function e(n,t,i,a,c){var o=this;r(this,e),this.fb=n,this.messageService=t,this.roleApiService=i,this.aclService=a,this.i18n=c,this.isVisible=!1,this.eventEmmit=new m.n,this.type="add",this.tittle="",this.isReloadGrid=!1,this.isLoading=!1,this.regexCode=b.t,this.regexName=b.v,this.isInfo=!1,this.isEdit=!1,this.isAdd=!1,this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){o.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){o.handleCancel()}},this.btnEdit={title:"C\u1eadp nh\u1eadt",titlei18n:""+this.i18n.fanyi("layout.button.btn-edit.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){o.updateFormToEdit()}},this.form=this.fb.group({code:[{value:null},[f.w.required,f.w.pattern(b.t)]],name:[null,[f.w.required,f.w.pattern(b.v)]],order:[null],status:[{value:!0}],description:[null]})}return c(e,[{key:"ngOnInit",value:function(){this.initRightOfUser()}},{key:"initRightOfUser",value:function(){this.btnEdit.grandAccess=this.aclService.canAbility("ROLE-EDIT"),this.btnSave.grandAccess=this.aclService.canAbility("ROLE-ADD")||this.aclService.canAbility("ROLE-EDIT")}},{key:"handleCancel",value:function(){this.isVisible=!1,this.eventEmmit.emit(this.isReloadGrid?{type:"success"}:{type:"close"})}},{key:"initData",value:function(e){var n,t,i,r,a,c,o,l,s,u,d,b,h,f,m,g,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.isLoading=!1,this.isReloadGrid=!1,this.item=e,this.type=p,this.option=v,this.updateFormType(p),this.isAdd&&(null===(n=this.form.get("code"))||void 0===n||n.enable(),null===(t=this.form.get("name"))||void 0===t||t.enable(),null===(i=this.form.get("status"))||void 0===i||i.enable(),null===(r=this.form.get("description"))||void 0===r||r.enable(),this.resetForm(),this.tittle=""+this.i18n.fanyi("function.role.modal-item.header-add")),this.isEdit&&(null===(a=this.form.get("code"))||void 0===a||a.disable(),null===(c=this.form.get("name"))||void 0===c||c.enable(),null===(o=this.form.get("status"))||void 0===o||o.enable(),null===(l=this.form.get("description"))||void 0===l||l.enable(),null===(s=this.form.get("status"))||void 0===s||s.setValue(null==e?void 0:e.status),this.tittle="".concat(this.i18n.fanyi("function.role.modal-item.header-edit"),": ").concat(e.code)),this.isInfo&&(null===(u=this.form.get("code"))||void 0===u||u.disable(),null===(d=this.form.get("name"))||void 0===d||d.disable(),null===(b=this.form.get("description"))||void 0===b||b.disable(),null===(h=this.form.get("status"))||void 0===h||h.setValue(null==e?void 0:e.status),this.tittle="".concat(this.i18n.fanyi("function.role.modal-item.header-info"),": ").concat(e.code)),null===(f=this.form.get("code"))||void 0===f||f.setValue(null==e?void 0:e.code),null===(m=this.form.get("name"))||void 0===m||m.setValue(null==e?void 0:e.name),null===(g=this.form.get("description"))||void 0===g||g.setValue(null==e?void 0:e.description)}},{key:"updateFormType",value:function(e){switch(e){case"add":this.isInfo=!1,this.isEdit=!1,this.isAdd=!0;break;case"info":this.isInfo=!0,this.isEdit=!1,this.isAdd=!1;break;case"edit":this.isInfo=!1,this.isEdit=!0,this.isAdd=!1;break;default:this.isInfo=!1,this.isEdit=!1,this.isAdd=!0}}},{key:"resetForm",value:function(){var e,n,t,i;this.form.reset(),null===(e=this.form.get("status"))||void 0===e||e.setValue(!0),null===(n=this.form.get("order"))||void 0===n||n.setValue(0),null===(t=this.form.get("code"))||void 0===t||t.setValue(""),null===(i=this.form.get("name"))||void 0===i||i.setValue("")}},{key:"save",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var t in this.isLoading=!0,Object(b.B)(this.form),this.form.controls)this.form.controls[t].markAsDirty(),this.form.controls[t].updateValueAndValidity();if(!this.form.valid)return this.isLoading=!1,void this.messageService.error(""+this.i18n.fanyi("function.role.modal-item.error.message.form-invalid"));var i={id:this.item.id,name:this.form.controls.name.value,code:this.form.controls.code.value.toUpperCase(),status:this.form.controls.status.value,description:this.form.controls.description.value};return null==i.name||""===i.name?(this.isLoading=!1,void this.messageService.error(""+this.i18n.fanyi("function.role.modal-item.error.message.name"))):this.isAdd?this.roleApiService.create(i).subscribe((function(t){e.isLoading=!1,200===t.code&&null!=t.data?(e.messageService.success(""+t.message),e.isReloadGrid=!0,n?e.resetForm():e.closeModalReloadData()):e.messageService.error(""+t.message)}),(function(n){e.isLoading=!1,e.messageService.error(n.error?""+n.error.message:""+n.status)})):this.isEdit?this.roleApiService.update(i).subscribe((function(n){e.isLoading=!1,200===n.code&&null!=n.data?(e.messageService.success(""+n.message),e.closeModalReloadData()):e.messageService.error(""+n.message)}),(function(n){e.isLoading=!1,e.messageService.error(n.error?""+n.error.message:""+n.status)})):void 0}},{key:"updateFormToEdit",value:function(){var e,n,t,i;this.updateFormType("edit"),null===(e=this.form.get("name"))||void 0===e||e.enable(),null===(n=this.form.get("order"))||void 0===n||n.enable(),null===(t=this.form.get("status"))||void 0===t||t.enable(),null===(i=this.form.get("description"))||void 0===i||i.enable()}},{key:"closeModalReloadData",value:function(){this.resetForm(),this.isVisible=!1,this.eventEmmit.emit({type:"success"})}}]),e}()).\u0275fac=function(e){return new(e||tn)(m.Ob(f.e),m.Ob(T.e),m.Ob(v.a),m.Ob(g.a),m.Ob(d.a))},tn.\u0275cmp=m.Ib({type:tn,selectors:[["app-role-item"]],inputs:{isVisible:"isVisible",type:"type",item:"item",option:"option"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","700px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","code",3,"nzSm","nzXs"],["nzHasFeedback","",3,"nzSm","nzXs","nzErrorTip"],["nz-input","","minlength","1","maxlength","70","required","","formControlName","code","id","code",2,"text-transform","uppercase",3,"placeholder"],["validateCode",""],["nzRequired","","nzFor","name",3,"nzSm","nzXs"],["nz-input","","minlength","1","maxlength","256","required","","formControlName","name","id","name",3,"placeholder"],["validateName",""],["nz-row",""],["nzFor","status",3,"nzSm","nzXs"],[3,"nzSpan"],["formControlName","status","nzSize","small",2,"margin-right","5px"],[3,"nzColor","hidden"],[2,"margin-bottom","0"],["nzFor","description",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["rows","3","nz-input","","id","description","formControlName","description",3,"placeholder"],[4,"ngIf"],["nz-button","","nzType","primary","class","btn-secondary",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-secondary",3,"click"],["nz-icon","","nzType","edit","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","disabled","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,n){if(1&e&&(m.Ub(0,"nz-modal",0),m.bc("nzVisibleChange",(function(e){return n.isVisible=e}))("nzOnCancel",(function(){return n.handleCancel()})),m.Lc(1,Be,1,1,"ng-template",null,1,m.Mc),m.Lc(3,Qe,39,49,"ng-template",null,2,m.Mc),m.Lc(5,nn,3,3,"ng-template",null,3,m.Mc),m.Tb()),2&e){var t=m.xc(2),i=m.xc(4),r=m.xc(6);m.nc("nzVisible",n.isVisible)("nzTitle",t)("nzContent",i)("nzFooter",r)}},directives:[A.a,f.x,f.p,D.b,f.h,U.c,D.c,U.a,D.d,D.a,O.b,f.d,f.k,f.j,f.v,f.o,f.g,x.a,N.a,u.o,w.a,V.a,C.a,L.a],pipes:[P.c],styles:[""]}),tn);function an(e,n){if(1&e&&m.Nc(0),2&e){var t=m.fc();m.Pc(" ",t.tittle," ")}}function cn(e,n){1&e&&m.Pb(0,"i",10)}function on(e,n){if(1&e){var t=m.Vb();m.Ub(0,"nz-row"),m.Ub(1,"nz-col",4),m.Ub(2,"fieldset",5),m.Ub(3,"legend"),m.Nc(4),m.gc(5,"translate"),m.Tb(),m.Ub(6,"nz-input-group",6),m.Ub(7,"input",7),m.bc("ngModelChange",(function(e){return m.Ac(t),m.fc().searchMenuValue=e})),m.gc(8,"translate"),m.Tb(),m.Tb(),m.Lc(9,cn,1,0,"ng-template",null,8,m.Mc),m.Ub(11,"nz-tree",9),m.bc("nzCheckBoxChange",(function(e){return m.Ac(t),m.fc().nzEventMenuChange(e)})),m.Tb(),m.Tb(),m.Tb(),m.Tb()}if(2&e){var i=m.xc(10),r=m.fc();m.Ab(1),m.nc("nzSm",24)("nzXs",24),m.Ab(3),m.Oc(m.hc(5,10,"function.role.modal-menu.header")),m.Ab(2),m.nc("nzSuffix",i),m.Ab(1),m.oc("placeholder",m.hc(8,12,"function.role.modal-menu.search.label")),m.nc("ngModel",r.searchMenuValue),m.Ab(4),m.nc("nzData",r.treeMenuData)("nzSearchValue",r.searchMenuValue)("nzExpandAll",r.expandAll)("nzCheckStrictly",!0)}}function ln(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",13),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnSave.click(e)})),m.Pb(1,"i",14),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.nc("nzLoading",i.isLoading),m.Ab(2),m.Pc(" ",i.btnSave.titlei18n," ")}}function sn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",15),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnCancel.click(e)})),m.Pb(1,"i",16),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc(" ",i.btnCancel.titlei18n," ")}}function un(e,n){if(1&e&&(m.Lc(0,ln,3,2,"button",11),m.Lc(1,sn,3,1,"button",12)),2&e){var t=m.fc();m.nc("ngIf",t.btnSave.visible&&t.btnSave.grandAccess),m.Ab(1),m.nc("ngIf",t.btnCancel.visible&&t.btnCancel.grandAccess)}}var dn,bn=((dn=function(){function e(n,t,i,a){var c=this;r(this,e),this.messageService=n,this.roleApiService=t,this.arrayService=i,this.i18n=a,this.isVisibleModalMenu=!1,this.eventEmmit=new m.n,this.tittle="",this.isLoading=!1,this.listMenu=[],this.treeMenuData=[],this.menuIdSelected=[],this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){c.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){c.handleCancel()}}}return c(e,[{key:"ngOnInit",value:function(){}},{key:"handleCancel",value:function(){this.isVisibleModalMenu=!1,this.eventEmmit.emit({type:"close"})}},{key:"initData",value:function(e,n){this.listMenu=n,this.isVisibleModalMenu=!0,this.roleId=e.id,this.tittle="".concat(this.i18n.fanyi("function.role.modal-navigation.header"),": ").concat(e.code),this.getMenuByRole()}},{key:"initMenuTree",value:function(){var e=this,n=this.listMenu.map((function(n,t,i){var r=i.some((function(e){return e.parentId===n.id})),a=e.menuIdSelected.some((function(e){return e===n.id}));return{id:n.id,parent_id:n.parentId,title:n.name,isLeaf:!r,expanded:!0,selected:!1,checked:a}}));this.treeMenuData=this.arrayService.arrToTreeNode(n,{cb:function(e,n,t){e.selected=0===e.id}})}},{key:"getMenuByRole",value:function(){var e=this;this.roleApiService.getListMenuIdByRole({roleId:this.roleId}).subscribe((function(n){n.data&&(e.menuIdSelected=n.data.navigationIds),e.initMenuTree()}),(function(n){e.initMenuTree(),console.log(n)}))}},{key:"save",value:function(){var e=this,n={roleId:this.roleId,navigationIds:this.menuIdSelected.filter((function(e,n,t){return t.indexOf(e)===n}))};this.roleApiService.updateMenuByRole(n).subscribe((function(n){200===n.code&&null!=n.data?(e.messageService.success(""+n.message),e.isVisibleModalMenu=!1):e.messageService.error(""+n.message)}),(function(n){e.messageService.error(n.error?""+n.error.message:""+n.status)}))}},{key:"nzEventMenuChange",value:function(e){this.menuIdSelected=e.checkedKeys&&e.checkedKeys.length>0?this.menuIdSelected.concat(e.checkedKeys.map((function(e){return e.origin.id}))).filter((function(e,n,t){return t.indexOf(e)===n})):this.menuIdSelected.filter((function(n){var t;return n!==(null===(t=e.node)||void 0===t?void 0:t.key)}))}}]),e}()).\u0275fac=function(e){return new(e||dn)(m.Ob(T.e),m.Ob(v.a),m.Ob(y.c),m.Ob(d.a))},dn.\u0275cmp=m.Ib({type:dn,selectors:[["app-role-menu"]],inputs:{isVisibleModalMenu:"isVisibleModalMenu"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","600px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[2,"padding","10px",3,"nzSm","nzXs"],[2,"height","60vh","overflow-y","scroll"],[3,"nzSuffix"],["type","text","nz-input","",3,"placeholder","ngModel","ngModelChange"],["suffixIcon",""],["nzCheckable","","nzMultiple","",2,"margin-top","10px",3,"nzData","nzSearchValue","nzExpandAll","nzCheckStrictly","nzCheckBoxChange"],["nz-icon","","nzType","search"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,n){if(1&e&&(m.Ub(0,"nz-modal",0),m.bc("nzVisibleChange",(function(e){return n.isVisibleModalMenu=e}))("nzOnCancel",(function(){return n.handleCancel()})),m.Lc(1,an,1,1,"ng-template",null,1,m.Mc),m.Lc(3,on,12,14,"ng-template",null,2,m.Mc),m.Lc(5,un,2,2,"ng-template",null,3,m.Mc),m.Tb()),2&e){var t=m.xc(2),i=m.xc(4),r=m.xc(6);m.nc("nzVisible",n.isVisibleModalMenu)("nzTitle",t)("nzContent",i)("nzFooter",r)}},directives:[A.a,U.c,U.a,C.a,O.c,O.d,O.b,f.d,f.o,f.r,R.a,L.a,u.o,w.a,V.a],pipes:[P.c],styles:[""]}),dn);function hn(e,n){if(1&e&&m.Nc(0),2&e){var t=m.fc();m.Pc(" ",t.tittle," ")}}function fn(e,n){1&e&&m.Pb(0,"i",10)}function mn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"nz-row"),m.Ub(1,"nz-col",4),m.Ub(2,"fieldset",5),m.Ub(3,"legend"),m.Nc(4),m.gc(5,"translate"),m.Tb(),m.Ub(6,"nz-input-group",6),m.Ub(7,"input",7),m.bc("ngModelChange",(function(e){return m.Ac(t),m.fc().searchRightValue=e})),m.gc(8,"translate"),m.Tb(),m.Tb(),m.Lc(9,fn,1,0,"ng-template",null,8,m.Mc),m.Ub(11,"nz-tree",9),m.bc("nzCheckBoxChange",(function(e){return m.Ac(t),m.fc().nzEventRightChange(e)})),m.Tb(),m.Tb(),m.Tb(),m.Tb()}if(2&e){var i=m.xc(10),r=m.fc();m.Ab(1),m.nc("nzSm",24)("nzXs",24),m.Ab(3),m.Oc(m.hc(5,9,"function.role.modal-right.header")),m.Ab(2),m.nc("nzSuffix",i),m.Ab(1),m.oc("placeholder",m.hc(8,11,"function.role.modal-right.search.label")),m.nc("ngModel",r.searchRightValue),m.Ab(4),m.nc("nzData",r.treeRightData)("nzSearchValue",r.searchRightValue)("nzExpandAll",r.expandAll)}}function gn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",13),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnSave.click(e)})),m.Pb(1,"i",14),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.nc("nzLoading",i.isLoading),m.Ab(2),m.Pc(" ",i.btnSave.titlei18n," ")}}function pn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",15),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnCancel.click(e)})),m.Pb(1,"i",16),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc(" ",i.btnCancel.titlei18n," ")}}function vn(e,n){if(1&e&&(m.Lc(0,gn,3,2,"button",11),m.Lc(1,pn,3,1,"button",12)),2&e){var t=m.fc();m.nc("ngIf",t.btnSave.visible&&t.btnSave.grandAccess),m.Ab(1),m.nc("ngIf",t.btnCancel.visible&&t.btnCancel.grandAccess)}}var zn,yn=((zn=function(){function e(n,t,i,a,c){var o=this;r(this,e),this.messageService=n,this.roleApiService=t,this.arrayService=i,this.com=a,this.i18n=c,this.isVisibleModalRight=!1,this.eventEmmit=new m.n,this.tittle="",this.isLoading=!1,this.listRight=[],this.treeRightData=[],this.rightIdSelected=[],this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){o.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){o.handleCancel()}}}return c(e,[{key:"ngOnInit",value:function(){}},{key:"handleCancel",value:function(){this.isVisibleModalRight=!1,this.eventEmmit.emit({type:"close"})}},{key:"initData",value:function(e,n){this.listRight=n,this.isVisibleModalRight=!0,this.roleId=e.id,this.tittle="".concat(this.i18n.fanyi("function.role.modal-right.header"),": ").concat(e.code),this.getRightByRole()}},{key:"initRightTree",value:function(){var e,t=this,i=[],r=n(this.listRight.map((function(e){return e.groupName})).filter((function(e,n,t){return t.indexOf(e)===n})));try{for(r.s();!(e=r.n()).done;){var a=e.value;i.push({groupName:null,name:a,code:a,id:a})}}catch(o){r.e(o)}finally{r.f()}var c=this.listRight.concat(i).map((function(e,n,i){var r=i.some((function(n){return n.groupName===e.id})),a=t.rightIdSelected.some((function(n){return n===e.id}));return{id:e.id,parent_id:e.groupName,title:e.name,isLeaf:!r,expanded:!0,selected:!1,checked:a,disabled:r,disableCheckbox:r}}));this.treeRightData=this.arrayService.arrToTreeNode(c,{cb:function(e,n,t){e.selected=0===e.id}})}},{key:"getRightByRole",value:function(){var e=this;this.roleApiService.getListRightIdByRole({roleId:this.roleId}).subscribe((function(n){n.data&&(e.rightIdSelected=n.data.rightIds),e.initRightTree()}),(function(n){e.initRightTree(),console.log(n)}))}},{key:"save",value:function(){var e=this,n={roleId:this.roleId,rightIds:this.rightIdSelected.filter((function(e,n,t){return t.indexOf(e)===n}))};this.roleApiService.updateRightByRole(n).subscribe((function(n){200===n.code&&null!=n.data?(e.messageService.success(""+n.message),e.isVisibleModalRight=!1):e.messageService.error(""+n.message)}),(function(n){e.messageService.error(n.error?""+n.error.message:""+n.status)})),this.com.changeMessage("RightChanged")}},{key:"nzEventRightChange",value:function(e){this.rightIdSelected=e.checkedKeys&&e.checkedKeys.length>0?this.rightIdSelected.concat(e.checkedKeys.map((function(e){return e.origin.id}))).filter((function(e,n,t){return t.indexOf(e)===n})):this.rightIdSelected.filter((function(n){var t;return n!==(null===(t=e.node)||void 0===t?void 0:t.key)}))}}]),e}()).\u0275fac=function(e){return new(e||zn)(m.Ob(T.e),m.Ob(v.a),m.Ob(y.c),m.Ob(z.c),m.Ob(d.a))},zn.\u0275cmp=m.Ib({type:zn,selectors:[["app-role-right"]],inputs:{isVisibleModalRight:"isVisibleModalRight"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","600px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[2,"padding","10px",3,"nzSm","nzXs"],[2,"height","60vh","overflow-y","scroll"],[3,"nzSuffix"],["type","text","nz-input","",3,"placeholder","ngModel","ngModelChange"],["suffixIcon",""],["nzCheckable","","nzMultiple","",2,"margin-top","10px",3,"nzData","nzSearchValue","nzExpandAll","nzCheckBoxChange"],["nz-icon","","nzType","search"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,n){if(1&e&&(m.Ub(0,"nz-modal",0),m.bc("nzVisibleChange",(function(e){return n.isVisibleModalRight=e}))("nzOnCancel",(function(){return n.handleCancel()})),m.Lc(1,hn,1,1,"ng-template",null,1,m.Mc),m.Lc(3,mn,12,13,"ng-template",null,2,m.Mc),m.Lc(5,vn,2,2,"ng-template",null,3,m.Mc),m.Tb()),2&e){var t=m.xc(2),i=m.xc(4),r=m.xc(6);m.nc("nzVisible",n.isVisibleModalRight)("nzTitle",t)("nzContent",i)("nzFooter",r)}},directives:[A.a,U.c,U.a,C.a,O.c,O.d,O.b,f.d,f.o,f.r,R.a,L.a,u.o,w.a,V.a],pipes:[P.c],styles:[""]}),zn),Tn=a("GuFl"),An=a("rMZv");function Sn(e,n){if(1&e&&m.Nc(0),2&e){var t=m.fc();m.Pc(" ",t.tittle," ")}}function kn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"tr",12),m.bc("click",(function(){m.Ac(t);var e=n.$implicit;return(0,m.fc().onItemSelect)(e)})),m.Ub(1,"td",13),m.bc("nzCheckedChange",(function(){m.Ac(t);var e=n.$implicit;return(0,m.fc().onItemSelect)(e)})),m.Tb(),m.Ub(2,"td"),m.Nc(3),m.Tb(),m.Ub(4,"td"),m.Nc(5),m.Tb(),m.Tb()}if(2&e){var i=n.$implicit;m.Ab(1),m.nc("nzChecked",!!i.checked),m.Ab(2),m.Oc(i.name),m.Ab(2),m.Oc(i.code)}}function Un(e,n){if(1&e){var t=m.Vb();m.Ub(0,"nz-table",8,9),m.Ub(2,"thead"),m.Ub(3,"tr"),m.Ub(4,"th",10),m.bc("nzCheckedChange",(function(e){return m.Ac(t),(0,n.onItemSelectAll)(e)})),m.Tb(),m.Ub(5,"th"),m.Nc(6),m.gc(7,"translate"),m.Tb(),m.Ub(8,"th"),m.Nc(9),m.gc(10,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Ub(11,"tbody"),m.Lc(12,kn,6,3,"tr",11),m.Tb(),m.Tb()}if(2&e){var i=n.$implicit,r=n.stat,a=m.xc(1),c=m.fc(2);m.nc("nzData",c.$asTransferItems(i)),m.Ab(4),m.nc("nzChecked",r.checkAll)("nzIndeterminate",r.checkHalf),m.Ab(2),m.Oc(m.hc(7,6,"function.role.modal-user-role.table.header.name")),m.Ab(3),m.Oc(m.hc(10,8,"function.role.modal-user-role.table.header.code")),m.Ab(3),m.nc("ngForOf",a.data)}}var In=function(e,n){return[e,n]};function Cn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"nz-form-item"),m.Ub(1,"nz-form-label",4),m.Nc(2),m.gc(3,"translate"),m.Tb(),m.Ub(4,"nz-form-control",4),m.Ub(5,"nz-tree-select",5),m.bc("ngModelChange",(function(e){return m.Ac(t),m.fc().orgSelected=e}))("ngModelChange",(function(e){return m.Ac(t),m.fc().onChangeOrg(e)})),m.gc(6,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Ub(7,"nz-transfer",6),m.bc("nzSelectChange",(function(e){return m.Ac(t),m.fc().selectUser(e)}))("nzChange",(function(e){return m.Ac(t),m.fc().changeUser(e)}))("nzSearchChange",(function(e){return m.Ac(t),m.fc().searchUser(e)})),m.Lc(8,Un,13,10,"ng-template",null,7,m.Mc),m.Tb()}if(2&e){var i=m.xc(9),r=m.fc();m.Ab(1),m.nc("nzSm",4)("nzXs",24),m.Ab(1),m.Pc(" ",m.hc(3,13,"function.role.modal-user-role.organization.label"),""),m.Ab(2),m.nc("nzSm",8)("nzXs",24),m.Ab(1),m.oc("nzPlaceHolder",m.hc(6,15,"function.role.modal-user-role.organization.placeholder")),m.nc("nzNodes",r.listOrgTree)("ngModel",r.orgSelected),m.Ab(2),m.nc("nzDataSource",r.listUserTransfer)("nzShowSearch",!0)("nzShowSelectAll",!1)("nzRenderList",m.tc(17,In,i,i))("nzFilterOption",r.filterUserOption)}}function Ln(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",16),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnSave.click(e)})),m.Pb(1,"i",17),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.nc("nzLoading",i.isLoading),m.Ab(2),m.Pc(" ",i.btnSave.titlei18n," ")}}function On(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",18),m.bc("click",(function(e){return m.Ac(t),m.fc(2).btnCancel.click(e)})),m.Pb(1,"i",19),m.Nc(2),m.Tb()}if(2&e){var i=m.fc(2);m.Ab(2),m.Pc(" ",i.btnCancel.titlei18n," ")}}function Rn(e,n){if(1&e&&(m.Lc(0,Ln,3,2,"button",14),m.Lc(1,On,3,1,"button",15)),2&e){var t=m.fc();m.nc("ngIf",t.btnSave.visible&&t.btnSave.grandAccess),m.Ab(1),m.nc("ngIf",t.btnCancel.visible&&t.btnCancel.grandAccess)}}var Dn,En=((Dn=function(){function e(n,t,i,a,c,o){var l=this;r(this,e),this.fb=n,this.messageService=t,this.roleApiService=i,this.arrayService=a,this.userService=c,this.i18n=o,this.isVisibleRoleUser=!1,this.eventEmmit=new m.n,this.type="add",this.tittle="",this.isReloadGrid=!1,this.isLoading=!1,this.regexCode=b.t,this.regexName=b.v,this.isInfo=!1,this.isEdit=!1,this.isAdd=!1,this.listUser=[],this.listOrg=[],this.listOrgTree=[],this.listUserTransfer=[],this.listUserTemp=[],this.listUserTransferTemp=[],this.listUserSelected=[],this.$asTransferItems=function(e){return e},this.btnSave={title:"L\u01b0u",titlei18n:""+this.i18n.fanyi("layout.button.btn-save.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){l.save()}},this.btnCancel={title:"\u0110\xf3ng",titlei18n:""+this.i18n.fanyi("layout.button.btn-cancel.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){l.handleCancel()}}}return c(e,[{key:"ngOnInit",value:function(){}},{key:"handleCancel",value:function(){this.isVisibleRoleUser=!1,this.eventEmmit.emit(this.isReloadGrid?{type:"success"}:{type:"close"})}},{key:"initData",value:function(e,n,t){this.listUserSelected=[],this.listUser=n,this.listUserTemp=n,this.listOrg=t,this.isVisibleRoleUser=!0,this.item=e,this.tittle="".concat(this.i18n.fanyi("function.role.modal-user-role.header"),": ").concat(e.code),this.initTreeData(),this.getListUserIdByRoleId()}},{key:"initTreeData",value:function(){var e=this.listOrg.map((function(e,n,t){var i=t.some((function(n){return n.parentId===e.id}));return{id:e.id,parent_id:e.parentId,title:e.name,isLeaf:!i,expanded:!1,selected:!1}}));this.listOrgTree=this.arrayService.arrToTreeNode(e,{cb:function(e,n,t){e.selected=0===e.id}})}},{key:"initTransferData",value:function(){var e=this;this.listUserTransfer=[];for(var n=function(n){var t=e.listUser[n];e.listUserTransfer.push({key:n.toString(),id:t.id,title:t.name,name:t.name,code:t.code,organizationId:t.organizationId,checked:!1,direction:e.listUserSelected.some((function(e){return e===t.id}))?"right":"left"})},t=0;t<this.listUser.length;t++)n(t);this.listUserTransferTemp=this.listUserTransfer}},{key:"getListUserIdByRoleId",value:function(){var e=this;this.userService.getListUserIdByRole({roleId:this.item.id}).subscribe((function(n){n.data&&n.data.listUserId&&(e.listUserSelected=n.data.listUserId),e.initTransferData()}),(function(n){e.initTransferData()}))}},{key:"save",value:function(){var e=this;this.userService.saveListUserRole({roleId:this.item.id,userIds:this.listUserSelected}).subscribe((function(n){200===n.code&&null!=n.data?(e.isVisibleRoleUser=!1,e.messageService.success(""+n.message)):e.messageService.error(""+n.message)}),(function(n){e.messageService.error(n.error?""+n.error.message:""+n.status)}))}},{key:"onChangeOrg",value:function(e){var n=this;this.orgSelected=e,this.orgSelected?(this.listUser=this.listUserTemp.filter((function(e){return e.organizationId===n.orgSelected})),this.listUserTransfer=this.listUserTransferTemp.filter((function(e){return e.organizationId===n.orgSelected}))):(this.listUser=this.listUserTemp,this.listUserTransfer=this.listUserTransferTemp)}},{key:"selectUser",value:function(e){}},{key:"changeUser",value:function(e){"left"===e.to?this.listUserSelected=this.listUserSelected.filter((function(n){return!e.list.map((function(e){return e.id})).includes(n)})):"right"===e.to&&(this.listUserSelected=this.listUserSelected.concat(e.list.map((function(e){return e.id}))));var n=e.list.map((function(e){return e.key}));this.listUserTransfer=this.listUserTransfer.map((function(t){return n.includes(t.key)&&function(e){return e.hasOwnProperty("key")}(t)&&("left"===e.to?delete t.hide:"right"===e.to&&(t.hide=!1)),t}))}},{key:"searchUser",value:function(e){}},{key:"filterUserOption",value:function(e,n){return n.name.indexOf(e)>-1||n.code.indexOf(e)>-1}}]),e}()).\u0275fac=function(e){return new(e||Dn)(m.Ob(f.e),m.Ob(T.e),m.Ob(v.a),m.Ob(y.c),m.Ob(z.u),m.Ob(d.a))},Dn.\u0275cmp=m.Ib({type:Dn,selectors:[["app-role-user"]],inputs:{isVisibleRoleUser:"isVisibleRoleUser",type:"type",item:"item",option:"option"},outputs:{eventEmmit:"eventEmmit"},decls:7,vars:4,consts:[["nzMaskClosable","false","nzWidth","1200px",3,"nzVisible","nzTitle","nzContent","nzFooter","nzVisibleChange","nzOnCancel"],["modalTitle",""],["modalContent",""],["modalFooter",""],[3,"nzSm","nzXs"],["nzShowSearch","","nzShowLine","",3,"nzNodes","nzPlaceHolder","ngModel","ngModelChange"],[3,"nzDataSource","nzShowSearch","nzShowSelectAll","nzRenderList","nzFilterOption","nzSelectChange","nzChange","nzSearchChange"],["renderList",""],["nzSize","small",3,"nzData"],["t",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"nzChecked","nzCheckedChange"],["nz-button","","nzType","primary","class","btn-primary",3,"nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-warning",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"btn-primary",3,"nzLoading","click"],["nz-icon","","nzType","save","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-warning",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","fill"]],template:function(e,n){if(1&e&&(m.Ub(0,"nz-modal",0),m.bc("nzVisibleChange",(function(e){return n.isVisibleRoleUser=e}))("nzOnCancel",(function(){return n.handleCancel()})),m.Lc(1,Sn,1,1,"ng-template",null,1,m.Mc),m.Lc(3,Cn,10,20,"ng-template",null,2,m.Mc),m.Lc(5,Rn,2,2,"ng-template",null,3,m.Mc),m.Tb()),2&e){var t=m.xc(2),i=m.xc(4),r=m.xc(6);m.nc("nzVisible",n.isVisibleRoleUser)("nzTitle",t)("nzContent",i)("nzFooter",r)}},directives:[A.a,U.c,D.c,U.a,D.d,D.a,E.a,f.o,f.r,Tn.a,An.c,An.l,An.m,An.b,An.j,An.k,An.g,u.n,An.h,u.o,w.a,V.a,C.a,L.a],pipes:[P.c],styles:[""]}),Dn),Mn=a("zAKX"),xn=a("cWTo"),Nn=a("NhFE"),wn=a("8dLC");function Vn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",35),m.bc("click",(function(e){return m.Ac(t),m.fc().btnReload.click(e)})),m.Pb(1,"i",36),m.Nc(2),m.Tb()}if(2&e){var i=m.fc();m.Ab(2),m.Pc("",i.btnReload.titlei18n," ")}}function Pn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",37),m.bc("click",(function(e){return m.Ac(t),m.fc().btnAdd.click(e)})),m.Pb(1,"i",38),m.Nc(2),m.Tb()}if(2&e){var i=m.fc();m.Ab(2),m.Pc(" ",i.btnAdd.titlei18n," ")}}function Fn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",39),m.bc("click",(function(e){return m.Ac(t),m.fc().btnDelete.click(e)})),m.Pb(1,"i",40),m.Nc(2),m.Tb()}if(2&e){var i=m.fc();m.Ab(2),m.Pc("",i.btnDelete.titlei18n," ")}}function Bn(e,n){1&e&&m.Pb(0,"i",44)}function Gn(e,n){1&e&&m.Pb(0,"i",45)}function qn(e,n){if(1&e){var t=m.Vb();m.Ub(0,"button",41),m.bc("click",(function(){m.Ac(t);var e=m.fc();return e.filter.ShowAdSearch=!e.filter.ShowAdSearch,e.onResetSearch(!0)})),m.gc(1,"translate"),m.Lc(2,Bn,1,0,"i",42),m.Lc(3,Gn,1,0,"i",43),m.Tb()}if(2&e){var i=m.fc();m.oc("title",m.hc(1,3,"layout.button.btn-show-ad-search.label")),m.Ab(2),m.nc("ngIf",!i.filter.ShowAdSearch),m.Ab(1),m.nc("ngIf",i.filter.ShowAdSearch)}}function Xn(e,n){if(1&e&&m.Pb(0,"nz-option",46),2&e){var t=n.$implicit;m.nc("nzLabel",t.name)("nzValue",t.id)}}var jn,Kn,Hn,$n=function(){return["/"]},_n=[{path:"",children:[{path:"",redirectTo:"user",pathMatch:"full"},{path:"role",component:(jn=function(){function t(n,i,a,c,l,s,u,d,f,m){var g=this;r(this,t),this.roleApiService=n,this.notification=i,this.documentTypeApiService=a,this.organizationApiService=c,this.messageService=l,this.userService=s,this.rightService=u,this.menuService=d,this.aclService=f,this.i18n=m,this.tittle=""+this.i18n.fanyi("function.country.title"),this.filter=Object.assign({},b.s),this.modules=[h.a],this.columnDefs=[],this.rowSelection="multiple",this.grid={dataCount:0,rowData:[],totalData:0},this.overlayLoadingTemplate=b.p,this.overlayNoRowsTemplate=b.q,this.pageSizeOptions=[],this.paginationMessage="",this.listStatus=b.m,this.modal={type:"",item:{},isShow:!1,option:{}},this.isShowDelete=!1,this.isLoadingDelete=!1,this.listOrg=[],this.listDocType=[],this.listUser=[],this.listRight=[],this.listMenu=[],this.columnDefs=[{field:"index",headerName:""+this.i18n.fanyi("layout.grid.index"),width:150,headerCheckboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,checkboxSelection:!0},{field:"code",headerName:""+this.i18n.fanyi("function.role.grid.code"),minWidth:180,flex:1},{field:"name",headerName:""+this.i18n.fanyi("function.role.grid.name"),sortable:!0,filter:!0,minWidth:180,flex:1},{field:"status",headerName:""+this.i18n.fanyi("function.role.grid.status"),minWidth:150,cellRenderer:"statusNameCellRender"},{headerName:""+this.i18n.fanyi("layout.grid.action"),minWidth:150,cellRenderer:"btnCellRender",cellRendererParams:{infoClicked:function(e){return g.onViewItem(e)},editClicked:function(e){return g.onEditItem(e)},deleteClicked:function(e){return g.onDeleteItem(e)},addRoleClicked:function(e){return g.onAddRoleItem(e)},btnUpdateUserRole:function(e){return g.btnUpdateUserRole(e)},addRightClickedHandler:function(e){return g.addRightClickedHandler(e)},addMenuClickedHandler:function(e){return g.addMenuClickedHandler(e)}}}],this.defaultColDef={minWidth:100,resizable:!0},this.frameworkComponents={btnCellRender:o.a,dateCellRender:o.e,statusNameCellRender:o.q},this.excelStyles=e(b.b),this.btnAdd={title:"Th\xeam m\u1edbi",titlei18n:""+this.i18n.fanyi("layout.button.btn-add.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.onAddItem()}},this.btnDelete={title:"X\xf3a",titlei18n:""+this.i18n.fanyi("layout.button.btn-delete.label"),visible:!1,enable:!0,grandAccess:!0,click:function(e){g.onDeleteItem()}},this.btnSearch={title:"T\xecm ki\u1ebfm",titlei18n:""+this.i18n.fanyi("layout.button.btn-search.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.initGridData()}},this.btnResetSearch={title:"\u0110\u1eb7t l\u1ea1i",titlei18n:""+this.i18n.fanyi("layout.button.btn-reset.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.onResetSearch(!1)}},this.btnReload={title:"T\u1ea3i l\u1ea1i",titlei18n:""+this.i18n.fanyi("layout.button.btn-reload.label"),visible:!0,enable:!0,grandAccess:!0,click:function(e){g.onResetSearch(!1)}}}return c(t,[{key:"ngOnInit",value:function(){this.initRightOfUser(),this.initDocumentType(),this.initOrganization(),this.getListUserInternal(),this.initListRight(),this.initListMenu()}},{key:"initRightOfUser",value:function(){this.btnAdd.grandAccess=this.aclService.canAbility("ROLE-ADD"),this.btnDelete.grandAccess=this.aclService.canAbility("ROLE-DELETE")}},{key:"btnUpdateUserRole",value:function(e){this.itemRoleUserModal.initData(e,this.listUser,this.listOrg)}},{key:"initDocumentType",value:function(){var e=this;this.documentTypeApiService.getListComboboxAllStatus().subscribe((function(n){n.data&&(n.data.forEach((function(e){e.parent_id=null})),e.listDocType=n.data)}),(function(e){console.log("get document type combobox error: ",e)}))}},{key:"initOrganization",value:function(){var e=this;this.organizationApiService.getListComboboxCurrentOrgOfUser().subscribe((function(n){200===n.code&&null!=n.data?e.listOrg=n.data:e.messageService.error(""+n.message)}),(function(e){}))}},{key:"initGridData",value:function(){var t=this;return this.btnDelete.visible=!1,this.gridApi.showLoadingOverlay(),this.roleApiService.getFilter(this.filter).subscribe((function(i){var r;if(t.gridApi.hideOverlay(),200===i.code)if(null!=i.data){var a=i.data,c=(void 0===t.filter.pageSize?0:t.filter.pageSize)*((void 0===t.filter.pageNumber?0:t.filter.pageNumber)-1);t.paginationMessage="Hi\u1ec3n th\u1ecb <b>".concat(c+1," - ").concat(c+a.dataCount,"</b> tr\xean t\u1ed5ng s\u1ed1 <b>").concat(a.totalCount,"</b> k\u1ebft qu\u1ea3");var o,l=n(a.data);try{var s=function(){var e=o.value;e.index=++c,e.statusName=null===(r=t.listStatus.find((function(n){return n.id===e.status})))||void 0===r?void 0:r.name,e.infoGrantAccess=!0,e.editGrantAccess=t.aclService.canAbility("ROLE-EDIT"),e.deleteGrantAccess=t.aclService.canAbility("ROLE-DELETE"),e.addRoleGrantAccess=t.aclService.canAbility("ROLE-ADD-DATA"),e.userGroupAddGrantAccess=t.aclService.canAbility("ROLE-ADD-USER"),e.addRightGrantAccess=t.aclService.canAbility("ROLE-ADD-RIGHT"),e.addMenuGrantAccess=t.aclService.canAbility("ROLE-ADD-NAVIGATION")};for(l.s();!(o=l.n()).done;)s()}catch(u){l.e(u)}finally{l.f()}t.grid.totalData=a.totalCount,t.grid.dataCount=a.dataCount,t.grid.rowData=a.data,t.pageSizeOptions=e(b.r),t.pageSizeOptions=t.pageSizeOptions.filter((function(e){return e<a.totalCount})),t.pageSizeOptions.push(a.totalCount)}else t.notification.error(""+t.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+i.message);else t.notification.error(""+t.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+i.message)}),(function(e){t.gridApi.hideOverlay()}))}},{key:"initListMenu",value:function(){var e=this;this.menuService.getListCombobox().subscribe((function(n){200===n.code&&null!=n.data?e.listMenu=n.data:e.messageService.error(""+n.message)}),(function(e){console.log(e)}))}},{key:"onResetSearch",value:function(e){this.filter.pageNumber=1,this.filter.textSearch=void 0,this.filter.status=null,e&&this.initGridData()}},{key:"onGridReady",value:function(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.initGridData()}},{key:"onSelectionChanged",value:function(e){var n=this.gridApi.getSelectedRows();this.btnDelete.visible=n.length>0}},{key:"onCellDoubleClicked",value:function(e){this.onViewItem(e.data)}},{key:"addRightClickedHandler",value:function(e){this.itemRightModal.initData(e,this.listRight)}},{key:"addMenuClickedHandler",value:function(e){this.itemMenuModal.initData(e,this.listMenu)}},{key:"initListRight",value:function(){var e=this;this.rightService.getListCombobox().subscribe((function(n){200===n.code&&null!=n.data?e.listRight=n.data:e.notification.error(""+e.i18n.fanyi("function.right.message-error.title"),""+n.message)}),(function(e){}))}},{key:"onEditItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(s.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.roleApiService.getById(e.id).toPromise();case 2:200===(t=n.sent).code&&null!=t.data?(this.modal={type:"edit",item:e,isShow:!0,option:{}},this.itemModal.initData(t.data,"edit")):this.notification.error(""+this.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+t.message);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"onViewItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(s.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.roleApiService.getById(e.id).toPromise();case 2:200===(t=n.sent).code&&null!=t.data?(this.modal={type:"info",item:e,isShow:!0,option:{}},this.itemModal.initData(t.data,"info")):this.notification.error(""+this.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+t.message);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"onDeleteItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.gridApi.getSelectedRows();null!==e&&(n=[]).push(e),this.i18n.fanyi("delete-modal.grid.header");var t="";t=n.length>1?""+this.i18n.fanyi("layout-modal.delete.message.many"):""+this.i18n.fanyi("layout-modal.delete.message.one"),this.isShowDelete=!0,this.deleteModal.initData(n,t)}},{key:"onAddRoleItem",value:function(e){this.itemPermissionModal.initData(e,this.listDocType,this.listOrg)}},{key:"onPageNumberChange",value:function(){this.initGridData()}},{key:"onPageSizeChange",value:function(){this.initGridData()}},{key:"onAddItem",value:function(){this.modal={type:"add",item:{},isShow:!0,option:{}},this.itemModal.initData({},"add")}},{key:"onModalEventEmmit",value:function(e){this.modal.isShow=!1,"success"===e.type&&this.initGridData()}},{key:"onDeleteEventEmmit",value:function(e){"success"===e.type?this.initGridData():"confirm"===e.type&&(this.deleteModal.updateIsLoading(!0),this.deleteListItem(e.listId))}},{key:"onModalRoleUserEventEmmit",value:function(e){}},{key:"onModalRightEventEmmit",value:function(e){}},{key:"onModalMenuEventEmmit",value:function(e){}},{key:"getListUserInternal",value:function(){var e=this;this.userService.getListComboboxFilterInternalUser(!0,null).subscribe((function(n){e.listUser=n.data}),(function(e){}))}},{key:"deleteListItem",value:function(e){var n=this;return this.isLoadingDelete=!0,this.roleApiService.delete(e).subscribe((function(e){n.isLoadingDelete=!1,200===e.code&&null!=e.data?n.deleteModal.updateData(e.data):n.notification.error(""+n.i18n.fanyi("function.role.modal-item.name.message.error.title"),""+e.message)}),(function(e){n.isLoadingDelete=!1,n.deleteModal.updateData(void 0),n.notification.error(""+n.i18n.fanyi("function.role.modal-item.name.message.error.title"),e.error?""+e.error.message:""+e.status)}))}},{key:"changeStatus",value:function(e){this.filter.status=e,this.initGridData()}},{key:"onModalPermissionEventEmmit",value:function(e){this.initGridData()}}]),t}(),jn.\u0275fac=function(e){return new(e||jn)(m.Ob(v.a),m.Ob(p.b),m.Ob(z.b),m.Ob(z.o),m.Ob(T.e),m.Ob(z.u),m.Ob(z.r),m.Ob(z.l),m.Ob(g.a),m.Ob(d.a))},jn.\u0275cmp=m.Ib({type:jn,selectors:[["app-role"]],viewQuery:function(e,n){var t;1&e&&(m.Sc(bn,!0),m.Sc(yn,!0),m.Sc(rn,!0),m.Sc(Fe,!0),m.Sc(o.f,!0),m.Sc(En,!0)),2&e&&(m.wc(t=m.cc())&&(n.itemMenuModal=t.first),m.wc(t=m.cc())&&(n.itemRightModal=t.first),m.wc(t=m.cc())&&(n.itemModal=t.first),m.wc(t=m.cc())&&(n.itemPermissionModal=t.first),m.wc(t=m.cc())&&(n.deleteModal=t.first),m.wc(t=m.cc())&&(n.itemRoleUserModal=t.first))},decls:57,vars:45,consts:[["onBack","{() => window.history.back()}",3,"title"],[1,"card-header"],["nz-row","",1,"header"],["nz-col","","nzSpan","12"],[3,"routerLink"],["nz-icon","","nzType","home"],[3,"nzBordered"],["nzSm","10","nzXS","24","nzMd","10",1,"padding-bottom-10"],["nz-button","","nzType","default","class","btn-reload",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-primary",3,"click",4,"ngIf"],["nz-button","","nzType","primary","class","btn-danger",3,"click",4,"ngIf"],["nzSm","14","nzXS","24","nzMd","14",1,"pull-right","padding-bottom-10"],["nzJustify","end"],["nzSm","12","nzXS","12","nzMd","12",1,"padding-bottom-10"],["nzSearch","",3,"nzAddOnAfter"],["type","text","nz-input","",3,"ngModel","placeholder","ngModelChange","keyup.enter"],["suffixIconButton",""],["nz-row","","nzJustify","start",3,"hidden"],["nzSm","12","nzXS","24","nzMd","12",1,"padding-bottom-10"],[1,"margin-0"],["nzSm","4","nzXS","24","nzMd","4","nzFor","status"],["nzSm","18","nzXS","24","nzMd","18"],["nzShowSearch","","nzAllowClear","",2,"text-align","center",3,"nzPlaceHolder","ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["id","unit-grid",1,"ag-theme-alpine",2,"width","100%","height","70vh",3,"modules","columnDefs","defaultColDef","suppressRowClickSelection","rowSelection","rowData","overlayLoadingTemplate","overlayNoRowsTemplate","frameworkComponents","excelStyles","selectionChanged","cellDoubleClicked","gridReady"],["agGrid",""],[3,"grid","filter","pageSizeOptions","pageNumberChange","pageSizeChange"],[3,"isVisible","item","type","option","eventEmmit"],["itemModal",""],[3,"isVisible","eventEmmit"],["deleteModal",""],[3,"eventEmmit"],["itemRoleUserModal",""],["itemRightModal",""],["itemMenuModal",""],["nz-button","","nzType","default",1,"btn-reload",3,"click"],["nz-icon","","nzType","reload","nzTheme","outline"],["nz-button","","nzType","primary",1,"btn-primary",3,"click"],["nz-icon","","nzType","file-add","nzTheme","fill"],["nz-button","","nzType","primary",1,"btn-danger",3,"click"],["nz-icon","","nzType","delete","nzTheme","fill"],["nz-button","","nzType","default","nzSearch","",3,"title","click"],["nz-icon","","nzType","caret-down","nzTheme","outline",4,"ngIf"],["nz-icon","","nzType","caret-up","nzTheme","outline",4,"ngIf"],["nz-icon","","nzType","caret-down","nzTheme","outline"],["nz-icon","","nzType","caret-up","nzTheme","outline"],[3,"nzLabel","nzValue"]],template:function(e,n){if(1&e&&(m.Ub(0,"page-header-wrapper",0),m.Ub(1,"nz-card",1),m.Ub(2,"div",2),m.Ub(3,"div",3),m.Ub(4,"nz-breadcrumb"),m.Ub(5,"nz-breadcrumb-item"),m.Ub(6,"a",4),m.Pb(7,"i",5),m.Tb(),m.Tb(),m.Ub(8,"nz-breadcrumb-item"),m.Ub(9,"a"),m.Ub(10,"span"),m.Nc(11),m.gc(12,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Ub(13,"nz-breadcrumb-item"),m.Ub(14,"a"),m.Nc(15),m.gc(16,"translate"),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Ub(17,"nz-card",6),m.Ub(18,"nz-row"),m.Ub(19,"nz-col",7),m.Lc(20,Vn,3,1,"button",8),m.Lc(21,Pn,3,1,"button",9),m.Lc(22,Fn,3,1,"button",10),m.Tb(),m.Ub(23,"nz-col",11),m.Ub(24,"nz-row",12),m.Ub(25,"nz-col",13),m.Ub(26,"nz-input-group",14),m.Ub(27,"input",15),m.bc("ngModelChange",(function(e){return n.filter.textSearch=e}))("keyup.enter",(function(){return n.initGridData()})),m.gc(28,"translate"),m.Tb(),m.Tb(),m.Lc(29,qn,4,5,"ng-template",null,16,m.Mc),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Ub(31,"div",17),m.Ub(32,"nz-col",18),m.Ub(33,"nz-form-item",19),m.Ub(34,"nz-form-label",20),m.Nc(35),m.gc(36,"translate"),m.Tb(),m.Ub(37,"nz-form-control",21),m.Ub(38,"nz-select",22),m.bc("ngModelChange",(function(e){return n.changeStatus(e)}))("ngModelChange",(function(e){return n.filter.status=e})),m.gc(39,"translate"),m.Lc(40,Xn,1,2,"nz-option",23),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Tb(),m.Ub(41,"nz-row"),m.Ub(42,"ag-grid-angular",24,25),m.bc("selectionChanged",(function(e){return n.onSelectionChanged(e)}))("cellDoubleClicked",(function(e){return n.onCellDoubleClicked(e)}))("gridReady",(function(e){return n.onGridReady(e)})),m.Tb(),m.Tb(),m.Ub(44,"app-ag-grid-pagination",26),m.bc("pageNumberChange",(function(){return n.onPageNumberChange()}))("pageSizeChange",(function(){return n.onPageSizeChange()})),m.Tb(),m.Tb(),m.Tb(),m.Ub(45,"app-role-item",27,28),m.bc("eventEmmit",(function(e){return n.onModalEventEmmit(e)})),m.Tb(),m.Ub(47,"delete-modal",29,30),m.bc("eventEmmit",(function(e){return n.onDeleteEventEmmit(e)})),m.Tb(),m.Ub(49,"app-role-data-permission",31,28),m.bc("eventEmmit",(function(e){return n.onModalPermissionEventEmmit(e)})),m.Tb(),m.Ub(51,"app-role-user",31,32),m.bc("eventEmmit",(function(e){return n.onModalRoleUserEventEmmit(e)})),m.Tb(),m.Ub(53,"app-role-right",31,33),m.bc("eventEmmit",(function(e){return n.onModalRightEventEmmit(e)})),m.Tb(),m.Ub(55,"app-role-menu",31,34),m.bc("eventEmmit",(function(e){return n.onModalMenuEventEmmit(e)})),m.Tb()),2&e){var t=m.xc(30);m.nc("title",n.tittle),m.Ab(6),m.nc("routerLink",m.rc(44,$n)),m.Ab(5),m.Oc(m.hc(12,34,"menu.permission")),m.Ab(4),m.Pc(" ",m.hc(16,36,"layout.breadcum.role")," "),m.Ab(2),m.nc("nzBordered",!1),m.Ab(3),m.nc("ngIf",n.btnReload.visible&&n.btnReload.grandAccess),m.Ab(1),m.nc("ngIf",n.btnAdd.visible&&n.btnAdd.grandAccess),m.Ab(1),m.nc("ngIf",n.btnDelete.visible&&n.btnDelete.grandAccess),m.Ab(4),m.nc("nzAddOnAfter",t),m.Ab(1),m.oc("placeholder",m.hc(28,38,"layout.grid.search.text-search.placeholder")),m.nc("ngModel",n.filter.textSearch),m.Ab(4),m.nc("hidden",!n.filter.ShowAdSearch),m.Ab(4),m.Oc(m.hc(36,40,"layout.grid.search.status.label")),m.Ab(3),m.oc("nzPlaceHolder",m.hc(39,42,"layout.grid.search.status.placeholder")),m.nc("ngModel",n.filter.status),m.Ab(2),m.nc("ngForOf",n.listStatus),m.Ab(2),m.nc("modules",n.modules)("columnDefs",n.columnDefs)("defaultColDef",n.defaultColDef)("suppressRowClickSelection",!0)("rowSelection",n.rowSelection)("rowData",n.grid.rowData)("overlayLoadingTemplate",n.overlayLoadingTemplate)("overlayNoRowsTemplate",n.overlayNoRowsTemplate)("frameworkComponents",n.frameworkComponents)("excelStyles",n.excelStyles),m.Ab(2),m.nc("grid",n.grid)("filter",n.filter)("pageSizeOptions",n.pageSizeOptions),m.Ab(1),m.nc("isVisible",n.modal.isShow)("item",n.modal.item)("type",n.modal.type)("option",n.modal.option),m.Ab(2),m.nc("isVisible",n.isShowDelete)}},directives:[S.a,k.a,U.c,U.a,I.a,I.b,l.m,C.a,L.a,u.o,O.c,O.b,f.d,f.o,f.r,D.c,D.d,D.a,Mn.e,u.n,xn.a,Nn.a,rn,wn.a,Fe,En,yn,bn,w.a,V.a,Mn.a],pipes:[P.c],styles:[""]}),jn)},{path:"menu",component:de},{path:"right",component:Re}]}],Wn=((Hn=function e(){r(this,e)}).\u0275mod=m.Mb({type:Hn}),Hn.\u0275inj=m.Lb({factory:function(e){return new(e||Hn)},imports:[[l.n.forChild(_n)],l.n]}),Hn),Jn=((Kn=function e(){r(this,e)}).\u0275mod=m.Mb({type:Kn}),Kn.\u0275inj=m.Lb({factory:function(e){return new(e||Kn)},imports:[[o.k,Wn,xn.b.withComponents([])]]}),Kn)}}])}();